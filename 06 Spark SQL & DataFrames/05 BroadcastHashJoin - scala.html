<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Spark SQL &amp; DataFrames / BroadcastHashJoin - scala - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1644,"name":"Spark SQL & DataFrames / BroadcastHashJoin - scala","language":"scala","commands":[{"version":"CommandV1","origId":1645,"guid":"9260b0ad-779c-454e-981b-2946ef14ab90","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n# **BroadcastHashJoin**\n* Configuring a BroadcastHashJoin is a way to optimize joining a large and a small table in Spark SQL.\n* This notebook will cover the how to configure a BroadcastHashJoin and why to choose it over a ShuffledHashJoin.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708119478E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"4f9bae10-74da-4015-ba25-99edda522341"},{"version":"CommandV1","origId":1646,"guid":"112bafbe-ff54-493a-9343-f46bafd5c507","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n\n### **Setup:** Create a large table that will be joined with a smaller table.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708119521E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"6b88bbe3-e5d7-46b3-994a-c5092ab7ce7a"},{"version":"CommandV1","origId":1647,"guid":"afa78e94-4535-48f2-a5bd-1bf6d24856c3","subtype":"command","commandType":"auto","position":3.0,"command":"import org.apache.spark.sql.types._\n\nval array = for (i <- List.range(1, 1000000)) yield Row(i, i % 2)\n  \nval schema =\n  StructType(\n    StructField(\"num\", IntegerType, true) ::\n    StructField(\"bit\", IntegerType, true) :: Nil)\n\nval dataFrame = sqlContext.createDataFrame(sc.parallelize(array), schema)\ndataFrame.repartition(100).registerTempTable(\"my_large_table\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types._\narray: List[org.apache.spark.sql.Row] = List([1,1], [2,0], [3,1], [4,0], [5,1], [6,0], [7,1], [8,0], [9,1], [10,0], [11,1], [12,0], [13,1], [14,0], [15,1], [16,0], [17,1], [18,0], [19,1], [20,0], [21,1], [22,0], [23,1], [24,0], [25,1], [26,0], [27,1], [28,0], [29,1], [30,0], [31,1], [32,0], [33,1], [34,0], [35,1], [36,0], [37,1], [38,0], [39,1], [40,0], [41,1], [42,0], [43,1], [44,0], [45,1], [46,0], [47,1], [48,0], [49,1], [50,0], [51,1], [52,0], [53,1], [54,0], [55,1], [56,0], [57,1], [58,0], [59,1], [60,0], [61,1], [62,0], [63,1], [64,0], [65,1], [66,0], [67,1], [68,0], [69,1], [70,0], [71,1], [72,0], [73,1], [74,0], [75,1], [76,0], [77,1], [78,0], [79,1], [80,0], [81,1], [82,0], [83,1], [84,0], [85,1], [86,0], [87,1], [88,0], [89,1], [90,0], [91,1], [92,0], [93,1], [94,0], [95,1], [96,0], [97,1], [98,0], [99,1], [100,0], [101,1], [102,0], [103,1], [104,0], [105,1], [106,0], [107,1], [108,0], [109,1], [110,0], [111,1], [112,0], [113,1], [114,0], [115,1], [116,0], [117,1], [118,0], [119,1], [120,0], [121,1], [122,0], [123,1], [124,0], [125,1], [126,0], [127,1], [128,0], [129,1], [130,0], [131,1], [132,0], [133,1], [134,0], [135,1], [136,0], [137,1], [138,0], [139,1], [140,0], [141,1], [142,0], [143,1], [144,0], [145,1], [146,0], [147,1], [148,0], [149,1], [150,0], [151,1], [152,0], [153,1], [154,0], [155,1], [156,0], [157,1], [158,0], [159,1], [160,0], [161,1], [162,0], [163,1], [164,0], [165,1], [166,0], [167,1], [168,0], [169,1], [170,0], [171,1], [172,0], [173,1], [174,0], [175,1], [176,0], [177,1], [178,0], [179,1], [180,0], [181,1], [182,0], [183,1], [184,0], [185,1], [186,0], [187,1], [188,0], [189,1], [190,0], [191,1], [192,0], [193,1], [194,0], [195,1], [196,0], [197,1], [198,0], [199,1], [200,0], [201,1], [202,0], [203,1], [204,0], [205,1], [206,0], [207,1], [208,0], [209,1], [210,0], [211,1], [212,0], [213,1], [214,0], [215,1], [216,0], [217,1], [218,0], [219,1], [220,0], [221,1], [222,0], [223,1], [224,0], [225,1], [226,0], [227,1], [228,0], [229,1], [230,0], [231,1], [232,0], [233,1], [234,0], [235,1], [236,0], [237,1], [238,0], [239,1], [240,0], [241,1], [242,0], [243,1], [244,0], [245,1], [246,0], [247,1], [248,0], [249,1], [250,0], [251,1], [252,0], [253,1], [254,0], [255,1], [256,0], [257,1], [258,0], [259,1], [260,0], [261,1], [262,0], [263,1], [264,0], [265,1], [266,0], [267,1], [268,0], [269,1], [270,0], [271,1], [272,0], [273,1], [274,0], [275,1], [276,0], [277,1], [278,0], [279,1], [280,0], [281,1], [282,0], [283,1], [284,0], [285,1], [286,0], [287,1], [288,0], [289,1], [290,0], [291,1], [292,0], [293,1], [294,0], [295,1], [296,0], [297,1], [298,0], [299,1], [300,0], [301,1], [302,0], [303,1], [304,0], [305,1], [306,0], [307,1], [308,0], [309,1], [310,0], [311,1], [312,0], [313,1], [314,0], [315,1], [316,0], [317,1], [318,0], [319,1], [320,0], [321,1], [322,0], [323,1], [324,0], [325,1], [326,0], [327,1], [328,0], [329,1], [330,0], [331,1], [332,0], [333,1], [334,0], [335,1], [336,0], [337,1], [338,0], [339,1], [340,0], [341,1], [342,0], [343,1], [344,0], [345,1], [346,0], [347,1], [348,0], [349,1], [350,0], [351,1], [352,0], [353,1], [354,0], [355,1], [356,0], [357,1], [358,0], [359,1], [360,0], [361,1], [362,0], [363,1], [364,0], [365,1], [366,0], [367,1], [368,0], [369,1], [370,0], [371,1], [372,0], [373,1], [374,0], [375,1], [376,0], [377,1], [378,0], [379,1], [380,0], [381,1], [382,0], [383,1], [384,0], [385,1], [386,0], [387,1], [388,0], [389,1], [390,0], [391,1], [392,0], [393,1], [394,0], [395,1], [396,0], [397,1], [398,0], [399,1], [400,0], [401,1], [402,0], [403,1], [404,0], [405,1], [406,0], [407,1], [408,0], [409,1], [410,0], [411,1], [412,0], [413,1], [414,0], [415,1], [416,0], [417,1], [418,0], [419,1], [420,0], [421,1], [422,0], [423,1], [424,0], [425,1], [426,0], [427,1], [428,0], [429,1], [430,0], [431,1], [432,0], [433,1], [434,0], [435,1], [436,0], [437,1], [438,0], [439,1], [440,0], [441,1], [442,0], [443,1], [444,0], [445,1], [446,0], [447,1], [448,0], [449,1], [450,0], [451,1], [452,0], [453,1], [454,0], [455,1], [456,0], [457,1], [458,0], [459,1], [460,0], [461,1], [462,0], [463,1], [464,0], [465,1], [466,0], [467,1], [468,0], [469,1], [470,0], [471,1], [472,0], [473,1], [474,0], [475,1], [476,0], [477,1], [478,0], [479,1], [480,0], [481,1], [482,0], [483,1], [484,0], [485,1], [486,0], [487,1], [488,0], [489,1], [490,0], [491,1], [492,0], [493,1], [494,0], [495,1], [496,0], [497,1], [498,0], [499,1], [500,0], [501,1], [502,0], [503,1], [504,0], [505,1], [506,0], [507,1], [508,0], [509,1], [510,0], [511,1], [512,0], [513,1], [514,0], [515,1], [516,0], [517,1], [518,0], [519,1], [520,0], [521,1], [522,0], [523,1], [524,0], [525,1], [526,0], [527,1], [528,0], [529,1], [530,0], [531,1], [532,0], [533,1], [534,0], [535,1], [536,0], [537,1], [538,0], [539,1], [540,0], [541,1], [542,0], [543,1], [544,0], [545,1], [546,0], [547,1], [548,0], [549,1], [550,0], [551,1], [552,0], [553,1], [554,0], [555,1], [556,0], [557,1], [558,0], [559,1], [560,0], [561,1], [562,0], [563,1], [564,0], [565,1], [566,0], [567,1], [568,0], [569,1], [570,0], [571,1], [572,0], [573,1], [574,0], [575,1], [576,0], [577,1], [578,0], [579,1], [580,0], [581,1], [582,0], [583,1], [584,0], [585,1], [586,0], [587,1], [588,0], [589,1], [590,0], [591,1], [592,0], [593,1], [594,0], [595,1], [596,0], [597,1], [598,0], [599,1], [600,0], [601,1], [602,0], [603,1], [604,0], [605,1], [606,0], [607,1], [608,0], [609,1], [610,0], [611,1], [612,0], [613,1], [614,0], [615,1], [616,0], [617,1], [618,0], [619,1], [620,0], [621,1], [622,0], [623,1], [624,0], [625,1], [626,0], [627,1], [628,0], [629,1], [630,0], [631,1], [632,0], [633,1], [634,0], [635,1], [636,0], [637,1], [638,0], [639,1], [640,0], [641,1], [642,0], [643,1], [644,0], [645,1], [646,0], [647,1], [648,0], [649,1], [650,0], [651,1], [652,0], [653,1], [654,0], [655,1], [656,0], [657,1], [658,0], [659,1], [660,0], [661,1], [662,0], [663,1], [664,0], [665,1], [666,0], [667,1], [668,0], [669,1], [670,0], [671,1], [672,0], [673,1], [674,0], [675,1], [676,0], [677,1], [678,0], [679,1], [680,0], [681,1], [682,0], [683,1], [684,0], [685,1], [686,0], [687,1], [688,0], [689,1], [690,0], [691,1], [692,0], [693,1], [694,0], [695,1], [696,0], [697,1], [698,0], [699,1], [700,0], [701,1], [702,0], [703,1], [704,0], [705,1], [706,0], [707,1], [708,0], [709,1], [710,0], [711,1], [712,0], [713,1], [714,0], [715,1], [716,0], [717,1], [718,0], [719,1], [720,0], [721,1], [722,0], [723,1], [724,0], [725,1], [726,0], [727,1], [728,0], [729,1], [730,0], [731,1], [732,0], [733,1], [734,0], [735,1], [736,0], [737,1], [738,0], [739,1], [740,0], [741,1], [742,0], [743,1], [744,0], [745,1], [746,0], [747,1], [748,0], [749,1], [750,0], [751,1], [752,0], [753,1], [754,0], [755,1], [756,0], [757,1], [758,0], [759,1], [760,0], [761,1], [762,0], [763,1], [764,0], [765,1], [766,0], [767,1], [768,0], [769,1], [770,0], [771,1], [772,0], [773,1], [774,0], [775,1], [776,0], [777,1], [778,0], [779,1], [780,0], [781,1], [782,0], [783,1], [784,0], [785,1], [786,0], [787,1], [788,0], [789,1], [790,0], [791,1], [792,0], [793,1], [794,0], [795,1], [796,0], [797,1], [798,0], [799,1], [800,0], [801,1], [802,0], [803,1], [804,0], [805,1], [806,0], [807,1], [808,0], [809,1], [810,0], [811,1], [812,0], [813,1], [814,0], [815,1], [816,0], [817,1], [818,0], [819,1], [820,0], [821,1], [822,0], [823,1], [824,0], [825,1], [826,0], [827,1], [828,0], [829,1], [830,0], [831,1], [832,0], [833,1], [834,0], [835,1], [836,0], [837,1], [838,0], [839,1], [840,0], [841,1], [842,0], [843,1], [844,0], [845,1], [846,0], [847,1], [848,0], [849,1], [850,0], [851,1], [852,0], [853,1], [854,0], [855,1], [856,0], [857,1], [858,0], [859,1], [860,0], [861,1], [862,0], [863,1], [864,0], [865,1], [866,0], [867,1], [868,0], [869,1], [870,0], [871,1], [872,0], [873,1], [874,0], [875,1], [876,0], [877,1], [878,0], [879,1], [880,0], [881,1], [882,0], [883,1], [884,0], [885,1], [886,0], [887,1], [888,0], [889,1], [890,0], [891,1], [892,0], [893,1], [894,0], [895,1], [896,0], [897,1], [898,0], [899,1], [900,0], [901,1], [902,0], [903,1], [904,0], [905,1], [906,0], [907,1], [908,0], [909,1], [910,0], [911,1], [912,0], [913,1], [914,0], [915,1], [916,0], [917,1], [918,0], [919,1], [920,0], [921,1], [922,0], [923,1], [924,0], [925,1], [926,0], [927,1], [928,0], [929,1], [930,0], [931,1], [932,0], [933,1], [934,0], [935,1], [936,0], [937,1], [938,0], [939,1], [940,0], [941,1], [942,0], [943,1], [944,0], [945,1], [946,0], [947,1], [948,0], [949,1], [950,0], [951,1], [952,0], [953,1], [954,0], [955,1], [956,0], [957,1], [958,0], [959,1], [960,0], [961,1], [962,0], [963,1], [964,0], [965,1], [966,0], [967,1], [968,0], [969,1], [970,0], [971,1], [972,0], [973,1], [974,0], [975,1], [976,0], [977,1], [978,0], [979,1], [980,0], [981,1], [982,0], [983,1], [984,0], [985,1], [986,0], [987,1], [988,0], [989,1], [990,0], [991,1], [992,0], [993,1], [994,0], [995,1], [996,0], [997,1], [998,0], [999,1], [1000,0])\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(num,IntegerType,true), StructField(bit,IntegerType,true))\ndataFrame: org.apache.spark.sql.DataFrame = [num: int, bit: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\">&lt;console&gt;:36: error: not found: value StructType\n                StructType(\n                ^\n</div>","startTime":1.440794199567E12,"submitTime":1.440794199499E12,"finishTime":1.440794202674E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"ca9c6539-eb27-4304-91a9-4bc0d0e36714"},{"version":"CommandV1","origId":1648,"guid":"5b589382-9a9c-4db7-88e4-35538665e49b","subtype":"command","commandType":"auto","position":3.09375,"command":"display(dataFrame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.0,1.0],[2.0,0.0],[3.0,1.0],[4.0,0.0],[5.0,1.0],[6.0,0.0],[7.0,1.0],[8.0,0.0],[9.0,1.0],[10.0,0.0],[11.0,1.0],[12.0,0.0],[13.0,1.0],[14.0,0.0],[15.0,1.0],[16.0,0.0],[17.0,1.0],[18.0,0.0],[19.0,1.0],[20.0,0.0],[21.0,1.0],[22.0,0.0],[23.0,1.0],[24.0,0.0],[25.0,1.0],[26.0,0.0],[27.0,1.0],[28.0,0.0],[29.0,1.0],[30.0,0.0],[31.0,1.0],[32.0,0.0],[33.0,1.0],[34.0,0.0],[35.0,1.0],[36.0,0.0],[37.0,1.0],[38.0,0.0],[39.0,1.0],[40.0,0.0],[41.0,1.0],[42.0,0.0],[43.0,1.0],[44.0,0.0],[45.0,1.0],[46.0,0.0],[47.0,1.0],[48.0,0.0],[49.0,1.0],[50.0,0.0],[51.0,1.0],[52.0,0.0],[53.0,1.0],[54.0,0.0],[55.0,1.0],[56.0,0.0],[57.0,1.0],[58.0,0.0],[59.0,1.0],[60.0,0.0],[61.0,1.0],[62.0,0.0],[63.0,1.0],[64.0,0.0],[65.0,1.0],[66.0,0.0],[67.0,1.0],[68.0,0.0],[69.0,1.0],[70.0,0.0],[71.0,1.0],[72.0,0.0],[73.0,1.0],[74.0,0.0],[75.0,1.0],[76.0,0.0],[77.0,1.0],[78.0,0.0],[79.0,1.0],[80.0,0.0],[81.0,1.0],[82.0,0.0],[83.0,1.0],[84.0,0.0],[85.0,1.0],[86.0,0.0],[87.0,1.0],[88.0,0.0],[89.0,1.0],[90.0,0.0],[91.0,1.0],[92.0,0.0],[93.0,1.0],[94.0,0.0],[95.0,1.0],[96.0,0.0],[97.0,1.0],[98.0,0.0],[99.0,1.0],[100.0,0.0],[101.0,1.0],[102.0,0.0],[103.0,1.0],[104.0,0.0],[105.0,1.0],[106.0,0.0],[107.0,1.0],[108.0,0.0],[109.0,1.0],[110.0,0.0],[111.0,1.0],[112.0,0.0],[113.0,1.0],[114.0,0.0],[115.0,1.0],[116.0,0.0],[117.0,1.0],[118.0,0.0],[119.0,1.0],[120.0,0.0],[121.0,1.0],[122.0,0.0],[123.0,1.0],[124.0,0.0],[125.0,1.0],[126.0,0.0],[127.0,1.0],[128.0,0.0],[129.0,1.0],[130.0,0.0],[131.0,1.0],[132.0,0.0],[133.0,1.0],[134.0,0.0],[135.0,1.0],[136.0,0.0],[137.0,1.0],[138.0,0.0],[139.0,1.0],[140.0,0.0],[141.0,1.0],[142.0,0.0],[143.0,1.0],[144.0,0.0],[145.0,1.0],[146.0,0.0],[147.0,1.0],[148.0,0.0],[149.0,1.0],[150.0,0.0],[151.0,1.0],[152.0,0.0],[153.0,1.0],[154.0,0.0],[155.0,1.0],[156.0,0.0],[157.0,1.0],[158.0,0.0],[159.0,1.0],[160.0,0.0],[161.0,1.0],[162.0,0.0],[163.0,1.0],[164.0,0.0],[165.0,1.0],[166.0,0.0],[167.0,1.0],[168.0,0.0],[169.0,1.0],[170.0,0.0],[171.0,1.0],[172.0,0.0],[173.0,1.0],[174.0,0.0],[175.0,1.0],[176.0,0.0],[177.0,1.0],[178.0,0.0],[179.0,1.0],[180.0,0.0],[181.0,1.0],[182.0,0.0],[183.0,1.0],[184.0,0.0],[185.0,1.0],[186.0,0.0],[187.0,1.0],[188.0,0.0],[189.0,1.0],[190.0,0.0],[191.0,1.0],[192.0,0.0],[193.0,1.0],[194.0,0.0],[195.0,1.0],[196.0,0.0],[197.0,1.0],[198.0,0.0],[199.0,1.0],[200.0,0.0],[201.0,1.0],[202.0,0.0],[203.0,1.0],[204.0,0.0],[205.0,1.0],[206.0,0.0],[207.0,1.0],[208.0,0.0],[209.0,1.0],[210.0,0.0],[211.0,1.0],[212.0,0.0],[213.0,1.0],[214.0,0.0],[215.0,1.0],[216.0,0.0],[217.0,1.0],[218.0,0.0],[219.0,1.0],[220.0,0.0],[221.0,1.0],[222.0,0.0],[223.0,1.0],[224.0,0.0],[225.0,1.0],[226.0,0.0],[227.0,1.0],[228.0,0.0],[229.0,1.0],[230.0,0.0],[231.0,1.0],[232.0,0.0],[233.0,1.0],[234.0,0.0],[235.0,1.0],[236.0,0.0],[237.0,1.0],[238.0,0.0],[239.0,1.0],[240.0,0.0],[241.0,1.0],[242.0,0.0],[243.0,1.0],[244.0,0.0],[245.0,1.0],[246.0,0.0],[247.0,1.0],[248.0,0.0],[249.0,1.0],[250.0,0.0],[251.0,1.0],[252.0,0.0],[253.0,1.0],[254.0,0.0],[255.0,1.0],[256.0,0.0],[257.0,1.0],[258.0,0.0],[259.0,1.0],[260.0,0.0],[261.0,1.0],[262.0,0.0],[263.0,1.0],[264.0,0.0],[265.0,1.0],[266.0,0.0],[267.0,1.0],[268.0,0.0],[269.0,1.0],[270.0,0.0],[271.0,1.0],[272.0,0.0],[273.0,1.0],[274.0,0.0],[275.0,1.0],[276.0,0.0],[277.0,1.0],[278.0,0.0],[279.0,1.0],[280.0,0.0],[281.0,1.0],[282.0,0.0],[283.0,1.0],[284.0,0.0],[285.0,1.0],[286.0,0.0],[287.0,1.0],[288.0,0.0],[289.0,1.0],[290.0,0.0],[291.0,1.0],[292.0,0.0],[293.0,1.0],[294.0,0.0],[295.0,1.0],[296.0,0.0],[297.0,1.0],[298.0,0.0],[299.0,1.0],[300.0,0.0],[301.0,1.0],[302.0,0.0],[303.0,1.0],[304.0,0.0],[305.0,1.0],[306.0,0.0],[307.0,1.0],[308.0,0.0],[309.0,1.0],[310.0,0.0],[311.0,1.0],[312.0,0.0],[313.0,1.0],[314.0,0.0],[315.0,1.0],[316.0,0.0],[317.0,1.0],[318.0,0.0],[319.0,1.0],[320.0,0.0],[321.0,1.0],[322.0,0.0],[323.0,1.0],[324.0,0.0],[325.0,1.0],[326.0,0.0],[327.0,1.0],[328.0,0.0],[329.0,1.0],[330.0,0.0],[331.0,1.0],[332.0,0.0],[333.0,1.0],[334.0,0.0],[335.0,1.0],[336.0,0.0],[337.0,1.0],[338.0,0.0],[339.0,1.0],[340.0,0.0],[341.0,1.0],[342.0,0.0],[343.0,1.0],[344.0,0.0],[345.0,1.0],[346.0,0.0],[347.0,1.0],[348.0,0.0],[349.0,1.0],[350.0,0.0],[351.0,1.0],[352.0,0.0],[353.0,1.0],[354.0,0.0],[355.0,1.0],[356.0,0.0],[357.0,1.0],[358.0,0.0],[359.0,1.0],[360.0,0.0],[361.0,1.0],[362.0,0.0],[363.0,1.0],[364.0,0.0],[365.0,1.0],[366.0,0.0],[367.0,1.0],[368.0,0.0],[369.0,1.0],[370.0,0.0],[371.0,1.0],[372.0,0.0],[373.0,1.0],[374.0,0.0],[375.0,1.0],[376.0,0.0],[377.0,1.0],[378.0,0.0],[379.0,1.0],[380.0,0.0],[381.0,1.0],[382.0,0.0],[383.0,1.0],[384.0,0.0],[385.0,1.0],[386.0,0.0],[387.0,1.0],[388.0,0.0],[389.0,1.0],[390.0,0.0],[391.0,1.0],[392.0,0.0],[393.0,1.0],[394.0,0.0],[395.0,1.0],[396.0,0.0],[397.0,1.0],[398.0,0.0],[399.0,1.0],[400.0,0.0],[401.0,1.0],[402.0,0.0],[403.0,1.0],[404.0,0.0],[405.0,1.0],[406.0,0.0],[407.0,1.0],[408.0,0.0],[409.0,1.0],[410.0,0.0],[411.0,1.0],[412.0,0.0],[413.0,1.0],[414.0,0.0],[415.0,1.0],[416.0,0.0],[417.0,1.0],[418.0,0.0],[419.0,1.0],[420.0,0.0],[421.0,1.0],[422.0,0.0],[423.0,1.0],[424.0,0.0],[425.0,1.0],[426.0,0.0],[427.0,1.0],[428.0,0.0],[429.0,1.0],[430.0,0.0],[431.0,1.0],[432.0,0.0],[433.0,1.0],[434.0,0.0],[435.0,1.0],[436.0,0.0],[437.0,1.0],[438.0,0.0],[439.0,1.0],[440.0,0.0],[441.0,1.0],[442.0,0.0],[443.0,1.0],[444.0,0.0],[445.0,1.0],[446.0,0.0],[447.0,1.0],[448.0,0.0],[449.0,1.0],[450.0,0.0],[451.0,1.0],[452.0,0.0],[453.0,1.0],[454.0,0.0],[455.0,1.0],[456.0,0.0],[457.0,1.0],[458.0,0.0],[459.0,1.0],[460.0,0.0],[461.0,1.0],[462.0,0.0],[463.0,1.0],[464.0,0.0],[465.0,1.0],[466.0,0.0],[467.0,1.0],[468.0,0.0],[469.0,1.0],[470.0,0.0],[471.0,1.0],[472.0,0.0],[473.0,1.0],[474.0,0.0],[475.0,1.0],[476.0,0.0],[477.0,1.0],[478.0,0.0],[479.0,1.0],[480.0,0.0],[481.0,1.0],[482.0,0.0],[483.0,1.0],[484.0,0.0],[485.0,1.0],[486.0,0.0],[487.0,1.0],[488.0,0.0],[489.0,1.0],[490.0,0.0],[491.0,1.0],[492.0,0.0],[493.0,1.0],[494.0,0.0],[495.0,1.0],[496.0,0.0],[497.0,1.0],[498.0,0.0],[499.0,1.0],[500.0,0.0],[501.0,1.0],[502.0,0.0],[503.0,1.0],[504.0,0.0],[505.0,1.0],[506.0,0.0],[507.0,1.0],[508.0,0.0],[509.0,1.0],[510.0,0.0],[511.0,1.0],[512.0,0.0],[513.0,1.0],[514.0,0.0],[515.0,1.0],[516.0,0.0],[517.0,1.0],[518.0,0.0],[519.0,1.0],[520.0,0.0],[521.0,1.0],[522.0,0.0],[523.0,1.0],[524.0,0.0],[525.0,1.0],[526.0,0.0],[527.0,1.0],[528.0,0.0],[529.0,1.0],[530.0,0.0],[531.0,1.0],[532.0,0.0],[533.0,1.0],[534.0,0.0],[535.0,1.0],[536.0,0.0],[537.0,1.0],[538.0,0.0],[539.0,1.0],[540.0,0.0],[541.0,1.0],[542.0,0.0],[543.0,1.0],[544.0,0.0],[545.0,1.0],[546.0,0.0],[547.0,1.0],[548.0,0.0],[549.0,1.0],[550.0,0.0],[551.0,1.0],[552.0,0.0],[553.0,1.0],[554.0,0.0],[555.0,1.0],[556.0,0.0],[557.0,1.0],[558.0,0.0],[559.0,1.0],[560.0,0.0],[561.0,1.0],[562.0,0.0],[563.0,1.0],[564.0,0.0],[565.0,1.0],[566.0,0.0],[567.0,1.0],[568.0,0.0],[569.0,1.0],[570.0,0.0],[571.0,1.0],[572.0,0.0],[573.0,1.0],[574.0,0.0],[575.0,1.0],[576.0,0.0],[577.0,1.0],[578.0,0.0],[579.0,1.0],[580.0,0.0],[581.0,1.0],[582.0,0.0],[583.0,1.0],[584.0,0.0],[585.0,1.0],[586.0,0.0],[587.0,1.0],[588.0,0.0],[589.0,1.0],[590.0,0.0],[591.0,1.0],[592.0,0.0],[593.0,1.0],[594.0,0.0],[595.0,1.0],[596.0,0.0],[597.0,1.0],[598.0,0.0],[599.0,1.0],[600.0,0.0],[601.0,1.0],[602.0,0.0],[603.0,1.0],[604.0,0.0],[605.0,1.0],[606.0,0.0],[607.0,1.0],[608.0,0.0],[609.0,1.0],[610.0,0.0],[611.0,1.0],[612.0,0.0],[613.0,1.0],[614.0,0.0],[615.0,1.0],[616.0,0.0],[617.0,1.0],[618.0,0.0],[619.0,1.0],[620.0,0.0],[621.0,1.0],[622.0,0.0],[623.0,1.0],[624.0,0.0],[625.0,1.0],[626.0,0.0],[627.0,1.0],[628.0,0.0],[629.0,1.0],[630.0,0.0],[631.0,1.0],[632.0,0.0],[633.0,1.0],[634.0,0.0],[635.0,1.0],[636.0,0.0],[637.0,1.0],[638.0,0.0],[639.0,1.0],[640.0,0.0],[641.0,1.0],[642.0,0.0],[643.0,1.0],[644.0,0.0],[645.0,1.0],[646.0,0.0],[647.0,1.0],[648.0,0.0],[649.0,1.0],[650.0,0.0],[651.0,1.0],[652.0,0.0],[653.0,1.0],[654.0,0.0],[655.0,1.0],[656.0,0.0],[657.0,1.0],[658.0,0.0],[659.0,1.0],[660.0,0.0],[661.0,1.0],[662.0,0.0],[663.0,1.0],[664.0,0.0],[665.0,1.0],[666.0,0.0],[667.0,1.0],[668.0,0.0],[669.0,1.0],[670.0,0.0],[671.0,1.0],[672.0,0.0],[673.0,1.0],[674.0,0.0],[675.0,1.0],[676.0,0.0],[677.0,1.0],[678.0,0.0],[679.0,1.0],[680.0,0.0],[681.0,1.0],[682.0,0.0],[683.0,1.0],[684.0,0.0],[685.0,1.0],[686.0,0.0],[687.0,1.0],[688.0,0.0],[689.0,1.0],[690.0,0.0],[691.0,1.0],[692.0,0.0],[693.0,1.0],[694.0,0.0],[695.0,1.0],[696.0,0.0],[697.0,1.0],[698.0,0.0],[699.0,1.0],[700.0,0.0],[701.0,1.0],[702.0,0.0],[703.0,1.0],[704.0,0.0],[705.0,1.0],[706.0,0.0],[707.0,1.0],[708.0,0.0],[709.0,1.0],[710.0,0.0],[711.0,1.0],[712.0,0.0],[713.0,1.0],[714.0,0.0],[715.0,1.0],[716.0,0.0],[717.0,1.0],[718.0,0.0],[719.0,1.0],[720.0,0.0],[721.0,1.0],[722.0,0.0],[723.0,1.0],[724.0,0.0],[725.0,1.0],[726.0,0.0],[727.0,1.0],[728.0,0.0],[729.0,1.0],[730.0,0.0],[731.0,1.0],[732.0,0.0],[733.0,1.0],[734.0,0.0],[735.0,1.0],[736.0,0.0],[737.0,1.0],[738.0,0.0],[739.0,1.0],[740.0,0.0],[741.0,1.0],[742.0,0.0],[743.0,1.0],[744.0,0.0],[745.0,1.0],[746.0,0.0],[747.0,1.0],[748.0,0.0],[749.0,1.0],[750.0,0.0],[751.0,1.0],[752.0,0.0],[753.0,1.0],[754.0,0.0],[755.0,1.0],[756.0,0.0],[757.0,1.0],[758.0,0.0],[759.0,1.0],[760.0,0.0],[761.0,1.0],[762.0,0.0],[763.0,1.0],[764.0,0.0],[765.0,1.0],[766.0,0.0],[767.0,1.0],[768.0,0.0],[769.0,1.0],[770.0,0.0],[771.0,1.0],[772.0,0.0],[773.0,1.0],[774.0,0.0],[775.0,1.0],[776.0,0.0],[777.0,1.0],[778.0,0.0],[779.0,1.0],[780.0,0.0],[781.0,1.0],[782.0,0.0],[783.0,1.0],[784.0,0.0],[785.0,1.0],[786.0,0.0],[787.0,1.0],[788.0,0.0],[789.0,1.0],[790.0,0.0],[791.0,1.0],[792.0,0.0],[793.0,1.0],[794.0,0.0],[795.0,1.0],[796.0,0.0],[797.0,1.0],[798.0,0.0],[799.0,1.0],[800.0,0.0],[801.0,1.0],[802.0,0.0],[803.0,1.0],[804.0,0.0],[805.0,1.0],[806.0,0.0],[807.0,1.0],[808.0,0.0],[809.0,1.0],[810.0,0.0],[811.0,1.0],[812.0,0.0],[813.0,1.0],[814.0,0.0],[815.0,1.0],[816.0,0.0],[817.0,1.0],[818.0,0.0],[819.0,1.0],[820.0,0.0],[821.0,1.0],[822.0,0.0],[823.0,1.0],[824.0,0.0],[825.0,1.0],[826.0,0.0],[827.0,1.0],[828.0,0.0],[829.0,1.0],[830.0,0.0],[831.0,1.0],[832.0,0.0],[833.0,1.0],[834.0,0.0],[835.0,1.0],[836.0,0.0],[837.0,1.0],[838.0,0.0],[839.0,1.0],[840.0,0.0],[841.0,1.0],[842.0,0.0],[843.0,1.0],[844.0,0.0],[845.0,1.0],[846.0,0.0],[847.0,1.0],[848.0,0.0],[849.0,1.0],[850.0,0.0],[851.0,1.0],[852.0,0.0],[853.0,1.0],[854.0,0.0],[855.0,1.0],[856.0,0.0],[857.0,1.0],[858.0,0.0],[859.0,1.0],[860.0,0.0],[861.0,1.0],[862.0,0.0],[863.0,1.0],[864.0,0.0],[865.0,1.0],[866.0,0.0],[867.0,1.0],[868.0,0.0],[869.0,1.0],[870.0,0.0],[871.0,1.0],[872.0,0.0],[873.0,1.0],[874.0,0.0],[875.0,1.0],[876.0,0.0],[877.0,1.0],[878.0,0.0],[879.0,1.0],[880.0,0.0],[881.0,1.0],[882.0,0.0],[883.0,1.0],[884.0,0.0],[885.0,1.0],[886.0,0.0],[887.0,1.0],[888.0,0.0],[889.0,1.0],[890.0,0.0],[891.0,1.0],[892.0,0.0],[893.0,1.0],[894.0,0.0],[895.0,1.0],[896.0,0.0],[897.0,1.0],[898.0,0.0],[899.0,1.0],[900.0,0.0],[901.0,1.0],[902.0,0.0],[903.0,1.0],[904.0,0.0],[905.0,1.0],[906.0,0.0],[907.0,1.0],[908.0,0.0],[909.0,1.0],[910.0,0.0],[911.0,1.0],[912.0,0.0],[913.0,1.0],[914.0,0.0],[915.0,1.0],[916.0,0.0],[917.0,1.0],[918.0,0.0],[919.0,1.0],[920.0,0.0],[921.0,1.0],[922.0,0.0],[923.0,1.0],[924.0,0.0],[925.0,1.0],[926.0,0.0],[927.0,1.0],[928.0,0.0],[929.0,1.0],[930.0,0.0],[931.0,1.0],[932.0,0.0],[933.0,1.0],[934.0,0.0],[935.0,1.0],[936.0,0.0],[937.0,1.0],[938.0,0.0],[939.0,1.0],[940.0,0.0],[941.0,1.0],[942.0,0.0],[943.0,1.0],[944.0,0.0],[945.0,1.0],[946.0,0.0],[947.0,1.0],[948.0,0.0],[949.0,1.0],[950.0,0.0],[951.0,1.0],[952.0,0.0],[953.0,1.0],[954.0,0.0],[955.0,1.0],[956.0,0.0],[957.0,1.0],[958.0,0.0],[959.0,1.0],[960.0,0.0],[961.0,1.0],[962.0,0.0],[963.0,1.0],[964.0,0.0],[965.0,1.0],[966.0,0.0],[967.0,1.0],[968.0,0.0],[969.0,1.0],[970.0,0.0],[971.0,1.0],[972.0,0.0],[973.0,1.0],[974.0,0.0],[975.0,1.0],[976.0,0.0],[977.0,1.0],[978.0,0.0],[979.0,1.0],[980.0,0.0],[981.0,1.0],[982.0,0.0],[983.0,1.0],[984.0,0.0],[985.0,1.0],[986.0,0.0],[987.0,1.0],[988.0,0.0],[989.0,1.0],[990.0,0.0],[991.0,1.0],[992.0,0.0],[993.0,1.0],[994.0,0.0],[995.0,1.0],[996.0,0.0],[997.0,1.0],[998.0,0.0],[999.0,1.0],[1000.0,0.0]],"arguments":{},"schema":[{"type":"int","name":"num"},{"type":"int","name":"bit"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"<div class=\"ansiout\">&lt;console&gt;:38: error: overloaded method value display with alternatives:\n  (model: org.apache.spark.mllib.clustering.KMeansModel)Unit &lt;and&gt;\n  (data: Seq[org.apache.spark.sql.Row])Unit &lt;and&gt;\n  (schemaSeq: com.databricks.SchemaSeq[_])Unit &lt;and&gt;\n  (dataFrame: org.apache.spark.sql.DataFrame)Unit\n cannot be applied to (List[Bit])\n              display(array)\n              ^\n</div>","startTime":1.440794210942E12,"submitTime":1.440794210836E12,"finishTime":1.440794211957E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a8e27743-e650-4be4-984e-f5a0fc01d27e"},{"version":"CommandV1","origId":1649,"guid":"8f1b8cd7-1955-46c9-ab6e-6f7d2b18b9b9","subtype":"command","commandType":"auto","position":3.1875,"command":"%md\n\n### Spark will choose a **ShuffledHashJoin** to join with a small temporary table.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708119654E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"da08806d-503b-4ca8-bc3a-509f88d18286"},{"version":"CommandV1","origId":1650,"guid":"2ddab2c0-68e9-4b79-a834-8664980141a6","subtype":"command","commandType":"auto","position":3.25,"command":"case class Bit(bit:Int)\nval array = for (i <- List.range(0, 2)) yield Bit(i)\nval dataFrame = sqlContext.createDataFrame(sc.parallelize(array))\n\ndataFrame.registerTempTable(\"my_small_temp_table\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Bit\narray: List[Bit] = List(Bit(0), Bit(1))\ndataFrame: org.apache.spark.sql.DataFrame = [bit: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\">&lt;console&gt;:39: error: value registerTempTable is not a member of org.apache.spark.rdd.RDD[Bit]\n              dataFrame.registerTempTable(&quot;my_small_temp_table&quot;)\n                        ^\n</div>","startTime":1.440794214028E12,"submitTime":1.440794213954E12,"finishTime":1.440794215058E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1da816a1-2fe9-4786-b77f-fcd1d3f7d1d0"},{"version":"CommandV1","origId":1651,"guid":"9ceb8aaa-60c0-4a36-9199-b22ff7598a92","subtype":"command","commandType":"auto","position":3.5,"command":"%md\n\n### **Tip: explain** can be used to print out the Spark execution plan for a Spark SQL query.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708119767E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"d558fcc8-f2d1-43b2-8248-f36c51c99525"},{"version":"CommandV1","origId":1652,"guid":"1ccb92cd-1ce7-46b7-abbc-adc451f66678","subtype":"command","commandType":"auto","position":4.5,"command":"%sql \n--- Notice the \"ShuffleHashJoin\" in the execution plan.\nexplain select * from my_large_table join my_small_temp_table on my_large_table.bit = my_small_temp_table.bit","commandVersion":0,"state":"finished","results":{"type":"table","data":[["== Physical Plan =="],["TungstenProject [num#114,bit#115,bit#116]"],[" SortMergeJoin [bit#115], [bit#116]"],["  TungstenSort [bit#115 ASC], false, 0"],["   TungstenExchange hashpartitioning(bit#115)"],["    ConvertToUnsafe"],["     Repartition 100, true"],["      Scan PhysicalRDD[num#114,bit#115]"],["  TungstenSort [bit#116 ASC], false, 0"],["   TungstenExchange hashpartitioning(bit#116)"],["    ConvertToUnsafe"],["     Scan PhysicalRDD[bit#116]"]],"arguments":{},"schema":[{"type":"string","name":"plan"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.440794215303E12,"submitTime":1.440794215254E12,"finishTime":1.440794216531E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"3523554b-4352-47f5-8cdc-b47e5e378e7f"},{"version":"CommandV1","origId":1653,"guid":"442ac0fb-94e8-40e5-bc5e-b19d6c0e4d7f","subtype":"command","commandType":"auto","position":5.5,"command":"%md\n\n### **ShuffleHashJoin** is not a great way to join the two tables above.\n*  It will take all the rows in my_large_table and shuffle them with the \"bit\" key.\n* **NOTE:** There will only be **2** non-empty partitions for the whole table, and adding more worker nodes to the job would not help.\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.44070811988E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"a665c988-d055-4057-aa1a-76b72009cdab"},{"version":"CommandV1","origId":1654,"guid":"c9b3a773-89ed-4535-8fe0-774a37045658","subtype":"command","commandType":"auto","position":6.5,"command":"def output_index_and_count(index : Int, iter : Iterator[Any]): Iterator[(Int,Int)] = {\n  Iterator((index,iter.size))\n}\n\nsqlContext.sql(\"select * from my_large_table join my_small_temp_table on my_large_table.bit = my_small_temp_table.bit\").rdd.mapPartitionsWithIndex(output_index_and_count).filter( x => x._2 > 0).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">output_index_and_count: (index: Int, iter: Iterator[Any])Iterator[(Int, Int)]\nres3: Array[(Int, Int)] = Array((169,499999), (170,500000))\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Cancelled","startTime":1.440794216876E12,"submitTime":1.440794216813E12,"finishTime":1.440794248463E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"df880abc-2ee7-4bd2-b192-d0a385d45543"},{"version":"CommandV1","origId":1655,"guid":"c362aa76-d58b-4f07-a4d9-36bdef04e877","subtype":"command","commandType":"auto","position":7.5,"command":"%md \n### **BroadcastHashJoin** is a much better way to join these two tables.\n* Spark SQL detects that one table is small enough to broadcast.\n* The small table is broadcast to each Spark worker, and joined with each element in the larger RDD.\n* There will be more than 2 non-empty partitions, so Spark would run faster with more than two worker nodes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708119962E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"c5e9b163-383f-46fe-9848-58b52657d720"},{"version":"CommandV1","origId":1656,"guid":"0f6a95d7-8475-4cd1-aa9b-137a1cd21e0a","subtype":"command","commandType":"auto","position":8.5,"command":"%md\n\nIn order to configure a BroadcastHashJoin, save the table with DataFrames API. In that way spark will automatically figure out that the table is small enough to be broadcasted.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708120001E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"b0f9ef4b-a68c-44e0-9900-bdc6dfe35475"},{"version":"CommandV1","origId":1657,"guid":"8f732a94-82c7-4a59-8eae-44ac7ee79d78","subtype":"command","commandType":"auto","position":10.0,"command":"%sql DROP TABLE IF EXISTS my_small_table","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":"No repl with id 8507858208964368483","error":null,"startTime":1.440794248471E12,"submitTime":1.440794219195E12,"finishTime":1.440794251691E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"fa767ece-eb82-44f4-9e36-92876223ce42"},{"version":"CommandV1","origId":1658,"guid":"ddd08208-c071-4003-bb94-ac0b31593668","subtype":"command","commandType":"auto","position":10.25,"command":"case class Bit(bit:Int)\nval array = for (i <- List.range(0, 2)) yield Bit(i)\nval dataFrame = sqlContext.createDataFrame(sc.parallelize(array))\ndataFrame.write.saveAsTable(\"my_small_table\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\ndefined class Bit\narray: List[Bit] = List(Bit(0), Bit(1))\ndataFrame: org.apache.spark.sql.DataFrame = [bit: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":"org.apache.spark.sql.AnalysisException: Table my_small_table already exists.;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:192)</div>","startTime":1.440794251698E12,"submitTime":1.440794221178E12,"finishTime":1.440794262057E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"fe2f3e8d-434f-409d-8bf1-20e12c0e3baa"},{"version":"CommandV1","origId":1659,"guid":"9b84bafc-4b0d-4f2f-94f5-4922a1399037","subtype":"command","commandType":"auto","position":10.359375,"command":"%md ###Use an explain command to see the BroadcastHashJoin","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708120542E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"e0b00916-e0d6-4fdc-adf0-9214a8327601"},{"version":"CommandV1","origId":1660,"guid":"e3cbb52b-2a74-484d-9d12-a86ca27e3765","subtype":"command","commandType":"auto","position":10.6796875,"command":"%sql EXPLAIN select * from my_large_table join my_small_table on my_large_table.bit = my_small_table.bit","commandVersion":0,"state":"finished","results":{"type":"table","data":[["== Physical Plan =="],["TungstenProject [num#114,bit#115,bit#123]"],[" BroadcastHashJoin [bit#115], [bit#123], BuildRight"],["  ConvertToUnsafe"],["   Repartition 100, true"],["    Scan PhysicalRDD[num#114,bit#115]"],["  ConvertToUnsafe"],["   Scan ParquetRelation[dbfs:/user/hive/warehouse/my_small_table][bit#123]"]],"arguments":{},"schema":[{"type":"string","name":"plan"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Error in SQL statement: com.databricks.backend.daemon.driver.DriverLocal$SQLExecutionException: org.apache.spark.sql.AnalysisException: cannot recognize input near '\"select * from my_large_table join my_small_table on my_large_table.bit = my_small_table.bit\"' '<EOF>' '<EOF>' in statement; line 1 pos 8\n\tat org.apache.spark.sql.hive.HiveQl$.createPlan(HiveQl.scala:289)\n\tat org.apache.spark.sql.hive.ExtendedHiveQlParser$$anonfun$hiveQl$1.apply(ExtendedHiveQlParser.scala:41)\n\tat org.apache.spark.sql.hive.ExtendedHiveQlParser$$anonfun$hiveQl$1.apply(ExtendedHiveQlParser.scala:40)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:136)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:135)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Failure.append(Parsers.scala:202)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat scala.util.parsing.combinator.Parsers$$anon$2.apply(Parsers.scala:890)\n\tat scala.util.parsing.combinator.PackratParsers$$anon$1.apply(PackratParsers.scala:110)\n\tat org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:34)\n\tat org.apache.spark.sql.hive.HiveQl$.parseSql(HiveQl.scala:269)\n\tat org.apache.spark.sql.hive.HiveQLDialect.parse(HiveContext.scala:61)\n\tat org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:145)\n\tat org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:145)\n\tat org.apache.spark.sql.SparkSQLParser$$anonfun$org$apache$spark$sql$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:95)\n\tat org.apache.spark.sql.SparkSQLParser$$anonfun$org$apache$spark$sql$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:94)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:136)\n\tat scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:135)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:242)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Failure.append(Parsers.scala:202)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:254)\n\tat scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:222)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:891)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat scala.util.parsing.combinator.Parsers$$anon$2.apply(Parsers.scala:890)\n\tat scala.util.parsing.combinator.PackratParsers$$anon$1.apply(PackratParsers.scala:110)\n\tat org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:34)\n\tat org.apache.spark.sql.SQLContext$$anonfun$1.apply(SQLContext.scala:142)\n\tat org.apache.spark.sql.SQLContext$$anonfun$1.apply(SQLContext.scala:142)\n\tat org.apache.spark.sql.sources.DDLParser.parse(ddl.scala:48)\n\tat org.apache.spark.sql.SQLContext.parseSql(SQLContext.scala:165)\n\tat org.apache.spark.sql.hive.HiveContext.parseSql(HiveContext.scala:264)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:755)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:307)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:287)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:287)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:321)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)\n","startTime":1.440794262064E12,"submitTime":1.440794222852E12,"finishTime":1.440794262327E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"89bbc60e-7f95-4d5f-b3a3-09de5d25dca4"},{"version":"CommandV1","origId":1661,"guid":"b0a27a97-a3e9-41b6-93c9-89904455fe0c","subtype":"command","commandType":"auto","position":11.0,"command":"%md If you didn't see a BroadcastHashJoin - uncomment and run the following cell:\n* Older versions of Spark prior to Spark 1.4 will need you to run an analyze on that table.\n* With Spark 1.4 - tables created with Hive DDL's rather than the Dataframes API may also need an analyze command.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708120668E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"7994d984-5085-4105-9065-96995d18f6ec"},{"version":"CommandV1","origId":1662,"guid":"8cd42ef2-b4f4-43ba-aaaa-4945696f473f","subtype":"command","commandType":"auto","position":11.25,"command":"%sql \n-- ANALYZE TABLE my_small_table COMPUTE STATISTICS noscan","commandVersion":0,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Error in SQL statement: com.databricks.backend.daemon.driver.DriverLocal$SQLExecutionException: java.lang.UnsupportedOperationException: Analyze only works for Hive tables, but my_small_table is a LogicalRelation\n\tat org.apache.spark.sql.hive.HiveContext.analyze(HiveContext.scala:353)\n\tat org.apache.spark.sql.hive.execution.AnalyzeTable.run(commands.scala:43)\n\tat org.apache.spark.sql.execution.ExecutedCommand.sideEffectResult$lzycompute(commands.scala:57)\n\tat org.apache.spark.sql.execution.ExecutedCommand.sideEffectResult(commands.scala:57)\n\tat org.apache.spark.sql.execution.ExecutedCommand.doExecute(commands.scala:68)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:88)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:88)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:87)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd$lzycompute(SQLContext.scala:955)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd(SQLContext.scala:955)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:148)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:132)\n\tat org.apache.spark.sql.DataFrame$.apply(DataFrame.scala:55)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:755)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:307)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$5.apply(DriverLocal.scala:287)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:287)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:321)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:162)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)\n","startTime":1.440794262334E12,"submitTime":1.440794226279E12,"finishTime":1.440794262335E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"0f8bbbcb-49e6-47e3-8708-33f3c3b39bcd"},{"version":"CommandV1","origId":1663,"guid":"688e62ac-b815-4029-b161-788400651bcb","subtype":"command","commandType":"auto","position":11.3125,"command":"%md\n\n### Run join of the tables with the BroadcastHashJoin","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null,"nuid":"492e9560-429c-40de-8eaa-3ba161a8a568"},{"version":"CommandV1","origId":1664,"guid":"e736cb72-dac5-4c67-a22c-3cee2239d964","subtype":"command","commandType":"auto","position":11.375,"command":"val broadcastHashJoinRdd = sqlContext.sql(\"select * from my_large_table join my_small_table on my_large_table.bit = my_small_table.bit\").rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">broadcastHashJoinRdd: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[145] at rdd at &lt;console&gt;:26\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.440794288797E12,"submitTime":1.44079428874E12,"finishTime":1.440794290057E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"7f0c576c-ffbc-4364-808a-b5fbf4abd7aa"},{"version":"CommandV1","origId":1665,"guid":"821da08c-32c0-47a7-8a53-431fd88c21a6","subtype":"command","commandType":"auto","position":11.5,"command":"%md\n### **NOTE:** See how there are still 100 evenly split partitions in the RDD.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708120778E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"493447c1-753a-4587-86f6-bc8177000da6"},{"version":"CommandV1","origId":1666,"guid":"15511f30-601c-4ae2-af8b-652fa4163e8b","subtype":"command","commandType":"auto","position":12.5,"command":"def output_index_and_count(index : Int, iter : Iterator[Any]): Iterator[(Int,Int)] = {\n  Iterator((index,iter.size))\n}\n\nbroadcastHashJoinRdd.mapPartitionsWithIndex(output_index_and_count).filter(x => x._2 > 0).collect()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">output_index_and_count: (index: Int, iter: Iterator[Any])Iterator[(Int, Int)]\nres5: Array[(Int, Int)] = Array((0,10000), (1,10000), (2,10000), (3,10000), (4,10000), (5,10000), (6,10000), (7,10000), (8,10000), (9,10000), (10,10000), (11,10000), (12,10000), (13,10000), (14,10000), (15,10000), (16,10000), (17,10000), (18,10000), (19,10000), (20,10000), (21,10000), (22,10000), (23,10000), (24,10000), (25,10000), (26,10000), (27,10000), (28,10000), (29,10000), (30,10000), (31,10000), (32,10000), (33,10000), (34,10000), (35,10000), (36,10000), (37,10000), (38,10000), (39,10000), (40,10000), (41,10000), (42,10000), (43,10000), (44,10000), (45,10000), (46,10000), (47,10000), (48,10000), (49,10000), (50,10000), (51,10000), (52,10000), (53,10000), (54,10000), (55,10000), (56,10000), (57,10000), (58,10000), (59,10000), (60,9999), (61,10000), (62,10000), (63,10000), (64,10000), (65,10000), (66,10000), (67,10000), (68,10000), (69,10000), (70,10000), (71,10000), (72,10000), (73,10000), (74,10000), (75,10000), (76,10000), (77,10000), (78,10000), (79,10000), (80,10000), (81,10000), (82,10000), (83,10000), (84,10000), (85,10000), (86,10000), (87,10000), (88,10000), (89,10000), (90,10000), (91,10000), (92,10000), (93,10000), (94,10000), (95,10000), (96,10000), (97,10000), (98,10000), (99,10000))\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:37: error: not found: value broadcastHashJoinRdd\n              broadcastHashJoinRdd.mapPartitionsWithIndex(output_index_and_count).filter(x =&gt; x._2 &gt; 0).collect()\n              ^\n</div>","error":null,"startTime":1.440794291046E12,"submitTime":1.440794290996E12,"finishTime":1.440794294977E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"6f6bb32d-ed1d-452d-ae3a-d551e6930a89"},{"version":"CommandV1","origId":1667,"guid":"b2f5ec2f-5e0d-43f1-8055-0976023a2e69","subtype":"command","commandType":"auto","position":13.5,"command":"%md\n\n### **Cleanup:** Delete any tables that were created for this example.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.440708120876E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"jason@databricks.com","iPythonMetadata":null,"nuid":"c6b9dfd7-7d42-41e3-bad4-68bacd9dee04"},{"version":"CommandV1","origId":1668,"guid":"322435a0-9a71-4eed-b88d-328fa77dafd6","subtype":"command","commandType":"auto","position":14.5,"command":"%sql DROP TABLE IF EXISTS my_small_table","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":"Command skipped","error":null,"startTime":1.440794294983E12,"submitTime":1.44079429426E12,"finishTime":1.440794295977E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a216f8e3-9862-424c-b365-bf032d3cb039"}],"guid":"86285a80-a21d-4668-acde-7421f3a28c02","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"d2c387c9-2dbb-4fbe-a0ca-e1326e74a206","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>