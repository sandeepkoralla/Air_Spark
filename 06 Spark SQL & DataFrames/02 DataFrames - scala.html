<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Spark SQL &amp; DataFrames / DataFrames - scala - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1669,"name":"Spark SQL & DataFrames / DataFrames - scala","language":"scala","commands":[{"version":"CommandV1","origId":1670,"guid":"86a47fa6-7b11-4f4a-a645-ea132544b4f6","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n\n# Spark DataFrames with Scala\nThis notebook demonstrates using a lot of common Spark DataFrame functions with Scala.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992274989E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"275d46f4-1669-407b-b9b8-e97414237d8e"},{"version":"CommandV1","origId":1671,"guid":"3ba01ed1-6b14-4a78-89e4-1c36a447bd14","subtype":"command","commandType":"auto","position":0.5,"command":"%md ### Setup: Create Sample Data to demonstrate DataFrames.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275036E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"394c81f7-a0e4-44ab-ad12-0f6bd6130d11"},{"version":"CommandV1","origId":1672,"guid":"c578ca5f-7401-4e62-a962-e8d18d652fc9","subtype":"command","commandType":"auto","position":1.0,"command":"// Create the case classes for our domain\ncase class Department(id: String, name: String)\ncase class Employee(firstName: String, lastName: String, email: String, salary: Int)\ncase class DepartmentWithEmployees(department: Department, employees: Seq[Employee])\n\n// Create the Departments\nval department1 = new Department(\"123456\", \"Computer Science\")\nval department2 = new Department(\"789012\", \"Mechanical Engineering\")\nval department3 = new Department(\"345678\", \"Theater and Drama\")\nval department4 = new Department(\"901234\", \"Indoor Recreation\")\n\n// Create the Employees\nval employee1 = new Employee(\"michael\", \"armbrust\", \"no-reply@berkeley.edu\", 100000)\nval employee2 = new Employee(\"chris\", \"fregly\", \"no-reply@northwestern.edu\", 120000)\nval employee3 = new Employee(\"matei\", null, \"no-reply@waterloo.edu\", 140000)\nval employee4 = new Employee(null, \"wendell\", \"no-reply@princeton.edu\", 160000)\n\n// Create the DepartmentWithEmployees instances from Departments and Employees\nval departmentWithEmployees1 = new DepartmentWithEmployees(department1, Seq(employee1, employee2))\nval departmentWithEmployees2 = new DepartmentWithEmployees(department2, Seq(employee3, employee4))\nval departmentWithEmployees3 = new DepartmentWithEmployees(department3, Seq(employee1, employee4))\nval departmentWithEmployees4 = new DepartmentWithEmployees(department4, Seq(employee2, employee3))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Department\ndefined class Employee\ndefined class DepartmentWithEmployees\ndepartment1: Department = Department(123456,Computer Science)\ndepartment2: Department = Department(789012,Mechanical Engineering)\ndepartment3: Department = Department(345678,Theater and Drama)\ndepartment4: Department = Department(901234,Indoor Recreation)\nemployee1: Employee = Employee(michael,armbrust,no-reply@berkeley.edu,100000)\nemployee2: Employee = Employee(chris,fregly,no-reply@northwestern.edu,120000)\nemployee3: Employee = Employee(matei,null,no-reply@waterloo.edu,140000)\nemployee4: Employee = Employee(null,wendell,no-reply@princeton.edu,160000)\ndepartmentWithEmployees1: DepartmentWithEmployees = DepartmentWithEmployees(Department(123456,Computer Science),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(chris,fregly,no-reply@northwestern.edu,120000)))\ndepartmentWithEmployees2: DepartmentWithEmployees = DepartmentWithEmployees(Department(789012,Mechanical Engineering),List(Employee(matei,null,no-reply@waterloo.edu,140000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees3: DepartmentWithEmployees = DepartmentWithEmployees(Department(345678,Theater and Drama),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees4: DepartmentWithEmployees = DepartmentWithEmployees(Department(901234,Indoor Recreation),List(Employee(chris,fregly,no-reply@northwestern.edu,120000), Employee(matei,null,no-reply@waterloo.edu,140000)))\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\">java.lang.AssertionError: assertion failed: Tried to find '$read$.class' in '/tmp/spark-cf5981f4-ea25-4453-ba1e-2899ab80d05b/line8f39d1e722f3474f96fc099e71eba05e19' but it is not a directory\n\tat scala.reflect.io.AbstractFile.fileNamed(AbstractFile.scala:245)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$class.getFile(BytecodeWriters.scala:34)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$class.scala$tools$nsc$backend$jvm$BytecodeWriters$$getFile(BytecodeWriters.scala:37)\n\tat scala.tools.nsc.backend.jvm.BytecodeWriters$ClassBytecodeWriter$class.writeClass(BytecodeWriters.scala:89)\n\tat scala.tools.nsc.backend.jvm.GenASM$AsmPhase$$anon$4.writeClass(GenASM.scala:67)\n\tat scala.tools.nsc.backend.jvm.GenASM$JBuilder.writeIfNotTooBig(GenASM.scala:459)\n\tat scala.tools.nsc.backend.jvm.GenASM$JPlainBuilder.genClass(GenASM.scala:1413)\n\tat scala.tools.nsc.backend.jvm.GenASM$AsmPhase.run(GenASM.scala:120)\n\tat scala.tools.nsc.Global$Run.compileUnitsInternal(Global.scala:1583)\n\tat scala.tools.nsc.Global$Run.compileUnits(Global.scala:1557)\n\tat scala.tools.nsc.Global$Run.compileSources(Global.scala:1553)\n\tat org.apache.spark.repl.SparkIMain.org$apache$spark$repl$SparkIMain$$compileSourcesKeepingRun(SparkIMain.scala:663)\n\tat org.apache.spark.repl.SparkIMain$ReadEvalPrint.compileAndSaveRun(SparkIMain.scala:1136)\n\tat org.apache.spark.repl.SparkIMain$ReadEvalPrint.compile(SparkIMain.scala:1092)\n\tat org.apache.spark.repl.SparkIMain$Request.compile$lzycompute(SparkIMain.scala:1286)\n\tat org.apache.spark.repl.SparkIMain$Request.compile(SparkIMain.scala:1281)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:870)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:819)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:400)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:356)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:108)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:159)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:484)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:481)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:383)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:194)\n\tat java.lang.Thread.run(Thread.java:745)</div>","startTime":1.434992275935E12,"submitTime":1.434992275052E12,"finishTime":1.43499228323E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"daf99501-543f-4da8-a6a3-bbbae6c45cb6"},{"version":"CommandV1","origId":1673,"guid":"23b64aba-08ec-4a9a-8e2a-dfd160fe9fe1","subtype":"command","commandType":"auto","position":1.5,"command":"%md Create the first DataFrame from a List of the Case Classes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275071E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"613db364-fadb-40c9-8277-6c95d22eeda3"},{"version":"CommandV1","origId":1674,"guid":"1ec1ae78-882e-4898-9073-979ee803e2d6","subtype":"command","commandType":"auto","position":2.0,"command":"val departmentsWithEmployeesSeq1 = Seq(departmentWithEmployees1, departmentWithEmployees2)\nval df1 = departmentsWithEmployeesSeq1.toDF()\n\ndisplay(df1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]]]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992283245E12,"submitTime":1.434992275088E12,"finishTime":1.434992284463E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"4f61d80b-f0c5-4e65-bb7d-0336103d8781"},{"version":"CommandV1","origId":1675,"guid":"822a04f4-eb67-4479-ae02-f24e42cf4dc9","subtype":"command","commandType":"auto","position":2.125,"command":"%md Create a 2nd DataFrame from a List of Case Classes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275105E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"849c9fda-a499-42cd-afd5-d77b9745e90b"},{"version":"CommandV1","origId":1676,"guid":"99811989-e7f9-4432-b4bf-57168861053b","subtype":"command","commandType":"auto","position":2.25,"command":"val departmentsWithEmployeesSeq2 = Seq(departmentWithEmployees3, departmentWithEmployees4)\nval df2 = departmentsWithEmployeesSeq2.toDF()\ndisplay(df2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]]],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]]]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992284477E12,"submitTime":1.434992275124E12,"finishTime":1.434992285022E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"ec9130c1-de94-4ef5-a458-f2efa0f00078"},{"version":"CommandV1","origId":1677,"guid":"b5518b75-b027-41db-bbf1-0a6ed604d461","subtype":"command","commandType":"auto","position":2.375,"command":"%md\n\n### Working with DataFrames","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275138E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"a26a9c14-886a-4f37-80c2-95ce5d468ae3"},{"version":"CommandV1","origId":1678,"guid":"41ce80f4-7d76-47c6-8bf9-af345da89496","subtype":"command","commandType":"auto","position":2.5,"command":"%md Union 2 DataFrames.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275167E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"c792f393-ee46-4d06-93b9-9942dba16ba7"},{"version":"CommandV1","origId":1679,"guid":"8e703e0d-56dd-4a76-9fef-a2548bd618a1","subtype":"command","commandType":"auto","position":3.0,"command":"val unionDF = df1.unionAll(df2)\ndisplay(unionDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]]],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]]],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]]]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992285045E12,"submitTime":1.43499227518E12,"finishTime":1.434992285441E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"45bb85bf-9c6e-4393-b9a1-1af0f4bc6488"},{"version":"CommandV1","origId":1680,"guid":"c8fa25d4-f175-4784-baa7-0705fab6d228","subtype":"command","commandType":"auto","position":3.03125,"command":"%md Write the Unioned DataFrame to a Parquet file.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275195E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"13e54bb6-60f3-471a-b497-07f77f4e5aa8"},{"version":"CommandV1","origId":1681,"guid":"6a5b2c49-59b0-467c-9bbc-faf220ca65c8","subtype":"command","commandType":"auto","position":3.0625,"command":"// Remove the file if it exists\ndbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", true)\n\nunionDF.write.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434992285456E12,"submitTime":1.434992275214E12,"finishTime":1.434992288688E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"a9207936-f7fa-44e9-aeda-47583c6ebc82"},{"version":"CommandV1","origId":1682,"guid":"eed0602b-5df2-412d-a20c-a0b7b896cf34","subtype":"command","commandType":"auto","position":3.078125,"command":"%md Read a DataFrame from the Parquet file.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.43499227523E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"c42c03b1-c64d-4875-a62b-38598ca51b1d"},{"version":"CommandV1","origId":1683,"guid":"5a5abc8c-ef30-45cd-88fb-204834df1d24","subtype":"command","commandType":"auto","position":3.09375,"command":"val parquetDF = sqlContext.read.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">parquetDF: org.apache.spark.sql.DataFrame = [department: struct&lt;id:string,name:string&gt;, employees: array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:int&gt;&gt;]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.4349922887E12,"submitTime":1.434992275254E12,"finishTime":1.43499228934E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"c1fc5cbb-586f-44d7-b17e-a0e54c62b86e"},{"version":"CommandV1","origId":1684,"guid":"c536f44b-1f0a-4113-acaa-ea21dd07677b","subtype":"command","commandType":"auto","position":3.125,"command":"%md Explode the employees column.\n\n(Ignore the warning that is generated.)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.43499227527E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"a628b249-e95f-4ca2-b717-7084458a5a2d"},{"version":"CommandV1","origId":1685,"guid":"7d0747d2-81de-496f-a83a-07f61f9327ec","subtype":"command","commandType":"auto","position":3.5,"command":"val explodeDF = parquetDF.explode($\"employees\") { \n  case Row(employee: Seq[Row]) => employee.map{ employee =>\n    val firstName = employee(0).asInstanceOf[String]\n    val lastName = employee(1).asInstanceOf[String]\n    val email = employee(2).asInstanceOf[String]\n    val salary = employee(3).asInstanceOf[Int]\n    Employee(firstName, lastName, email, salary)\n  }\n}.cache()\ndisplay(explodeDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"matei",null,"no-reply@waterloo.edu",140000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"matei",null,"no-reply@waterloo.edu",140000.0],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],null,"wendell","no-reply@princeton.edu",160000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],null,"wendell","no-reply@princeton.edu",160000.0]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"},{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"string","name":"email"},{"type":"int","name":"salary"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992289352E12,"submitTime":1.434992275285E12,"finishTime":1.434992291067E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"835e8cee-3f1e-473b-9232-6c0b169a7032"},{"version":"CommandV1","origId":1686,"guid":"5c2ee8c7-8c88-4145-a078-e7a3bdc70fd1","subtype":"command","commandType":"auto","position":3.5625,"command":"explodeDF","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res5: org.apache.spark.sql.DataFrame = [department: struct&lt;id:string,name:string&gt;, employees: array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:int&gt;&gt;, firstName: string, lastName: string, email: string, salary: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434992291075E12,"submitTime":1.434992275302E12,"finishTime":1.434992291203E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"50788117-05e2-478b-9099-1437ec1d02d4"},{"version":"CommandV1","origId":1687,"guid":"272dffc2-463c-476e-b832-6a6109cefeb4","subtype":"command","commandType":"auto","position":3.625,"command":"%md Use ``filter()`` to return only the rows that match the given predicate.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275326E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"d8a7ebca-9615-4dd3-a9d2-7ad32973ef50"},{"version":"CommandV1","origId":1688,"guid":"d80900ca-1164-441e-bbf6-aa5288d4b414","subtype":"command","commandType":"auto","position":3.75,"command":"val filterDF = explodeDF.filter($\"firstName\" === \"chris\" || $\"firstName\" \n === \"michael\").sort($\"lastName\".asc)\ndisplay(filterDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"},{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"string","name":"email"},{"type":"int","name":"salary"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992291215E12,"submitTime":1.434992275341E12,"finishTime":1.434992291599E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"17077fb7-493d-4f6a-af14-dade356b490e"},{"version":"CommandV1","origId":1689,"guid":"e826048d-69ff-4282-82af-98674a5bfc71","subtype":"command","commandType":"auto","position":3.78125,"command":"%md The ``where()`` clause is equivalent to ``filter()``.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275357E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"c60f5d5d-284d-4af4-aa33-326b62bcf3f9"},{"version":"CommandV1","origId":1690,"guid":"3a00895e-dce5-4dca-b71b-1171394ecfaa","subtype":"command","commandType":"auto","position":3.8125,"command":"val whereDF = explodeDF.where(($\"firstName\" === \"chris\") || ($\"firstName\" === \"michael\")).sort($\"lastName\".asc)\ndisplay(whereDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"},{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"string","name":"email"},{"type":"int","name":"salary"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992291612E12,"submitTime":1.434992275371E12,"finishTime":1.434992291893E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"ee47f56c-bf7d-470f-901b-9a067168b7ae"},{"version":"CommandV1","origId":1691,"guid":"8322cb8e-5ebe-4594-8018-f57b468674b1","subtype":"command","commandType":"auto","position":4.0,"command":"%md Replace ``null`` values with empty string using DataFrame Na functions.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275387E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"4547a401-e694-4e19-8836-cd092a4467c5"},{"version":"CommandV1","origId":1692,"guid":"1333ee8a-add1-4d1c-a6ac-8670014db8b0","subtype":"command","commandType":"auto","position":5.0,"command":"val naFunctions = explodeDF.na\nval nonNullDF = naFunctions.fill(\"\")\ndisplay(nonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"matei","","no-reply@waterloo.edu",140000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],["chris","fregly","no-reply@northwestern.edu",120000.0]],"chris","fregly","no-reply@northwestern.edu",120000.0],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"matei","","no-reply@waterloo.edu",140000.0],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"","wendell","no-reply@princeton.edu",160000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"michael","armbrust","no-reply@berkeley.edu",100000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"","wendell","no-reply@princeton.edu",160000.0]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"},{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"string","name":"email"},{"type":"int","name":"salary"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992291906E12,"submitTime":1.434992275403E12,"finishTime":1.434992292164E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"d3f02de7-89c0-40be-806a-7eea6a1ec3fd"},{"version":"CommandV1","origId":1693,"guid":"76867fc3-3e63-40e7-b68b-00e92562e378","subtype":"command","commandType":"auto","position":5.5,"command":"%md Retrieve only rows with missing firstName or lastName.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275427E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"bd7d5d56-a269-412f-80b4-a75d622da719"},{"version":"CommandV1","origId":1694,"guid":"1b3e6ed7-5df7-40e3-952f-2fee17925bdd","subtype":"command","commandType":"auto","position":6.0,"command":"val filterNonNullDF = nonNullDF.filter($\"firstName\" === \"\" || $\"lastName\" === \"\").sort($\"email\".asc)\ndisplay(filterNonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"","wendell","no-reply@princeton.edu",160000.0],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"","wendell","no-reply@princeton.edu",160000.0],[["901234","Indoor Recreation"],[["chris","fregly","no-reply@northwestern.edu",120000.0],["matei",null,"no-reply@waterloo.edu",140000.0]],"matei","","no-reply@waterloo.edu",140000.0],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000.0],[null,"wendell","no-reply@princeton.edu",160000.0]],"matei","","no-reply@waterloo.edu",140000.0]],"arguments":{},"schema":[{"type":"struct<id:string,name:string>","name":"department"},{"type":"array<struct<firstName:string,lastName:string,email:string,salary:int>>","name":"employees"},{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"string","name":"email"},{"type":"int","name":"salary"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.43499229218E12,"submitTime":1.434992275462E12,"finishTime":1.43499229248E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"7aa66a1f-2206-4888-9209-14b963e1abab"},{"version":"CommandV1","origId":1695,"guid":"b4628152-f511-457f-bdc6-a27e8dcff7e9","subtype":"command","commandType":"auto","position":6.5,"command":"%md Example aggregations using ``agg()`` and ``countDistinct()``.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275483E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"d2d79fe6-c131-47d7-a2c3-67485b5371bb"},{"version":"CommandV1","origId":1696,"guid":"04cba168-ef95-4774-84ee-450dd5a0ff7c","subtype":"command","commandType":"auto","position":6.625,"command":"import org.apache.spark.sql.functions._","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions._\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434992292493E12,"submitTime":1.434992275509E12,"finishTime":1.434992292584E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"046add5d-e09a-4a61-b86c-2b67fa06bf66"},{"version":"CommandV1","origId":1697,"guid":"1e74b4e6-c24d-41b9-ae7c-0e42c16f8710","subtype":"command","commandType":"auto","position":6.75,"command":"// Find the distinct (firstName, lastName) combinations\nval countDistinctDF = nonNullDF.select($\"firstName\", $\"lastName\")\n  .groupBy($\"firstName\", $\"lastName\")\n  .agg(countDistinct($\"firstName\") as \"distinct_first_names\") \ndisplay(countDistinctDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust",1.0],["chris","fregly",1.0],["","wendell",1.0],["matei","",1.0]],"arguments":{},"schema":[{"type":"string","name":"firstName"},{"type":"string","name":"lastName"},{"type":"bigint","name":"distinct_first_names"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992292589E12,"submitTime":1.434992275528E12,"finishTime":1.434992294121E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"f2b35aaa-800d-4cc7-a1be-b469fad8e96e"},{"version":"CommandV1","origId":1698,"guid":"86f3d6c3-1b82-441e-9a6a-c8122e7f2689","subtype":"command","commandType":"auto","position":6.8125,"command":"%md Compare the DataFrame and SQL Query Physical Plans\n(Hint:  They should be the same.)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.43499227555E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"29b9e044-2e92-4a00-a3a0-ccdff17770eb"},{"version":"CommandV1","origId":1699,"guid":"bd2678d8-b8a5-4bbc-9a48-c109e4158b71","subtype":"command","commandType":"auto","position":6.875,"command":"countDistinctDF.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\nAggregate false, [firstName#223,lastName#224], [firstName#223,lastName#224,CombineAndCount(partialSets#749) AS distinct_first_names#286L]\n Exchange (HashPartitioning 200)\n  Aggregate true, [firstName#223,lastName#224], [firstName#223,lastName#224,AddToHashSet(firstName#223) AS partialSets#749]\n   Project [Coalesce(firstName#93,) AS firstName#223,Coalesce(lastName#94,) AS lastName#224]\n    InMemoryColumnarTableScan [firstName#93,lastName#94], (InMemoryRelation [department#83,employees#84,firstName#93,lastName#94,email#95,salary#96], true, 10000, StorageLevel(true, true, false, true, 1), (!Generate UserDefinedGenerator(employees#84), true, false, [department#83,employees#84,firstName#93,lastName#94,email#95,salary#96]), None)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434993484931E12,"submitTime":1.434993484777E12,"finishTime":1.434993485067E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"876a3eb6-e02b-4700-b4ac-d841514fad60"},{"version":"CommandV1","origId":1700,"guid":"a23964b8-277e-4814-a1f5-034d5a5a58fc","subtype":"command","commandType":"auto","position":6.9375,"command":"// register the DataFrame as a temp table so that we can query it using SQL\nnonNullDF.registerTempTable(\"databricks_df_example\")\n\n// Perform the same query as the DataFrame above and return ``explain``\nsqlContext.sql(\"\"\"\nSELECT firstName, lastName, count(distinct firstName) as distinct_first_names\nFROM databricks_df_example\nGROUP BY firstName, lastName\n\"\"\").explain","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\nAggregate false, [firstName#223,lastName#224], [firstName#223,lastName#224,CombineAndCount(partialSets#713) AS distinct_first_names#680L]\n Exchange (HashPartitioning 200)\n  Aggregate true, [firstName#223,lastName#224], [firstName#223,lastName#224,AddToHashSet(firstName#223) AS partialSets#713]\n   Project [Coalesce(firstName#93,) AS firstName#223,Coalesce(lastName#94,) AS lastName#224]\n    InMemoryColumnarTableScan [firstName#93,lastName#94], (InMemoryRelation [department#83,employees#84,firstName#93,lastName#94,email#95,salary#96], true, 10000, StorageLevel(true, true, false, true, 1), (!Generate UserDefinedGenerator(employees#84), true, false, [department#83,employees#84,firstName#93,lastName#94,email#95,salary#96]), None)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434993480451E12,"submitTime":1.434993480004E12,"finishTime":1.434993480631E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"01508ea6-372c-4030-af83-54d4392e15eb"},{"version":"CommandV1","origId":1701,"guid":"0dbc4efd-68e1-4a4f-b880-996350bde287","subtype":"command","commandType":"auto","position":6.9453125,"command":"// Sum up all the salaries\nval salarySumDF = nonNullDF.agg(\"salary\" -> \"sum\") \ndisplay(salarySumDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1040000.0]],"arguments":{},"schema":[{"type":"bigint","name":"SUM(salary)"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.434992294905E12,"submitTime":1.434992275616E12,"finishTime":1.434992295479E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"36bf5c56-4fb3-4055-b684-0843a1695074"},{"version":"CommandV1","origId":1702,"guid":"281f0b70-7176-4229-ae11-5a5a2f5921ec","subtype":"command","commandType":"auto","position":6.953125,"command":"%md Print the summary statistics for the salaries.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275631E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"e2c86d9f-cb3d-44e0-b605-f069ad94c29c"},{"version":"CommandV1","origId":1703,"guid":"c5bdb6b7-04e7-44d0-a8bc-279f17dc59ce","subtype":"command","commandType":"auto","position":6.96875,"command":"nonNullDF.describe(\"salary\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+--------+\n|summary|  salary|\n+-------+--------+\n|  count|       8|\n|   mean|130000.0|\n| stddev|    null|\n|    min|  100000|\n|    max|  160000|\n+-------+--------+\n\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434992295491E12,"submitTime":1.434992275667E12,"finishTime":1.434992295873E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"f800ed96-2f04-4b85-8508-360f1c04c2ce"},{"version":"CommandV1","origId":1704,"guid":"ab55cfc4-36ee-4d23-9910-9cf9de714a83","subtype":"command","commandType":"auto","position":7.0,"command":"%md ### Cleanup: Remove the parquet file.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.434992275683E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"dc037330-2a39-4183-a1bf-180272418f1f"},{"version":"CommandV1","origId":1705,"guid":"8a2e078d-9d2e-4fa0-9af4-c1b67c89c754","subtype":"command","commandType":"auto","position":8.0,"command":"dbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res15: Boolean = true\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.434992295887E12,"submitTime":1.43499227571E12,"finishTime":1.434992296361E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"kyle@databricks.com","iPythonMetadata":null,"nuid":"2476a4f4-0a7c-4ffb-849d-5caf5b1ed198"}],"guid":"ade3b7e7-d3dc-4d0a-82ea-55832aef234c","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"f148d2c5-206f-45cb-a6f2-c884f80abcf7","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>