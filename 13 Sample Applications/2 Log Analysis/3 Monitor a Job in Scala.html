<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Sample Applications / Log Analysis / Monitor a Job in Scala - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3528,"name":"Sample Applications / Log Analysis / Monitor a Job in Scala","language":"scala","commands":[{"version":"CommandV1","origId":3529,"guid":"4daf7951-d24d-4272-a38a-cf980d793c45","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n# **Monitoring in Scala**\nThis notebook describes how to monitor runs of the log analysis notebook. ","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"# **Monitoring in Scala**\nThis notebook describes how to monitor runs of the log analysis notebook.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494366513E12,"submitTime":1.427494363626E12,"finishTime":1.427494366756E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"aafe1378-b1b0-4770-a26e-d4baf6ce7f54"},{"version":"CommandV1","origId":3530,"guid":"65763e1e-f1ea-487d-b0da-01c039eae24b","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n\n### **Step 1:** Create a table that will contain stats about the log analysis run that can be monitored.\nOptionally, these commands could be moved into the logs analysis notebook themselves if there are parameters there to track - such as the number of errored inputs, etc.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 1:** Create a table that will contain stats about the log analysis run that can be monitored.\nOptionally, these commands could be moved into the logs analysis notebook themselves if there are parameters there to track - such as the number of errored inputs, etc.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494366761E12,"submitTime":1.427494363675E12,"finishTime":1.427494366762E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"a6e4d70a-406d-458c-b27a-971b4540fd45"},{"version":"CommandV1","origId":3531,"guid":"24fcb894-f6bc-4e59-8ece-6b146b0b518a","subtype":"command","commandType":"auto","position":3.0,"command":"%sql CREATE TABLE IF NOT EXISTS logsAnalysisScala (runStart INT, runDuration INT)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[{"type":"string","name":"result"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494366766E12,"submitTime":1.427494363735E12,"finishTime":1.427494378564E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"55f4459a-92e0-49d8-87d3-2aba4a5ac043"},{"version":"CommandV1","origId":3532,"guid":"c459095e-5518-4f54-8b60-9ea4cabda863","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n\n### **Step 2:** Run the logs analysis notebook and time it.\nNote: Scala notebooks can be run from other Scala notebooks only.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 2:** Run the logs analysis notebook and time it.\nNote: Scala notebooks can be run from other Scala notebooks only.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494378569E12,"submitTime":1.427494363788E12,"finishTime":1.427494378569E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"0f6e2b31-1d98-4fcd-9e85-4d11542e4854"},{"version":"CommandV1","origId":3533,"guid":"3885df3c-145f-4796-926e-1ada1289832b","subtype":"command","commandType":"auto","position":5.0,"command":"val runStart = System.currentTimeMillis() / 1000","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">runStart: Long = 1427494380\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494378573E12,"submitTime":1.427494363825E12,"finishTime":1.427494380163E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"b94558f9-56d9-46b9-9701-1c5b4ae5e91f"},{"version":"CommandV1","origId":3534,"guid":"da21ad19-a4af-43c3-83c5-ce2fb4906572","subtype":"command","commandType":"auto","position":6.0,"command":"%run \"/databricks_guide/12 Sample Applications/2 Log Analysis/2 Log Analysis in Scala\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":"The execution of this command did not finish successfully","startTime":1.427494363867E12,"submitTime":1.427494363867E12,"finishTime":1.427494398074E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a129ca90-dec9-4817-812b-0f664c0f7edc"},{"version":"CommandV1","origId":3535,"guid":"ee69c5e2-4574-4546-9ee2-9eb61f281a9c","subtype":"script","commandType":"auto","position":6.027027027027027,"command":"%md\n\n# **Log Analysis in Scala**\nThis notebook analyzes Apache access logs with Scala.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"# **Log Analysis in Scala**\nThis notebook analyzes Apache access logs with Scala.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380167E12,"submitTime":1.427494131013E12,"finishTime":1.427494380168E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"13fbff60-1a56-40ab-b03f-4fee51f25f08"},{"version":"CommandV1","origId":3536,"guid":"f517883c-cf09-4fd2-8fa8-d408bb25ab67","subtype":"script","commandType":"auto","position":6.054054054054054,"command":"%md\n\n### **Step 1:** Change this parameter to your sample logs directory.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 1:** Change this parameter to your sample logs directory.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380171E12,"submitTime":1.42749413198E12,"finishTime":1.427494380172E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"dd45e8be-a08b-42dd-9e5a-9663e989103e"},{"version":"CommandV1","origId":3537,"guid":"8477640b-3c16-4493-b403-f1593b2fda4d","subtype":"script","commandType":"auto","position":6.081081081081081,"command":"val DBFSSampleLogsFolder = \"/dbguide/sample_logs\"  // If you modified this in step one, do the same thing.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DBFSSampleLogsFolder: String = /dbguide/sample_logs\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380175E12,"submitTime":1.427494132931E12,"finishTime":1.427494380266E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"4825f819-951a-4098-856f-ebce7f331652"},{"version":"CommandV1","origId":3538,"guid":"c7058248-5594-4148-b93e-dcd7976c13c4","subtype":"script","commandType":"auto","position":6.108108108108108,"command":"%md\n\n### **Step 2:** Create a parser for the Apache Access log lines to create case class objects.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 2:** Create a parser for the Apache Access log lines to create case class objects.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380271E12,"submitTime":1.427494135384E12,"finishTime":1.427494380272E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"011d740a-add0-40e8-b36a-e6b08f7e0330"},{"version":"CommandV1","origId":3539,"guid":"16176443-9578-4b18-9621-ebc332d5bda2","subtype":"script","commandType":"auto","position":6.135135135135135,"command":"// Create a case class for Apache access logs.\ncase class ApacheAccessLog(ipAddress: String, clientIdentd: String,\n                           userId: String, dateTime: String, method: String,\n                           endpoint: String, protocol: String,\n                           responseCode: Int, contentSize: Long) {\n\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class ApacheAccessLog\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380275E12,"submitTime":1.427494136202E12,"finishTime":1.427494380584E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"042004a1-b441-4c49-8ac1-ec4156a86a9b"},{"version":"CommandV1","origId":3540,"guid":"e95c2a28-60c2-4497-9125-d340b42db025","subtype":"script","commandType":"auto","position":6.162162162162162,"command":"// Define the parsing function.\nval Pattern = \"\"\"^(\\S+) (\\S+) (\\S+) \\[([\\w:/]+\\s[+\\-]\\d{4})\\] \"(\\S+) (\\S+) (\\S+)\" (\\d{3}) (\\d+)\"\"\".r\n\ndef parseLogLine(log: String): ApacheAccessLog = {\n  val res = Pattern.findFirstMatchIn(log)\n  if (res.isEmpty) {\n    throw new RuntimeException(\"Cannot parse log line: \" + log)\n  }\n  val m = res.get\n  ApacheAccessLog(m.group(1), m.group(2), m.group(3), m.group(4),\n    m.group(5), m.group(6), m.group(7), m.group(8).toInt, m.group(9).toLong)\n}\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Pattern: scala.util.matching.Regex = ^(\\S+) (\\S+) (\\S+) \\[([\\w:/]+\\s[+\\-]\\d{4})\\] &quot;(\\S+) (\\S+) (\\S+)&quot; (\\d{3}) (\\d+)\nparseLogLine: (log: String)ApacheAccessLog\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380588E12,"submitTime":1.427494137322E12,"finishTime":1.42749438087E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"29cd874f-f28b-48a5-a880-6bf274e23aca"},{"version":"CommandV1","origId":3541,"guid":"2fc35f66-5b6b-4fc2-9652-5293c2d06f91","subtype":"script","commandType":"auto","position":6.1891891891891895,"command":"%md\n\n### **Step 3:** Load the log lines into Spark.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 3:** Load the log lines into Spark.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380875E12,"submitTime":1.427494138212E12,"finishTime":1.427494380875E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"e432b500-6f39-47e4-8c6c-373838b1fa1c"},{"version":"CommandV1","origId":3542,"guid":"660481c8-795a-4ed6-b330-9681c5df769c","subtype":"script","commandType":"auto","position":6.216216216216216,"command":"val accessLogs = (sc.textFile(DBFSSampleLogsFolder)              \n                  // Call the parse_apace_log_line function on each line.\n                  .map(parseLogLine))\n// Caches the objects in memory since they will be queried multiple times.\naccessLogs.cache()\n// An action must be called on the RDD to actually populate the cache.\naccessLogs.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">accessLogs: org.apache.spark.rdd.RDD[ApacheAccessLog] = MapPartitionsRDD[434] at map at &lt;console&gt;:35\nres0: Long = 100000\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494380879E12,"submitTime":1.427494139437E12,"finishTime":1.427494382197E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"d5b8ecce-1f31-4278-af66-08a0d69bdcbb"},{"version":"CommandV1","origId":3543,"guid":"3f965009-1a56-4e17-8c61-bd9b10ffd225","subtype":"script","commandType":"auto","position":6.243243243243243,"command":"%md\n\n### **Step 4:** Calculate statistics on the Content Sizes returned.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 4:** Calculate statistics on the Content Sizes returned.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494382201E12,"submitTime":1.427494145023E12,"finishTime":1.427494382201E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"95284870-5755-44a4-b1af-79e3930716c8"},{"version":"CommandV1","origId":3544,"guid":"1ee42253-d65e-4305-896f-5aebb932a56a","subtype":"script","commandType":"auto","position":6.27027027027027,"command":"// Create the content sizes rdd.\nval contentSizes = (accessLogs\n                    .map(log => log.contentSize)\n                    .cache()) // Cache this as well since it will be queried many times.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">contentSizes: org.apache.spark.rdd.RDD[Long] = MapPartitionsRDD[435] at map at &lt;console&gt;:37\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494382205E12,"submitTime":1.427494146313E12,"finishTime":1.427494382325E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"0c732094-8de9-4e76-837b-e6da26a6c125"},{"version":"CommandV1","origId":3545,"guid":"37dbcb48-b25e-4d97-9987-86a0acc59bdf","subtype":"script","commandType":"auto","position":6.297297297297297,"command":"val averageContentSize = contentSizes.reduce(_ + _) / contentSizes.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">averageContentSize: Long = 251\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.42749438233E12,"submitTime":1.427494147737E12,"finishTime":1.427494382687E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"2b528cc4-ff58-41e1-a1b6-e0eead7ac298"},{"version":"CommandV1","origId":3546,"guid":"5cfb235a-a9b1-4eb4-9857-f93677859991","subtype":"script","commandType":"auto","position":6.324324324324325,"command":"val minContentSize = contentSizes.min()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">minContentSize: Long = 0\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494382692E12,"submitTime":1.427494148635E12,"finishTime":1.427494382851E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1b37777b-d010-459c-a5b0-0dea434d6ab4"},{"version":"CommandV1","origId":3547,"guid":"bf20d355-43dc-4dcc-8895-6103ad8c7799","subtype":"script","commandType":"auto","position":6.351351351351352,"command":"val maxContentSize = contentSizes.max()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">maxContentSize: Long = 500\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494382855E12,"submitTime":1.427494149359E12,"finishTime":1.427494382992E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"48946626-6e0d-4402-8874-3fa82d15cc3e"},{"version":"CommandV1","origId":3548,"guid":"61592042-6d25-42e0-b47a-c73b295a3ec2","subtype":"script","commandType":"auto","position":6.378378378378378,"command":"println(\"Content Size Statistics:\\n  Avg: %s\\n  Min: %s\\n  Max: %s\".format(averageContentSize, minContentSize, maxContentSize))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Content Size Statistics:\n  Avg: 251\n  Min: 0\n  Max: 500\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494382997E12,"submitTime":1.427494152102E12,"finishTime":1.427494383161E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f24a05ec-cad8-40ea-b28e-00c45a82afa6"},{"version":"CommandV1","origId":3549,"guid":"56e9d399-8e18-4dc2-9a97-bcb3f89be325","subtype":"script","commandType":"auto","position":6.405405405405405,"command":"%md ### **Step 5:** Display the response code to count statistics.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 5:** Display the response code to count statistics.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494383165E12,"submitTime":1.427494153876E12,"finishTime":1.427494383166E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"b982c0c3-823e-4cad-acbd-69d3ae9a21d9"},{"version":"CommandV1","origId":3550,"guid":"1db0bc6c-b225-4a89-b915-4b602d2a1051","subtype":"script","commandType":"auto","position":6.4324324324324325,"command":"// First, calculate the response code to count pairs.\nval responseCodeToCountPairRdd = (accessLogs\n                                  .map(log => (log.responseCode, 1))\n                                  .reduceByKey(_ + _))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">responseCodeToCountPairRdd: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[437] at reduceByKey at &lt;console&gt;:38\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494383169E12,"submitTime":1.427494156375E12,"finishTime":1.427494383435E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a73e7bea-8eb4-4c1b-8037-c6ad656a2639"},{"version":"CommandV1","origId":3551,"guid":"a902b11d-5d01-43ef-8106-0e8b1ed26966","subtype":"script","commandType":"auto","position":6.45945945945946,"command":"// View the responseCodeToCount by calling take on the RDD - which outputs an array of tuples.\n// Notice the use of take(100) - just in case bad data may have slipped in and there are too many response codes.\nval responseCodeToCountArray = responseCodeToCountPairRdd.take(100)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">responseCodeToCountArray: Array[(Int, Int)] = Array((200,70943), (500,14612), (401,14445))\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494383439E12,"submitTime":1.427494158761E12,"finishTime":1.427494383672E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"55766902-f1f0-43e2-a8cc-956d2fe98146"},{"version":"CommandV1","origId":3552,"guid":"69716b3a-a65d-4d7e-b922-f355c257fa29","subtype":"script","commandType":"auto","position":6.486486486486487,"command":"// To call display(), the RDD of tuples must be converted to an RDD case classes\ncase class ResponseCodeToCount(responseCode: Int, count: Int)\n// A simple map can convert the tuples to case classes to create a schemaRDD.\nval responseCodeToCountDataFrame = responseCodeToCountPairRdd.map(t => ResponseCodeToCount(t._1, t._2)).toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class ResponseCodeToCount\nresponseCodeToCountDataFrame: org.apache.spark.sql.DataFrame = [responseCode: int, count: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494383676E12,"submitTime":1.427494160069E12,"finishTime":1.427494384127E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a221f7f3-a7cb-40a3-ad9a-ffa281350ed0"},{"version":"CommandV1","origId":3553,"guid":"bc9d3bdd-8871-4b98-9b24-b6bb88e44a31","subtype":"script","commandType":"auto","position":6.513513513513513,"command":"// Now, display can be called on the resulting Schema RDD.\n//   For this display, a Pie Chart is chosen by selecting that icon.\n//   Then, \"Plot Options...\" was used to make the responseCode the key and count as the value.\ndisplay(responseCodeToCountDataFrame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[200.0,70943.0],[500.0,14612.0],[401.0,14445.0]],"arguments":{},"schema":[{"type":"int","name":"responseCode"},{"type":"int","name":"count"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494384132E12,"submitTime":1.427494161609E12,"finishTime":1.427494384312E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"650","height":"auto","xColumns":["responseCode"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"089a2848-798c-43e6-b9f3-08741b987749"},{"version":"CommandV1","origId":3554,"guid":"7da61772-ebdd-4e7d-9994-59ff4fbdccbb","subtype":"script","commandType":"auto","position":6.54054054054054,"command":"%md #### NOTE: Instead of converting to a schemaRDD for displaying, Spark SQL could also have been used.\n* At the end of this notebook, it's shown how to register this table for Spark SQL.\n* See the **Log Analysis in SQL** Notebook for more details on writing sql queries.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### NOTE: Instead of converting to a schemaRDD for displaying, Spark SQL could also have been used.\n* At the end of this notebook, it's shown how to register this table for Spark SQL.\n* See the **Log Analysis in SQL** Notebook for more details on writing sql queries.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384317E12,"submitTime":1.427494163986E12,"finishTime":1.427494384317E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"cc8b92a1-7eef-4d88-bdc9-30d0c6ef23a8"},{"version":"CommandV1","origId":3555,"guid":"830c8e7f-dfb9-4938-b2c2-c0b344052772","subtype":"script","commandType":"auto","position":6.5675675675675675,"command":"%md\n\n### **Step 6:** View a list of IPAddresses that has accessed the server more than N times.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 6:** View a list of IPAddresses that has accessed the server more than N times.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384321E12,"submitTime":1.427494164556E12,"finishTime":1.427494384321E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"d96d2484-3afb-4b07-9bb0-8a707f4e9f82"},{"version":"CommandV1","origId":3556,"guid":"a6e1cfd7-1f39-4408-abd1-13fafddfb6cf","subtype":"script","commandType":"auto","position":6.594594594594595,"command":"// Change this number as it makes sense for your data set.\nval N = 100","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">N: Int = 100\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384325E12,"submitTime":1.427494165195E12,"finishTime":1.427494384408E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1251a61a-e9f7-45f6-9be3-03c371d022b6"},{"version":"CommandV1","origId":3557,"guid":"ac9f424d-cb78-4193-b591-dbef273f7d6d","subtype":"script","commandType":"auto","position":6.621621621621622,"command":"case class IPAddressCaseClass(ipAddress: String)\n\nval ipAddressesDataFrame = (accessLogs\n                            .map(log => (log.ipAddress, 1))\n                            .reduceByKey(_ + _)\n                            .filter(_._2 > N)\n                            .map(t => IPAddressCaseClass(t._1))).toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class IPAddressCaseClass\nipAddressesDataFrame: org.apache.spark.sql.DataFrame = [ipAddress: string]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384413E12,"submitTime":1.427494165986E12,"finishTime":1.427494384718E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"01a90dc9-4255-4d06-903d-a1f6ffa7cf26"},{"version":"CommandV1","origId":3558,"guid":"d28c9b7f-97ce-49cd-a7f4-c75a18f011c3","subtype":"script","commandType":"auto","position":6.648648648648649,"command":"display(ipAddressesDataFrame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["127.0.0.1"],["1.1.1.1"],["4.4.4.4"],["3.3.3.3"],["2.2.2.2"]],"arguments":{},"schema":[{"type":"string","name":"ipAddress"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494384723E12,"submitTime":1.427494167579E12,"finishTime":1.427494384937E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"581ae26b-f58e-4a8b-972d-bd9213b901ac"},{"version":"CommandV1","origId":3559,"guid":"5acef4ad-525b-45e2-b279-3c639d435d82","subtype":"script","commandType":"auto","position":6.675675675675675,"command":"%md #### **Tip:** To see how an rdd is computed, use the **toDebugString()** function.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### **Tip:** To see how an rdd is computed, use the **toDebugString()** function.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384942E12,"submitTime":1.427494168836E12,"finishTime":1.427494384943E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"0dbde317-944c-481d-904d-4ceacf345d51"},{"version":"CommandV1","origId":3560,"guid":"899f5596-24a8-447d-998f-d7e0536e1e99","subtype":"script","commandType":"auto","position":6.702702702702703,"command":"println(ipAddressesDataFrame.rdd.toDebugString)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(4) MapPartitionsRDD[447] at map at DataFrame.scala:889 []\n |  MapPartitionsRDD[445] at mapPartitions at ExistingRDD.scala:37 []\n |  MapPartitionsRDD[444] at map at &lt;console&gt;:43 []\n |  MapPartitionsRDD[443] at filter at &lt;console&gt;:42 []\n |  ShuffledRDD[442] at reduceByKey at &lt;console&gt;:41 []\n +-(4) MapPartitionsRDD[441] at map at &lt;console&gt;:40 []\n    |  MapPartitionsRDD[434] at map at &lt;console&gt;:35 []\n    |      CachedPartitions: 4; MemorySize: 46.7 MB; TachyonSize: 0.0 B; DiskSize: 0.0 B\n    |  /dbguide/sample_logs MapPartitionsRDD[433] at textFile at &lt;console&gt;:33 []\n    |  /dbguide/sample_logs HadoopRDD[432] at textFile at &lt;console&gt;:33 []\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494384946E12,"submitTime":1.42749417097E12,"finishTime":1.42749438506E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"e69de16a-70e0-4d80-bb98-67ec18a785b9"},{"version":"CommandV1","origId":3561,"guid":"a7ca6978-b4ed-4571-9336-148ebee1df35","subtype":"script","commandType":"auto","position":6.72972972972973,"command":"%md\n\n### **Step 7:** Explore Statistics about the endpoints. ","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 7:** Explore Statistics about the endpoints.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494385064E12,"submitTime":1.427494173748E12,"finishTime":1.427494385065E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f9454e76-d200-435b-8945-59698b29b85b"},{"version":"CommandV1","origId":3562,"guid":"8ac86bf3-34b8-4e0c-aa5a-437eb83725c1","subtype":"script","commandType":"auto","position":6.756756756756757,"command":"// Calculate the number of hits for each endpoint.\ncase class EndpointCounts(endpoint: String, count: Int)\n\nval endpointCountsRdd = (accessLogs\n                         .map(log => (log.endpoint, 1))\n                         .reduceByKey(_ + _))\n\nval endpointCountsDataFrame = endpointCountsRdd.map(t => EndpointCounts(t._1, t._2)).toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class EndpointCounts\nendpointCountsRdd: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[449] at reduceByKey at &lt;console&gt;:40\nendpointCountsDataFrame: org.apache.spark.sql.DataFrame = [endpoint: string, count: int]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494385068E12,"submitTime":1.427494174751E12,"finishTime":1.427494385339E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1148028c-5d9d-478c-b56b-9bcd8b3842ec"},{"version":"CommandV1","origId":3563,"guid":"a6d8c1e5-bec1-4410-8b34-9aa8f9a49410","subtype":"script","commandType":"auto","position":6.783783783783784,"command":"// Display a plot of the distribution of the number of hits across the endpoints.\n//   Select the option to plot over all the results if you have more than 1000 data points.\ndisplay(endpointCountsDataFrame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["/endpoint_593",108.0],["/endpoint_296",116.0],["/endpoint_344",106.0],["/endpoint_744",89.0],["/endpoint_685",116.0],["/endpoint_164",88.0],["/endpoint_263",72.0],["/endpoint_414",108.0],["/endpoint_359",86.0],["/endpoint_942",121.0],["/endpoint_160",82.0],["/endpoint_843",84.0],["/endpoint_953",70.0],["/endpoint_542",103.0],["/endpoint_16",58.0],["/endpoint_751",104.0],["/endpoint_667",93.0],["/endpoint_847",70.0],["/endpoint_795",108.0],["/endpoint_975",92.0],["/endpoint_106",91.0],["/endpoint_780",82.0],["/endpoint_818",107.0],["/endpoint_230",85.0],["/endpoint_502",70.0],["/endpoint_142",90.0],["/endpoint_773",128.0],["/endpoint_692",100.0],["/endpoint_355",103.0],["/endpoint_407",106.0],["/endpoint_711",85.0],["/endpoint_964",110.0],["/endpoint_920",82.0],["/endpoint_432",106.0],["/endpoint_579",118.0],["/endpoint_96",116.0],["/endpoint_333",62.0],["/endpoint_520",106.0],["/endpoint_311",108.0],["/endpoint_586",92.0],["/endpoint_894",121.0],["/endpoint_09",116.0],["/endpoint_506",114.0],["/endpoint_227",93.0],["/endpoint_652",91.0],["/endpoint_704",116.0],["/endpoint_63",87.0],["/endpoint_854",90.0],["/endpoint_175",119.0],["/endpoint_931",110.0],["/endpoint_939",116.0],["/endpoint_913",86.0],["/endpoint_832",88.0],["/endpoint_241",108.0],["/endpoint_513",88.0],["/endpoint_124",94.0],["/endpoint_461",68.0],["/endpoint_630",82.0],["/endpoint_292",90.0],["/endpoint_373",107.0],["/endpoint_377",96.0],["/endpoint_979",92.0],["/endpoint_465",72.0],["/endpoint_814",114.0],["/endpoint_917",68.0],["/endpoint_935",104.0],["/endpoint_201",73.0],["/endpoint_865",124.0],["/endpoint_421",114.0],["/endpoint_102",116.0],["/endpoint_498",69.0],["/endpoint_153",117.0],["/endpoint_623",92.0],["/endpoint_436",84.0],["/endpoint_737",84.0],["/endpoint_722",122.0],["/endpoint_807",108.0],["/endpoint_425",89.0],["/endpoint_391",114.0],["/endpoint_12",139.0],["/endpoint_472",84.0],["/endpoint_719",124.0],["/endpoint_557",104.0],["/endpoint_52",120.0],["/endpoint_483",102.0],["/endpoint_876",97.0],["/endpoint_135",88.0],["/endpoint_56",82.0],["/endpoint_92",114.0],["/endpoint_362",72.0],["/endpoint_410",72.0],["/endpoint_234",64.0],["/endpoint_403",98.0],["/endpoint_564",126.0],["/endpoint_281",86.0],["/endpoint_494",104.0],["/endpoint_128",110.0],["/endpoint_906",70.0],["/endpoint_30",82.0],["/endpoint_858",96.0],["/endpoint_278",112.0],["/endpoint_450",96.0],["/endpoint_274",100.0],["/endpoint_454",90.0],["/endpoint_829",112.0],["/endpoint_986",76.0],["/endpoint_788",119.0],["/endpoint_186",82.0],["/endpoint_168",104.0],["/endpoint_319",118.0],["/endpoint_70",140.0],["/endpoint_223",92.0],["/endpoint_49",82.0],["/endpoint_971",88.0],["/endpoint_205",86.0],["/endpoint_399",118.0],["/endpoint_182",134.0],["/endpoint_193",76.0],["/endpoint_759",111.0],["/endpoint_821",122.0],["/endpoint_249",91.0],["/endpoint_803",116.0],["/endpoint_146",90.0],["/endpoint_179",97.0],["/endpoint_609",85.0],["/endpoint_27",100.0],["/endpoint_535",88.0],["/endpoint_755",152.0],["/endpoint_645",112.0],["/endpoint_45",140.0],["/endpoint_638",130.0],["/endpoint_245",79.0],["/endpoint_517",66.0],["/endpoint_41",106.0],["/endpoint_384",76.0],["/endpoint_531",126.0],["/endpoint_131",108.0],["/endpoint_902",102.0],["/endpoint_810",108.0],["/endpoint_957",134.0],["/endpoint_120",114.0],["/endpoint_997",146.0],["/endpoint_924",86.0],["/endpoint_238",90.0],["/endpoint_597",146.0],["/endpoint_649",101.0],["/endpoint_337",96.0],["/endpoint_993",80.0],["/endpoint_476",79.0],["/endpoint_487",96.0],["/endpoint_157",88.0],["/endpoint_825",106.0],["/endpoint_777",100.0],["/endpoint_627",107.0],["/endpoint_946",94.0],["/endpoint_209",114.0],["/endpoint_928",96.0],["/endpoint_304",108.0],["/endpoint_674",96.0],["/endpoint_616",125.0],["/endpoint_696",90.0],["/endpoint_315",158.0],["/endpoint_270",84.0],["/endpoint_23",74.0],["/endpoint_418",105.0],["/endpoint_670",120.0],["/endpoint_469",76.0],["/endpoint_139",82.0],["/endpoint_869",86.0],["/endpoint_982",128.0],["/endpoint_898",107.0],["/endpoint_388",95.0],["/endpoint_689",96.0],["/endpoint_395",84.0],["/endpoint_582",136.0],["/endpoint_81",92.0],["/endpoint_197",109.0],["/endpoint_850",70.0],["/endpoint_546",82.0],["/endpoint_524",73.0],["/endpoint_01",111.0],["/endpoint_553",113.0],["/endpoint_799",72.0],["/endpoint_605",132.0],["/endpoint_791",60.0],["/endpoint_05",122.0],["/endpoint_887",98.0],["/endpoint_256",60.0],["/endpoint_762",113.0],["/endpoint_289",128.0],["/endpoint_113",92.0],["/endpoint_656",92.0],["/endpoint_348",102.0],["/endpoint_784",104.0],["/endpoint_74",81.0],["/endpoint_366",86.0],["/endpoint_89",80.0],["/endpoint_429",77.0],["/endpoint_458",80.0],["/endpoint_861",113.0],["/endpoint_560",116.0],["/endpoint_351",115.0],["/endpoint_571",80.0],["/endpoint_216",125.0],["/endpoint_890",116.0],["/endpoint_67",116.0],["/endpoint_715",66.0],["/endpoint_539",124.0],["/endpoint_748",131.0],["/endpoint_960",137.0],["/endpoint_490",141.0],["/endpoint_212",116.0],["/endpoint_872",118.0],["/endpoint_641",108.0],["/endpoint_447",117.0],["/endpoint_308",115.0],["/endpoint_322",101.0],["/endpoint_700",81.0],["/endpoint_836",108.0],["/endpoint_252",101.0],["/endpoint_78",104.0],["/endpoint_267",136.0],["/endpoint_678",156.0],["/endpoint_612",90.0],["/endpoint_601",88.0],["/endpoint_883",86.0],["/endpoint_575",111.0],["/endpoint_326",91.0],["/endpoint_171",106.0],["/endpoint_117",89.0],["/endpoint_766",110.0],["/endpoint_85",134.0],["/endpoint_38",84.0],["/endpoint_968",68.0],["/endpoint_740",96.0],["/endpoint_681",118.0],["/endpoint_380",90.0],["/endpoint_568",116.0],["/endpoint_528",92.0],["/endpoint_285",88.0],["/endpoint_726",91.0],["/endpoint_634",101.0],["/endpoint_443",64.0],["/endpoint_34",123.0],["/endpoint_733",78.0],["/endpoint_663",68.0],["/endpoint_708",116.0],["/endpoint_340",121.0],["/endpoint_300",91.0],["/endpoint_183",104.0],["/endpoint_965",108.0],["/endpoint_705",77.0],["/endpoint_271",110.0],["/endpoint_198",69.0],["/endpoint_194",116.0],["/endpoint_239",124.0],["/endpoint_491",105.0],["/endpoint_02",60.0],["/endpoint_950",100.0],["/endpoint_352",118.0],["/endpoint_125",72.0],["/endpoint_57",104.0],["/endpoint_305",70.0],["/endpoint_679",136.0],["/endpoint_264",105.0],["/endpoint_693",124.0],["/endpoint_338",88.0],["/endpoint_749",72.0],["/endpoint_804",77.0],["/endpoint_462",80.0],["/endpoint_774",122.0],["/endpoint_79",82.0],["/endpoint_466",72.0],["/endpoint_495",82.0],["/endpoint_646",78.0],["/endpoint_293",109.0],["/endpoint_833",96.0],["/endpoint_477",76.0],["/endpoint_837",94.0],["/endpoint_202",62.0],["/endpoint_172",117.0],["/endpoint_158",148.0],["/endpoint_529",142.0],["/endpoint_451",91.0],["/endpoint_891",120.0],["/endpoint_110",108.0],["/endpoint_334",108.0],["/endpoint_147",136.0],["/endpoint_323",130.0],["/endpoint_06",76.0],["/endpoint_936",84.0],["/endpoint_330",100.0],["/endpoint_220",76.0],["/endpoint_576",82.0],["/endpoint_642",108.0],["/endpoint_86",90.0],["/endpoint_859",104.0],["/endpoint_796",108.0],["/endpoint_378",109.0],["/endpoint_587",90.0],["/endpoint_532",78.0],["/endpoint_473",91.0],["/endpoint_411",80.0],["/endpoint_660",102.0],["/endpoint_24",105.0],["/endpoint_594",97.0],["/endpoint_583",82.0],["/endpoint_770",106.0],["/endpoint_327",165.0],["/endpoint_286",125.0],["/endpoint_741",66.0],["/endpoint_503",64.0],["/endpoint_363",100.0],["/endpoint_176",96.0],["/endpoint_415",72.0],["/endpoint_745",76.0],["/endpoint_675",116.0],["/endpoint_165",118.0],["/endpoint_507",112.0],["/endpoint_664",130.0],["/endpoint_547",98.0],["/endpoint_268",112.0],["/endpoint_756",144.0],["/endpoint_459",74.0],["/endpoint_918",86.0],["/endpoint_880",78.0],["/endpoint_309",116.0],["/endpoint_279",72.0],["/endpoint_316",116.0],["/endpoint_260",93.0],["/endpoint_631",118.0],["/endpoint_808",104.0],["/endpoint_789",96.0],["/endpoint_75",87.0],["/endpoint_440",107.0],["/endpoint_132",123.0],["/endpoint_914",137.0],["/endpoint_228",93.0],["/endpoint_899",112.0],["/endpoint_521",103.0],["/endpoint_925",142.0],["/endpoint_550",130.0],["/endpoint_929",100.0],["/endpoint_668",110.0],["/endpoint_572",90.0],["/endpoint_536",64.0],["/endpoint_499",83.0],["/endpoint_613",119.0],["/endpoint_20",82.0],["/endpoint_154",92.0],["/endpoint_697",105.0],["/endpoint_341",127.0],["/endpoint_851",100.0],["/endpoint_349",105.0],["/endpoint_943",108.0],["/endpoint_488",100.0],["/endpoint_385",114.0],["/endpoint_404",123.0],["/endpoint_866",96.0],["/endpoint_815",92.0],["/endpoint_983",102.0],["/endpoint_480",92.0],["/endpoint_543",112.0],["/endpoint_628",116.0],["/endpoint_35",117.0],["/endpoint_848",138.0],["/endpoint_484",68.0],["/endpoint_998",100.0],["/endpoint_598",77.0],["/endpoint_819",146.0],["/endpoint_97",124.0],["/endpoint_345",112.0],["/endpoint_961",105.0],["/endpoint_42",85.0],["/endpoint_150",94.0],["/endpoint_103",108.0],["/endpoint_93",93.0],["/endpoint_921",126.0],["/endpoint_606",98.0],["/endpoint_518",97.0],["/endpoint_884",130.0],["/endpoint_71",86.0],["/endpoint_422",122.0],["/endpoint_840",94.0],["/endpoint_701",106.0],["/endpoint_671",92.0],["/endpoint_107",106.0],["/endpoint_752",70.0],["/endpoint_994",98.0],["/endpoint_68",100.0],["/endpoint_862",114.0],["/endpoint_800",90.0],["/endpoint_639",139.0],["/endpoint_246",76.0],["/endpoint_64",148.0],["/endpoint_433",116.0],["/endpoint_811",80.0],["/endpoint_190",60.0],["/endpoint_31",96.0],["/endpoint_60",100.0],["/endpoint_426",92.0],["/endpoint_877",104.0],["/endpoint_367",151.0],["/endpoint_730",98.0],["/endpoint_554",84.0],["/endpoint_235",88.0],["/endpoint_910",133.0],["/endpoint_381",69.0],["/endpoint_408",110.0],["/endpoint_738",94.0],["/endpoint_282",90.0],["/endpoint_657",88.0],["/endpoint_257",81.0],["/endpoint_224",122.0],["/endpoint_778",89.0],["/endpoint_712",70.0],["/endpoint_727",86.0],["/endpoint_396",128.0],["/endpoint_312",67.0],["/endpoint_129",94.0],["/endpoint_792",104.0],["/endpoint_972",132.0],["/endpoint_419",90.0],["/endpoint_873",100.0],["/endpoint_448",63.0],["/endpoint_620",76.0],["/endpoint_231",112.0],["/endpoint_136",114.0],["/endpoint_976",108.0],["/endpoint_444",123.0],["/endpoint_400",113.0],["/endpoint_569",144.0],["/endpoint_723",79.0],["/endpoint_686",84.0],["/endpoint_969",90.0],["/endpoint_39",80.0],["/endpoint_389",102.0],["/endpoint_781",111.0],["/endpoint_785",120.0],["/endpoint_947",116.0],["/endpoint_82",106.0],["/endpoint_46",83.0],["/endpoint_565",100.0],["/endpoint_28",137.0],["/endpoint_13",71.0],["/endpoint_954",101.0],["/endpoint_525",96.0],["/endpoint_624",96.0],["/endpoint_297",130.0],["/endpoint_958",95.0],["/endpoint_301",78.0],["/endpoint_987",82.0],["/endpoint_561",100.0],["/endpoint_455",122.0],["/endpoint_855",111.0],["/endpoint_213",101.0],["/endpoint_514",96.0],["/endpoint_895",122.0],["/endpoint_590",114.0],["/endpoint_932",88.0],["/endpoint_169",88.0],["/endpoint_682",102.0],["/endpoint_242",112.0],["/endpoint_143",72.0],["/endpoint_53",118.0],["/endpoint_635",125.0],["/endpoint_121",114.0],["/endpoint_888",98.0],["/endpoint_275",131.0],["/endpoint_602",52.0],["/endpoint_822",108.0],["/endpoint_206",74.0],["/endpoint_990",56.0],["/endpoint_767",112.0],["/endpoint_763",84.0],["/endpoint_370",82.0],["/endpoint_510",89.0],["/endpoint_844",77.0],["/endpoint_217",100.0],["/endpoint_734",134.0],["/endpoint_392",128.0],["/endpoint_374",90.0],["/endpoint_118",105.0],["/endpoint_558",105.0],["/endpoint_17",60.0],["/endpoint_907",122.0],["/endpoint_716",79.0],["/endpoint_437",73.0],["/endpoint_187",84.0],["/endpoint_617",88.0],["/endpoint_161",92.0],["/endpoint_253",89.0],["/endpoint_903",76.0],["/endpoint_114",116.0],["/endpoint_709",96.0],["/endpoint_356",74.0],["/endpoint_826",96.0],["/endpoint_653",57.0],["/endpoint_830",89.0],["/endpoint_133",137.0],["/endpoint_937",96.0],["/endpoint_562",78.0],["/endpoint_115",75.0],["/endpoint_717",76.0],["/endpoint_544",109.0],["/endpoint_603",146.0],["/endpoint_144",112.0],["/endpoint_382",114.0],["/endpoint_526",120.0],["/endpoint_984",116.0],["/endpoint_940",122.0],["/endpoint_672",74.0],["/endpoint_683",64.0],["/endpoint_577",82.0],["/endpoint_973",126.0],["/endpoint_412",77.0],["/endpoint_29",98.0],["/endpoint_221",82.0],["/endpoint_467",108.0],["/endpoint_533",103.0],["/endpoint_980",90.0],["/endpoint_207",136.0],["/endpoint_250",80.0],["/endpoint_151",87.0],["/endpoint_287",103.0],["/endpoint_379",90.0],["/endpoint_427",96.0],["/endpoint_661",120.0],["/endpoint_647",105.0],["/endpoint_43",97.0],["/endpoint_393",100.0],["/endpoint_166",100.0],["/endpoint_764",88.0],["/endpoint_195",126.0],["/endpoint_658",118.0],["/endpoint_944",97.0],["/endpoint_522",72.0],["/endpoint_838",107.0],["/endpoint_999",72.0],["/endpoint_302",92.0],["/endpoint_966",64.0],["/endpoint_698",92.0],["/endpoint_397",80.0],["/endpoint_926",96.0],["/endpoint_809",124.0],["/endpoint_111",102.0],["/endpoint_771",82.0],["/endpoint_47",80.0],["/endpoint_786",128.0],["/endpoint_368",80.0],["/endpoint_889",85.0],["/endpoint_122",92.0],["/endpoint_449",100.0],["/endpoint_243",108.0],["/endpoint_793",68.0],["/endpoint_481",131.0],["/endpoint_210",102.0],["/endpoint_607",108.0],["/endpoint_610",82.0],["/endpoint_797",104.0],["/endpoint_551",95.0],["/endpoint_100",145.0],["/endpoint_948",102.0],["/endpoint_599",97.0],["/endpoint_643",86.0],["/endpoint_485",96.0],["/endpoint_416",78.0],["/endpoint_690",102.0],["/endpoint_863",134.0],["/endpoint_353",126.0],["/endpoint_728",108.0],["/endpoint_72",100.0],["/endpoint_180",120.0],["/endpoint_83",109.0],["/endpoint_870",84.0],["/endpoint_915",126.0],["/endpoint_951",112.0],["/endpoint_148",115.0],["/endpoint_1000",100.0],["/endpoint_904",99.0],["/endpoint_856",83.0],["/endpoint_760",106.0],["/endpoint_768",142.0],["/endpoint_478",99.0],["/endpoint_595",76.0],["/endpoint_159",90.0],["/endpoint_823",100.0],["/endpoint_452",92.0],["/endpoint_676",116.0],["/endpoint_540",83.0],["/endpoint_229",87.0],["/endpoint_10",136.0],["/endpoint_90",128.0],["/endpoint_489",102.0],["/endpoint_867",118.0],["/endpoint_742",123.0],["/endpoint_687",92.0],["/endpoint_555",93.0],["/endpoint_779",86.0],["/endpoint_328",98.0],["/endpoint_155",124.0],["/endpoint_702",88.0],["/endpoint_834",104.0],["/endpoint_852",109.0],["/endpoint_21",112.0],["/endpoint_731",100.0],["/endpoint_911",100.0],["/endpoint_140",78.0],["/endpoint_269",97.0],["/endpoint_290",97.0],["/endpoint_724",102.0],["/endpoint_272",92.0],["/endpoint_746",112.0],["/endpoint_874",102.0],["/endpoint_559",124.0],["/endpoint_988",100.0],["/endpoint_900",110.0],["/endpoint_881",82.0],["/endpoint_757",102.0],["/endpoint_342",92.0],["/endpoint_18",94.0],["/endpoint_32",144.0],["/endpoint_317",122.0],["/endpoint_977",102.0],["/endpoint_922",112.0],["/endpoint_65",99.0],["/endpoint_463",121.0],["/endpoint_126",75.0],["/endpoint_654",93.0],["/endpoint_98",76.0],["/endpoint_625",107.0],["/endpoint_706",62.0],["/endpoint_515",80.0],["/endpoint_430",112.0],["/endpoint_573",120.0],["/endpoint_474",118.0],["/endpoint_548",82.0],["/endpoint_445",74.0],["/endpoint_629",112.0],["/endpoint_456",80.0],["/endpoint_409",81.0],["/endpoint_845",81.0],["/endpoint_665",110.0],["/endpoint_919",120.0],["/endpoint_933",82.0],["/endpoint_441",101.0],["/endpoint_735",116.0],["/endpoint_434",96.0],["/endpoint_360",118.0],["/endpoint_173",105.0],["/endpoint_614",94.0],["/endpoint_25",86.0],["/endpoint_184",92.0],["/endpoint_492",72.0],["/endpoint_878",58.0],["/endpoint_566",114.0],["/endpoint_320",76.0],["/endpoint_782",130.0],["/endpoint_335",110.0],["/endpoint_908",96.0],["/endpoint_313",100.0],["/endpoint_694",116.0],["/endpoint_276",122.0],["/endpoint_511",98.0],["/endpoint_812",114.0],["/endpoint_54",99.0],["/endpoint_324",104.0],["/endpoint_225",102.0],["/endpoint_214",97.0],["/endpoint_991",102.0],["/endpoint_669",124.0],["/endpoint_346",96.0],["/endpoint_108",94.0],["/endpoint_588",120.0],["/endpoint_962",96.0],["/endpoint_775",110.0],["/endpoint_892",93.0],["/endpoint_294",89.0],["/endpoint_438",48.0],["/endpoint_618",110.0],["/endpoint_537",82.0],["/endpoint_827",104.0],["/endpoint_36",85.0],["/endpoint_191",104.0],["/endpoint_283",75.0],["/endpoint_621",101.0],["/endpoint_650",88.0],["/endpoint_87",132.0],["/endpoint_298",140.0],["/endpoint_247",100.0],["/endpoint_739",98.0],["/endpoint_375",118.0],["/endpoint_339",66.0],["/endpoint_713",118.0],["/endpoint_504",98.0],["/endpoint_265",92.0],["/endpoint_753",90.0],["/endpoint_203",81.0],["/endpoint_995",116.0],["/endpoint_720",82.0],["/endpoint_61",86.0],["/endpoint_816",98.0],["/endpoint_218",102.0],["/endpoint_632",117.0],["/endpoint_331",80.0],["/endpoint_849",56.0],["/endpoint_199",98.0],["/endpoint_261",77.0],["/endpoint_58",83.0],["/endpoint_254",102.0],["/endpoint_580",106.0],["/endpoint_805",120.0],["/endpoint_955",92.0],["/endpoint_841",75.0],["/endpoint_885",134.0],["/endpoint_137",92.0],["/endpoint_357",88.0],["/endpoint_371",112.0],["/endpoint_508",89.0],["/endpoint_50",106.0],["/endpoint_801",92.0],["/endpoint_470",112.0],["/endpoint_405",72.0],["/endpoint_584",97.0],["/endpoint_177",124.0],["/endpoint_76",90.0],["/endpoint_896",106.0],["/endpoint_959",90.0],["/endpoint_496",96.0],["/endpoint_423",132.0],["/endpoint_519",108.0],["/endpoint_104",94.0],["/endpoint_306",88.0],["/endpoint_500",78.0],["/endpoint_69",97.0],["/endpoint_03",112.0],["/endpoint_119",122.0],["/endpoint_236",92.0],["/endpoint_162",73.0],["/endpoint_258",81.0],["/endpoint_14",104.0],["/endpoint_07",80.0],["/endpoint_401",130.0],["/endpoint_364",68.0],["/endpoint_232",72.0],["/endpoint_636",88.0],["/endpoint_591",108.0],["/endpoint_188",97.0],["/endpoint_94",76.0],["/endpoint_386",101.0],["/endpoint_123",100.0],["/endpoint_619",116.0],["/endpoint_673",102.0],["/endpoint_196",90.0],["/endpoint_116",97.0],["/endpoint_329",80.0],["/endpoint_406",84.0],["/endpoint_00",100.0],["/endpoint_952",76.0],["/endpoint_853",100.0],["/endpoint_783",128.0],["/endpoint_765",101.0],["/endpoint_22",100.0],["/endpoint_790",106.0],["/endpoint_864",132.0],["/endpoint_66",72.0],["/endpoint_651",113.0],["/endpoint_428",104.0],["/endpoint_288",91.0],["/endpoint_226",95.0],["/endpoint_295",127.0],["/endpoint_714",112.0],["/endpoint_901",100.0],["/endpoint_431",72.0],["/endpoint_192",96.0],["/endpoint_776",69.0],["/endpoint_277",132.0],["/endpoint_992",108.0],["/endpoint_909",92.0],["/endpoint_585",84.0],["/endpoint_167",82.0],["/endpoint_402",102.0],["/endpoint_178",100.0],["/endpoint_130",82.0],["/endpoint_88",104.0],["/endpoint_541",90.0],["/endpoint_325",92.0],["/endpoint_677",69.0],["/endpoint_570",114.0],["/endpoint_581",149.0],["/endpoint_750",70.0],["/endpoint_732",122.0],["/endpoint_73",78.0],["/endpoint_40",109.0],["/endpoint_930",54.0],["/endpoint_967",89.0],["/endpoint_240",109.0],["/endpoint_509",110.0],["/endpoint_482",117.0],["/endpoint_219",140.0],["/endpoint_578",112.0],["/endpoint_824",144.0],["/endpoint_684",122.0],["/endpoint_600",148.0],["/endpoint_813",88.0],["/endpoint_255",100.0],["/endpoint_552",104.0],["/endpoint_262",118.0],["/endpoint_563",60.0],["/endpoint_545",87.0],["/endpoint_923",94.0],["/endpoint_442",104.0],["/endpoint_828",88.0],["/endpoint_817",127.0],["/endpoint_398",104.0],["/endpoint_934",101.0],["/endpoint_512",96.0],["/endpoint_648",78.0],["/endpoint_956",118.0],["/endpoint_523",92.0],["/endpoint_857",108.0],["/endpoint_244",101.0],["/endpoint_91",80.0],["/endpoint_989",105.0],["/endpoint_604",121.0],["/endpoint_835",92.0],["/endpoint_141",102.0],["/endpoint_680",61.0],["/endpoint_949",101.0],["/endpoint_189",96.0],["/endpoint_310",96.0],["/endpoint_644",100.0],["/endpoint_758",100.0],["/endpoint_259",72.0],["/endpoint_695",74.0],["/endpoint_204",68.0],["/endpoint_170",104.0],["/endpoint_149",100.0],["/endpoint_48",92.0],["/endpoint_589",84.0],["/endpoint_358",98.0],["/endpoint_592",52.0],["/endpoint_109",99.0],["/endpoint_882",94.0],["/endpoint_486",144.0],["/endpoint_978",91.0],["/endpoint_806",111.0],["/endpoint_725",122.0],["/endpoint_336",89.0],["/endpoint_417",95.0],["/endpoint_875",98.0],["/endpoint_640",96.0],["/endpoint_710",127.0],["/endpoint_457",96.0],["/endpoint_699",72.0],["/endpoint_839",90.0],["/endpoint_761",89.0],["/endpoint_530",100.0],["/endpoint_662",96.0],["/endpoint_534",68.0],["/endpoint_222",90.0],["/endpoint_354",89.0],["/endpoint_471",155.0],["/endpoint_174",84.0],["/endpoint_871",94.0],["/endpoint_26",90.0],["/endpoint_729",92.0],["/endpoint_84",121.0],["/endpoint_152",77.0],["/endpoint_332",100.0],["/endpoint_718",90.0],["/endpoint_19",94.0],["/endpoint_516",100.0],["/endpoint_273",98.0],["/endpoint_798",102.0],["/endpoint_365",100.0],["/endpoint_963",108.0],["/endpoint_266",99.0],["/endpoint_307",141.0],["/endpoint_383",158.0],["/endpoint_703",82.0],["/endpoint_912",68.0],["/endpoint_138",93.0],["/endpoint_44",97.0],["/endpoint_112",113.0],["/endpoint_145",72.0],["/endpoint_688",78.0],["/endpoint_527",124.0],["/endpoint_655",92.0],["/endpoint_897",89.0],["/endpoint_464",114.0],["/endpoint_538",86.0],["/endpoint_303",111.0],["/endpoint_772",132.0],["/endpoint_134",85.0],["/endpoint_938",108.0],["/endpoint_453",84.0],["/endpoint_501",135.0],["/endpoint_321",89.0],["/endpoint_691",74.0],["/endpoint_350",81.0],["/endpoint_314",92.0],["/endpoint_251",92.0],["/endpoint_468",80.0],["/endpoint_446",112.0],["/endpoint_879",96.0],["/endpoint_62",105.0],["/endpoint_596",133.0],["/endpoint_105",108.0],["/endpoint_55",150.0],["/endpoint_233",80.0],["/endpoint_37",83.0],["/endpoint_981",102.0],["/endpoint_369",121.0],["/endpoint_556",72.0],["/endpoint_387",108.0],["/endpoint_211",105.0],["/endpoint_916",74.0],["/endpoint_846",89.0],["/endpoint_574",146.0],["/endpoint_608",104.0],["/endpoint_493",96.0],["/endpoint_390",82.0],["/endpoint_802",113.0],["/endpoint_769",120.0],["/endpoint_77",88.0],["/endpoint_736",113.0],["/endpoint_985",80.0],["/endpoint_33",125.0],["/endpoint_439",118.0],["/endpoint_185",132.0],["/endpoint_95",136.0],["/endpoint_347",121.0],["/endpoint_794",122.0],["/endpoint_318",120.0],["/endpoint_666",114.0],["/endpoint_945",100.0],["/endpoint_343",86.0],["/endpoint_376",86.0],["/endpoint_99",106.0],["/endpoint_893",70.0],["/endpoint_163",112.0],["/endpoint_299",109.0],["/endpoint_842",112.0],["/endpoint_905",100.0],["/endpoint_413",84.0],["/endpoint_420",96.0],["/endpoint_497",106.0],["/endpoint_51",79.0],["/endpoint_08",124.0],["/endpoint_248",96.0],["/endpoint_215",116.0],["/endpoint_280",116.0],["/endpoint_435",84.0],["/endpoint_633",84.0],["/endpoint_622",126.0],["/endpoint_549",82.0],["/endpoint_59",126.0],["/endpoint_156",78.0],["/endpoint_860",88.0],["/endpoint_394",108.0],["/endpoint_208",120.0],["/endpoint_15",89.0],["/endpoint_291",76.0],["/endpoint_505",122.0],["/endpoint_831",61.0],["/endpoint_567",122.0],["/endpoint_743",106.0],["/endpoint_237",134.0],["/endpoint_361",108.0],["/endpoint_637",156.0],["/endpoint_996",124.0],["/endpoint_475",81.0],["/endpoint_707",116.0],["/endpoint_659",96.0],["/endpoint_611",104.0],["/endpoint_941",72.0],["/endpoint_101",109.0],["/endpoint_747",96.0],["/endpoint_886",72.0],["/endpoint_04",95.0],["/endpoint_721",100.0],["/endpoint_615",100.0],["/endpoint_868",112.0],["/endpoint_181",112.0],["/endpoint_974",115.0],["/endpoint_927",103.0],["/endpoint_820",92.0],["/endpoint_479",120.0],["/endpoint_372",76.0],["/endpoint_11",68.0],["/endpoint_80",113.0],["/endpoint_754",85.0],["/endpoint_127",111.0],["/endpoint_200",98.0],["/endpoint_460",89.0],["/endpoint_626",92.0],["/endpoint_787",116.0],["/endpoint_284",97.0],["/endpoint_970",108.0]],"arguments":{},"schema":[{"type":"string","name":"endpoint"},{"type":"int","name":"count"}],"overflow":true,"aggData":[["/endpoint_00",100.0],["/endpoint_01",111.0],["/endpoint_02",60.0],["/endpoint_03",112.0],["/endpoint_04",95.0],["/endpoint_05",122.0],["/endpoint_06",76.0],["/endpoint_07",80.0],["/endpoint_08",124.0],["/endpoint_09",116.0],["/endpoint_10",136.0],["/endpoint_100",145.0],["/endpoint_1000",100.0],["/endpoint_101",109.0],["/endpoint_102",116.0],["/endpoint_103",108.0],["/endpoint_104",94.0],["/endpoint_105",108.0],["/endpoint_106",91.0],["/endpoint_107",106.0],["/endpoint_108",94.0],["/endpoint_109",99.0],["/endpoint_11",68.0],["/endpoint_110",108.0],["/endpoint_111",102.0],["/endpoint_112",113.0],["/endpoint_113",92.0],["/endpoint_114",116.0],["/endpoint_115",75.0],["/endpoint_116",97.0],["/endpoint_117",89.0],["/endpoint_118",105.0],["/endpoint_119",122.0],["/endpoint_12",139.0],["/endpoint_120",114.0],["/endpoint_121",114.0],["/endpoint_122",92.0],["/endpoint_123",100.0],["/endpoint_124",94.0],["/endpoint_125",72.0],["/endpoint_126",75.0],["/endpoint_127",111.0],["/endpoint_128",110.0],["/endpoint_129",94.0],["/endpoint_13",71.0],["/endpoint_130",82.0],["/endpoint_131",108.0],["/endpoint_132",123.0],["/endpoint_133",137.0],["/endpoint_134",85.0],["/endpoint_135",88.0],["/endpoint_136",114.0],["/endpoint_137",92.0],["/endpoint_138",93.0],["/endpoint_139",82.0],["/endpoint_14",104.0],["/endpoint_140",78.0],["/endpoint_141",102.0],["/endpoint_142",90.0],["/endpoint_143",72.0],["/endpoint_144",112.0],["/endpoint_145",72.0],["/endpoint_146",90.0],["/endpoint_147",136.0],["/endpoint_148",115.0],["/endpoint_149",100.0],["/endpoint_15",89.0],["/endpoint_150",94.0],["/endpoint_151",87.0],["/endpoint_152",77.0],["/endpoint_153",117.0],["/endpoint_154",92.0],["/endpoint_155",124.0],["/endpoint_156",78.0],["/endpoint_157",88.0],["/endpoint_158",148.0],["/endpoint_159",90.0],["/endpoint_16",58.0],["/endpoint_160",82.0],["/endpoint_161",92.0],["/endpoint_162",73.0],["/endpoint_163",112.0],["/endpoint_164",88.0],["/endpoint_165",118.0],["/endpoint_166",100.0],["/endpoint_167",82.0],["/endpoint_168",104.0],["/endpoint_169",88.0],["/endpoint_17",60.0],["/endpoint_170",104.0],["/endpoint_171",106.0],["/endpoint_172",117.0],["/endpoint_173",105.0],["/endpoint_174",84.0],["/endpoint_175",119.0],["/endpoint_176",96.0],["/endpoint_177",124.0],["/endpoint_178",100.0],["/endpoint_179",97.0],["/endpoint_18",94.0],["/endpoint_180",120.0],["/endpoint_181",112.0],["/endpoint_182",134.0],["/endpoint_183",104.0],["/endpoint_184",92.0],["/endpoint_185",132.0],["/endpoint_186",82.0],["/endpoint_187",84.0],["/endpoint_188",97.0],["/endpoint_189",96.0],["/endpoint_19",94.0],["/endpoint_190",60.0],["/endpoint_191",104.0],["/endpoint_192",96.0],["/endpoint_193",76.0],["/endpoint_194",116.0],["/endpoint_195",126.0],["/endpoint_196",90.0],["/endpoint_197",109.0],["/endpoint_198",69.0],["/endpoint_199",98.0],["/endpoint_20",82.0],["/endpoint_200",98.0],["/endpoint_201",73.0],["/endpoint_202",62.0],["/endpoint_203",81.0],["/endpoint_204",68.0],["/endpoint_205",86.0],["/endpoint_206",74.0],["/endpoint_207",136.0],["/endpoint_208",120.0],["/endpoint_209",114.0],["/endpoint_21",112.0],["/endpoint_210",102.0],["/endpoint_211",105.0],["/endpoint_212",116.0],["/endpoint_213",101.0],["/endpoint_214",97.0],["/endpoint_215",116.0],["/endpoint_216",125.0],["/endpoint_217",100.0],["/endpoint_218",102.0],["/endpoint_219",140.0],["/endpoint_22",100.0],["/endpoint_220",76.0],["/endpoint_221",82.0],["/endpoint_222",90.0],["/endpoint_223",92.0],["/endpoint_224",122.0],["/endpoint_225",102.0],["/endpoint_226",95.0],["/endpoint_227",93.0],["/endpoint_228",93.0],["/endpoint_229",87.0],["/endpoint_23",74.0],["/endpoint_230",85.0],["/endpoint_231",112.0],["/endpoint_232",72.0],["/endpoint_233",80.0],["/endpoint_234",64.0],["/endpoint_235",88.0],["/endpoint_236",92.0],["/endpoint_237",134.0],["/endpoint_238",90.0],["/endpoint_239",124.0],["/endpoint_24",105.0],["/endpoint_240",109.0],["/endpoint_241",108.0],["/endpoint_242",112.0],["/endpoint_243",108.0],["/endpoint_244",101.0],["/endpoint_245",79.0],["/endpoint_246",76.0],["/endpoint_247",100.0],["/endpoint_248",96.0],["/endpoint_249",91.0],["/endpoint_25",86.0],["/endpoint_250",80.0],["/endpoint_251",92.0],["/endpoint_252",101.0],["/endpoint_253",89.0],["/endpoint_254",102.0],["/endpoint_255",100.0],["/endpoint_256",60.0],["/endpoint_257",81.0],["/endpoint_258",81.0],["/endpoint_259",72.0],["/endpoint_26",90.0],["/endpoint_260",93.0],["/endpoint_261",77.0],["/endpoint_262",118.0],["/endpoint_263",72.0],["/endpoint_264",105.0],["/endpoint_265",92.0],["/endpoint_266",99.0],["/endpoint_267",136.0],["/endpoint_268",112.0],["/endpoint_269",97.0],["/endpoint_27",100.0],["/endpoint_270",84.0],["/endpoint_271",110.0],["/endpoint_272",92.0],["/endpoint_273",98.0],["/endpoint_274",100.0],["/endpoint_275",131.0],["/endpoint_276",122.0],["/endpoint_277",132.0],["/endpoint_278",112.0],["/endpoint_279",72.0],["/endpoint_28",137.0],["/endpoint_280",116.0],["/endpoint_281",86.0],["/endpoint_282",90.0],["/endpoint_283",75.0],["/endpoint_284",97.0],["/endpoint_285",88.0],["/endpoint_286",125.0],["/endpoint_287",103.0],["/endpoint_288",91.0],["/endpoint_289",128.0],["/endpoint_29",98.0],["/endpoint_290",97.0],["/endpoint_291",76.0],["/endpoint_292",90.0],["/endpoint_293",109.0],["/endpoint_294",89.0],["/endpoint_295",127.0],["/endpoint_296",116.0],["/endpoint_297",130.0],["/endpoint_298",140.0],["/endpoint_299",109.0],["/endpoint_30",82.0],["/endpoint_300",91.0],["/endpoint_301",78.0],["/endpoint_302",92.0],["/endpoint_303",111.0],["/endpoint_304",108.0],["/endpoint_305",70.0],["/endpoint_306",88.0],["/endpoint_307",141.0],["/endpoint_308",115.0],["/endpoint_309",116.0],["/endpoint_31",96.0],["/endpoint_310",96.0],["/endpoint_311",108.0],["/endpoint_312",67.0],["/endpoint_313",100.0],["/endpoint_314",92.0],["/endpoint_315",158.0],["/endpoint_316",116.0],["/endpoint_317",122.0],["/endpoint_318",120.0],["/endpoint_319",118.0],["/endpoint_32",144.0],["/endpoint_320",76.0],["/endpoint_321",89.0],["/endpoint_322",101.0],["/endpoint_323",130.0],["/endpoint_324",104.0],["/endpoint_325",92.0],["/endpoint_326",91.0],["/endpoint_327",165.0],["/endpoint_328",98.0],["/endpoint_329",80.0],["/endpoint_33",125.0],["/endpoint_330",100.0],["/endpoint_331",80.0],["/endpoint_332",100.0],["/endpoint_333",62.0],["/endpoint_334",108.0],["/endpoint_335",110.0],["/endpoint_336",89.0],["/endpoint_337",96.0],["/endpoint_338",88.0],["/endpoint_339",66.0],["/endpoint_34",123.0],["/endpoint_340",121.0],["/endpoint_341",127.0],["/endpoint_342",92.0],["/endpoint_343",86.0],["/endpoint_344",106.0],["/endpoint_345",112.0],["/endpoint_346",96.0],["/endpoint_347",121.0],["/endpoint_348",102.0],["/endpoint_349",105.0],["/endpoint_35",117.0],["/endpoint_350",81.0],["/endpoint_351",115.0],["/endpoint_352",118.0],["/endpoint_353",126.0],["/endpoint_354",89.0],["/endpoint_355",103.0],["/endpoint_356",74.0],["/endpoint_357",88.0],["/endpoint_358",98.0],["/endpoint_359",86.0],["/endpoint_36",85.0],["/endpoint_360",118.0],["/endpoint_361",108.0],["/endpoint_362",72.0],["/endpoint_363",100.0],["/endpoint_364",68.0],["/endpoint_365",100.0],["/endpoint_366",86.0],["/endpoint_367",151.0],["/endpoint_368",80.0],["/endpoint_369",121.0],["/endpoint_37",83.0],["/endpoint_370",82.0],["/endpoint_371",112.0],["/endpoint_372",76.0],["/endpoint_373",107.0],["/endpoint_374",90.0],["/endpoint_375",118.0],["/endpoint_376",86.0],["/endpoint_377",96.0],["/endpoint_378",109.0],["/endpoint_379",90.0],["/endpoint_38",84.0],["/endpoint_380",90.0],["/endpoint_381",69.0],["/endpoint_382",114.0],["/endpoint_383",158.0],["/endpoint_384",76.0],["/endpoint_385",114.0],["/endpoint_386",101.0],["/endpoint_387",108.0],["/endpoint_388",95.0],["/endpoint_389",102.0],["/endpoint_39",80.0],["/endpoint_390",82.0],["/endpoint_391",114.0],["/endpoint_392",128.0],["/endpoint_393",100.0],["/endpoint_394",108.0],["/endpoint_395",84.0],["/endpoint_396",128.0],["/endpoint_397",80.0],["/endpoint_398",104.0],["/endpoint_399",118.0],["/endpoint_40",109.0],["/endpoint_400",113.0],["/endpoint_401",130.0],["/endpoint_402",102.0],["/endpoint_403",98.0],["/endpoint_404",123.0],["/endpoint_405",72.0],["/endpoint_406",84.0],["/endpoint_407",106.0],["/endpoint_408",110.0],["/endpoint_409",81.0],["/endpoint_41",106.0],["/endpoint_410",72.0],["/endpoint_411",80.0],["/endpoint_412",77.0],["/endpoint_413",84.0],["/endpoint_414",108.0],["/endpoint_415",72.0],["/endpoint_416",78.0],["/endpoint_417",95.0],["/endpoint_418",105.0],["/endpoint_419",90.0],["/endpoint_42",85.0],["/endpoint_420",96.0],["/endpoint_421",114.0],["/endpoint_422",122.0],["/endpoint_423",132.0],["/endpoint_424",96.0],["/endpoint_425",89.0],["/endpoint_426",92.0],["/endpoint_427",96.0],["/endpoint_428",104.0],["/endpoint_429",77.0],["/endpoint_43",97.0],["/endpoint_430",112.0],["/endpoint_431",72.0],["/endpoint_432",106.0],["/endpoint_433",116.0],["/endpoint_434",96.0],["/endpoint_435",84.0],["/endpoint_436",84.0],["/endpoint_437",73.0],["/endpoint_438",48.0],["/endpoint_439",118.0],["/endpoint_44",97.0],["/endpoint_440",107.0],["/endpoint_441",101.0],["/endpoint_442",104.0],["/endpoint_443",64.0],["/endpoint_444",123.0],["/endpoint_445",74.0],["/endpoint_446",112.0],["/endpoint_447",117.0],["/endpoint_448",63.0],["/endpoint_449",100.0],["/endpoint_45",140.0],["/endpoint_450",96.0],["/endpoint_451",91.0],["/endpoint_452",92.0],["/endpoint_453",84.0],["/endpoint_454",90.0],["/endpoint_455",122.0],["/endpoint_456",80.0],["/endpoint_457",96.0],["/endpoint_458",80.0],["/endpoint_459",74.0],["/endpoint_46",83.0],["/endpoint_460",89.0],["/endpoint_461",68.0],["/endpoint_462",80.0],["/endpoint_463",121.0],["/endpoint_464",114.0],["/endpoint_465",72.0],["/endpoint_466",72.0],["/endpoint_467",108.0],["/endpoint_468",80.0],["/endpoint_469",76.0],["/endpoint_47",80.0],["/endpoint_470",112.0],["/endpoint_471",155.0],["/endpoint_472",84.0],["/endpoint_473",91.0],["/endpoint_474",118.0],["/endpoint_475",81.0],["/endpoint_476",79.0],["/endpoint_477",76.0],["/endpoint_478",99.0],["/endpoint_479",120.0],["/endpoint_48",92.0],["/endpoint_480",92.0],["/endpoint_481",131.0],["/endpoint_482",117.0],["/endpoint_483",102.0],["/endpoint_484",68.0],["/endpoint_485",96.0],["/endpoint_486",144.0],["/endpoint_487",96.0],["/endpoint_488",100.0],["/endpoint_489",102.0],["/endpoint_49",82.0],["/endpoint_490",141.0],["/endpoint_491",105.0],["/endpoint_492",72.0],["/endpoint_493",96.0],["/endpoint_494",104.0],["/endpoint_495",82.0],["/endpoint_496",96.0],["/endpoint_497",106.0],["/endpoint_498",69.0],["/endpoint_499",83.0],["/endpoint_50",106.0],["/endpoint_500",78.0],["/endpoint_501",135.0],["/endpoint_502",70.0],["/endpoint_503",64.0],["/endpoint_504",98.0],["/endpoint_505",122.0],["/endpoint_506",114.0],["/endpoint_507",112.0],["/endpoint_508",89.0],["/endpoint_509",110.0],["/endpoint_51",79.0],["/endpoint_510",89.0],["/endpoint_511",98.0],["/endpoint_512",96.0],["/endpoint_513",88.0],["/endpoint_514",96.0],["/endpoint_515",80.0],["/endpoint_516",100.0],["/endpoint_517",66.0],["/endpoint_518",97.0],["/endpoint_519",108.0],["/endpoint_52",120.0],["/endpoint_520",106.0],["/endpoint_521",103.0],["/endpoint_522",72.0],["/endpoint_523",92.0],["/endpoint_524",73.0],["/endpoint_525",96.0],["/endpoint_526",120.0],["/endpoint_527",124.0],["/endpoint_528",92.0],["/endpoint_529",142.0],["/endpoint_53",118.0],["/endpoint_530",100.0],["/endpoint_531",126.0],["/endpoint_532",78.0],["/endpoint_533",103.0],["/endpoint_534",68.0],["/endpoint_535",88.0],["/endpoint_536",64.0],["/endpoint_537",82.0],["/endpoint_538",86.0],["/endpoint_539",124.0],["/endpoint_54",99.0],["/endpoint_540",83.0],["/endpoint_541",90.0],["/endpoint_542",103.0],["/endpoint_543",112.0],["/endpoint_544",109.0],["/endpoint_545",87.0],["/endpoint_546",82.0],["/endpoint_547",98.0],["/endpoint_548",82.0],["/endpoint_549",82.0],["/endpoint_55",150.0],["/endpoint_550",130.0],["/endpoint_551",95.0],["/endpoint_552",104.0],["/endpoint_553",113.0],["/endpoint_554",84.0],["/endpoint_555",93.0],["/endpoint_556",72.0],["/endpoint_557",104.0],["/endpoint_558",105.0],["/endpoint_559",124.0],["/endpoint_56",82.0],["/endpoint_560",116.0],["/endpoint_561",100.0],["/endpoint_562",78.0],["/endpoint_563",60.0],["/endpoint_564",126.0],["/endpoint_565",100.0],["/endpoint_566",114.0],["/endpoint_567",122.0],["/endpoint_568",116.0],["/endpoint_569",144.0],["/endpoint_57",104.0],["/endpoint_570",114.0],["/endpoint_571",80.0],["/endpoint_572",90.0],["/endpoint_573",120.0],["/endpoint_574",146.0],["/endpoint_575",111.0],["/endpoint_576",82.0],["/endpoint_577",82.0],["/endpoint_578",112.0],["/endpoint_579",118.0],["/endpoint_58",83.0],["/endpoint_580",106.0],["/endpoint_581",149.0],["/endpoint_582",136.0],["/endpoint_583",82.0],["/endpoint_584",97.0],["/endpoint_585",84.0],["/endpoint_586",92.0],["/endpoint_587",90.0],["/endpoint_588",120.0],["/endpoint_589",84.0],["/endpoint_59",126.0],["/endpoint_590",114.0],["/endpoint_591",108.0],["/endpoint_592",52.0],["/endpoint_593",108.0],["/endpoint_594",97.0],["/endpoint_595",76.0],["/endpoint_596",133.0],["/endpoint_597",146.0],["/endpoint_598",77.0],["/endpoint_599",97.0],["/endpoint_60",100.0],["/endpoint_600",148.0],["/endpoint_601",88.0],["/endpoint_602",52.0],["/endpoint_603",146.0],["/endpoint_604",121.0],["/endpoint_605",132.0],["/endpoint_606",98.0],["/endpoint_607",108.0],["/endpoint_608",104.0],["/endpoint_609",85.0],["/endpoint_61",86.0],["/endpoint_610",82.0],["/endpoint_611",104.0],["/endpoint_612",90.0],["/endpoint_613",119.0],["/endpoint_614",94.0],["/endpoint_615",100.0],["/endpoint_616",125.0],["/endpoint_617",88.0],["/endpoint_618",110.0],["/endpoint_619",116.0],["/endpoint_62",105.0],["/endpoint_620",76.0],["/endpoint_621",101.0],["/endpoint_622",126.0],["/endpoint_623",92.0],["/endpoint_624",96.0],["/endpoint_625",107.0],["/endpoint_626",92.0],["/endpoint_627",107.0],["/endpoint_628",116.0],["/endpoint_629",112.0],["/endpoint_63",87.0],["/endpoint_630",82.0],["/endpoint_631",118.0],["/endpoint_632",117.0],["/endpoint_633",84.0],["/endpoint_634",101.0],["/endpoint_635",125.0],["/endpoint_636",88.0],["/endpoint_637",156.0],["/endpoint_638",130.0],["/endpoint_639",139.0],["/endpoint_64",148.0],["/endpoint_640",96.0],["/endpoint_641",108.0],["/endpoint_642",108.0],["/endpoint_643",86.0],["/endpoint_644",100.0],["/endpoint_645",112.0],["/endpoint_646",78.0],["/endpoint_647",105.0],["/endpoint_648",78.0],["/endpoint_649",101.0],["/endpoint_65",99.0],["/endpoint_650",88.0],["/endpoint_651",113.0],["/endpoint_652",91.0],["/endpoint_653",57.0],["/endpoint_654",93.0],["/endpoint_655",92.0],["/endpoint_656",92.0],["/endpoint_657",88.0],["/endpoint_658",118.0],["/endpoint_659",96.0],["/endpoint_66",72.0],["/endpoint_660",102.0],["/endpoint_661",120.0],["/endpoint_662",96.0],["/endpoint_663",68.0],["/endpoint_664",130.0],["/endpoint_665",110.0],["/endpoint_666",114.0],["/endpoint_667",93.0],["/endpoint_668",110.0],["/endpoint_669",124.0],["/endpoint_67",116.0],["/endpoint_670",120.0],["/endpoint_671",92.0],["/endpoint_672",74.0],["/endpoint_673",102.0],["/endpoint_674",96.0],["/endpoint_675",116.0],["/endpoint_676",116.0],["/endpoint_677",69.0],["/endpoint_678",156.0],["/endpoint_679",136.0],["/endpoint_68",100.0],["/endpoint_680",61.0],["/endpoint_681",118.0],["/endpoint_682",102.0],["/endpoint_683",64.0],["/endpoint_684",122.0],["/endpoint_685",116.0],["/endpoint_686",84.0],["/endpoint_687",92.0],["/endpoint_688",78.0],["/endpoint_689",96.0],["/endpoint_69",97.0],["/endpoint_690",102.0],["/endpoint_691",74.0],["/endpoint_692",100.0],["/endpoint_693",124.0],["/endpoint_694",116.0],["/endpoint_695",74.0],["/endpoint_696",90.0],["/endpoint_697",105.0],["/endpoint_698",92.0],["/endpoint_699",72.0],["/endpoint_70",140.0],["/endpoint_700",81.0],["/endpoint_701",106.0],["/endpoint_702",88.0],["/endpoint_703",82.0],["/endpoint_704",116.0],["/endpoint_705",77.0],["/endpoint_706",62.0],["/endpoint_707",116.0],["/endpoint_708",116.0],["/endpoint_709",96.0],["/endpoint_71",86.0],["/endpoint_710",127.0],["/endpoint_711",85.0],["/endpoint_712",70.0],["/endpoint_713",118.0],["/endpoint_714",112.0],["/endpoint_715",66.0],["/endpoint_716",79.0],["/endpoint_717",76.0],["/endpoint_718",90.0],["/endpoint_719",124.0],["/endpoint_72",100.0],["/endpoint_720",82.0],["/endpoint_721",100.0],["/endpoint_722",122.0],["/endpoint_723",79.0],["/endpoint_724",102.0],["/endpoint_725",122.0],["/endpoint_726",91.0],["/endpoint_727",86.0],["/endpoint_728",108.0],["/endpoint_729",92.0],["/endpoint_73",78.0],["/endpoint_730",98.0],["/endpoint_731",100.0],["/endpoint_732",122.0],["/endpoint_733",78.0],["/endpoint_734",134.0],["/endpoint_735",116.0],["/endpoint_736",113.0],["/endpoint_737",84.0],["/endpoint_738",94.0],["/endpoint_739",98.0],["/endpoint_74",81.0],["/endpoint_740",96.0],["/endpoint_741",66.0],["/endpoint_742",123.0],["/endpoint_743",106.0],["/endpoint_744",89.0],["/endpoint_745",76.0],["/endpoint_746",112.0],["/endpoint_747",96.0],["/endpoint_748",131.0],["/endpoint_749",72.0],["/endpoint_75",87.0],["/endpoint_750",70.0],["/endpoint_751",104.0],["/endpoint_752",70.0],["/endpoint_753",90.0],["/endpoint_754",85.0],["/endpoint_755",152.0],["/endpoint_756",144.0],["/endpoint_757",102.0],["/endpoint_758",100.0],["/endpoint_759",111.0],["/endpoint_76",90.0],["/endpoint_760",106.0],["/endpoint_761",89.0],["/endpoint_762",113.0],["/endpoint_763",84.0],["/endpoint_764",88.0],["/endpoint_765",101.0],["/endpoint_766",110.0],["/endpoint_767",112.0],["/endpoint_768",142.0],["/endpoint_769",120.0],["/endpoint_77",88.0],["/endpoint_770",106.0],["/endpoint_771",82.0],["/endpoint_772",132.0],["/endpoint_773",128.0],["/endpoint_774",122.0],["/endpoint_775",110.0],["/endpoint_776",69.0],["/endpoint_777",100.0],["/endpoint_778",89.0],["/endpoint_779",86.0],["/endpoint_78",104.0],["/endpoint_780",82.0],["/endpoint_781",111.0],["/endpoint_782",130.0],["/endpoint_783",128.0],["/endpoint_784",104.0],["/endpoint_785",120.0],["/endpoint_786",128.0],["/endpoint_787",116.0],["/endpoint_788",119.0],["/endpoint_789",96.0],["/endpoint_79",82.0],["/endpoint_790",106.0],["/endpoint_791",60.0],["/endpoint_792",104.0],["/endpoint_793",68.0],["/endpoint_794",122.0],["/endpoint_795",108.0],["/endpoint_796",108.0],["/endpoint_797",104.0],["/endpoint_798",102.0],["/endpoint_799",72.0],["/endpoint_80",113.0],["/endpoint_800",90.0],["/endpoint_801",92.0],["/endpoint_802",113.0],["/endpoint_803",116.0],["/endpoint_804",77.0],["/endpoint_805",120.0],["/endpoint_806",111.0],["/endpoint_807",108.0],["/endpoint_808",104.0],["/endpoint_809",124.0],["/endpoint_81",92.0],["/endpoint_810",108.0],["/endpoint_811",80.0],["/endpoint_812",114.0],["/endpoint_813",88.0],["/endpoint_814",114.0],["/endpoint_815",92.0],["/endpoint_816",98.0],["/endpoint_817",127.0],["/endpoint_818",107.0],["/endpoint_819",146.0],["/endpoint_82",106.0],["/endpoint_820",92.0],["/endpoint_821",122.0],["/endpoint_822",108.0],["/endpoint_823",100.0],["/endpoint_824",144.0],["/endpoint_825",106.0],["/endpoint_826",96.0],["/endpoint_827",104.0],["/endpoint_828",88.0],["/endpoint_829",112.0],["/endpoint_83",109.0],["/endpoint_830",89.0],["/endpoint_831",61.0],["/endpoint_832",88.0],["/endpoint_833",96.0],["/endpoint_834",104.0],["/endpoint_835",92.0],["/endpoint_836",108.0],["/endpoint_837",94.0],["/endpoint_838",107.0],["/endpoint_839",90.0],["/endpoint_84",121.0],["/endpoint_840",94.0],["/endpoint_841",75.0],["/endpoint_842",112.0],["/endpoint_843",84.0],["/endpoint_844",77.0],["/endpoint_845",81.0],["/endpoint_846",89.0],["/endpoint_847",70.0],["/endpoint_848",138.0],["/endpoint_849",56.0],["/endpoint_85",134.0],["/endpoint_850",70.0],["/endpoint_851",100.0],["/endpoint_852",109.0],["/endpoint_853",100.0],["/endpoint_854",90.0],["/endpoint_855",111.0],["/endpoint_856",83.0],["/endpoint_857",108.0],["/endpoint_858",96.0],["/endpoint_859",104.0],["/endpoint_86",90.0],["/endpoint_860",88.0],["/endpoint_861",113.0],["/endpoint_862",114.0],["/endpoint_863",134.0],["/endpoint_864",132.0],["/endpoint_865",124.0],["/endpoint_866",96.0],["/endpoint_867",118.0],["/endpoint_868",112.0],["/endpoint_869",86.0],["/endpoint_87",132.0],["/endpoint_870",84.0],["/endpoint_871",94.0],["/endpoint_872",118.0],["/endpoint_873",100.0],["/endpoint_874",102.0],["/endpoint_875",98.0],["/endpoint_876",97.0],["/endpoint_877",104.0],["/endpoint_878",58.0],["/endpoint_879",96.0],["/endpoint_88",104.0],["/endpoint_880",78.0],["/endpoint_881",82.0],["/endpoint_882",94.0],["/endpoint_883",86.0],["/endpoint_884",130.0],["/endpoint_885",134.0],["/endpoint_886",72.0],["/endpoint_887",98.0],["/endpoint_888",98.0],["/endpoint_889",85.0],["/endpoint_89",80.0],["/endpoint_890",116.0],["/endpoint_891",120.0],["/endpoint_892",93.0],["/endpoint_893",70.0],["/endpoint_894",121.0],["/endpoint_895",122.0],["/endpoint_896",106.0],["/endpoint_897",89.0],["/endpoint_898",107.0],["/endpoint_899",112.0],["/endpoint_90",128.0],["/endpoint_900",110.0],["/endpoint_901",100.0],["/endpoint_902",102.0],["/endpoint_903",76.0],["/endpoint_904",99.0],["/endpoint_905",100.0],["/endpoint_906",70.0],["/endpoint_907",122.0],["/endpoint_908",96.0],["/endpoint_909",92.0],["/endpoint_91",80.0],["/endpoint_910",133.0],["/endpoint_911",100.0],["/endpoint_912",68.0],["/endpoint_913",86.0],["/endpoint_914",137.0],["/endpoint_915",126.0],["/endpoint_916",74.0],["/endpoint_917",68.0],["/endpoint_918",86.0],["/endpoint_919",120.0],["/endpoint_92",114.0],["/endpoint_920",82.0],["/endpoint_921",126.0],["/endpoint_922",112.0],["/endpoint_923",94.0],["/endpoint_924",86.0],["/endpoint_925",142.0],["/endpoint_926",96.0],["/endpoint_927",103.0],["/endpoint_928",96.0],["/endpoint_929",100.0],["/endpoint_93",93.0],["/endpoint_930",54.0],["/endpoint_931",110.0],["/endpoint_932",88.0],["/endpoint_933",82.0],["/endpoint_934",101.0],["/endpoint_935",104.0],["/endpoint_936",84.0],["/endpoint_937",96.0],["/endpoint_938",108.0],["/endpoint_939",116.0],["/endpoint_94",76.0],["/endpoint_940",122.0],["/endpoint_941",72.0],["/endpoint_942",121.0],["/endpoint_943",108.0],["/endpoint_944",97.0],["/endpoint_945",100.0],["/endpoint_946",94.0],["/endpoint_947",116.0],["/endpoint_948",102.0],["/endpoint_949",101.0],["/endpoint_95",136.0],["/endpoint_950",100.0],["/endpoint_951",112.0],["/endpoint_952",76.0],["/endpoint_953",70.0],["/endpoint_954",101.0],["/endpoint_955",92.0],["/endpoint_956",118.0],["/endpoint_957",134.0],["/endpoint_958",95.0],["/endpoint_959",90.0],["/endpoint_96",116.0],["/endpoint_960",137.0],["/endpoint_961",105.0],["/endpoint_962",96.0],["/endpoint_963",108.0],["/endpoint_964",110.0],["/endpoint_965",108.0],["/endpoint_966",64.0],["/endpoint_967",89.0],["/endpoint_968",68.0],["/endpoint_969",90.0],["/endpoint_97",124.0],["/endpoint_970",108.0],["/endpoint_971",88.0],["/endpoint_972",132.0],["/endpoint_973",126.0],["/endpoint_974",115.0],["/endpoint_975",92.0],["/endpoint_976",108.0],["/endpoint_977",102.0],["/endpoint_978",91.0],["/endpoint_979",92.0],["/endpoint_98",76.0],["/endpoint_980",90.0],["/endpoint_981",102.0],["/endpoint_982",128.0],["/endpoint_983",102.0],["/endpoint_984",116.0],["/endpoint_985",80.0],["/endpoint_986",76.0],["/endpoint_987",82.0],["/endpoint_988",100.0],["/endpoint_989",105.0],["/endpoint_99",106.0],["/endpoint_990",56.0],["/endpoint_991",102.0],["/endpoint_992",108.0],["/endpoint_993",80.0],["/endpoint_994",98.0],["/endpoint_995",116.0],["/endpoint_996",124.0],["/endpoint_997",146.0],["/endpoint_998",100.0]],"aggSchema":[{"type":"string","name":"endpoint"},{"type":"int","name":"count"}],"aggOverflow":true,"aggSeriesLimitReached":false,"aggError":"","aggType":"scalar","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494385344E12,"submitTime":1.427494176126E12,"finishTime":1.427494386312E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["endpoint"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a1b20360-8ced-4c9f-b3e9-039ca6300de3"},{"version":"CommandV1","origId":3564,"guid":"50c5bff6-420a-4a85-bfcf-863a5cb1baf7","subtype":"script","commandType":"auto","position":6.8108108108108105,"command":"// Drill down to the top endpoints.\nval topEndpoints = endpointCountsRdd.takeOrdered(10)(new Ordering[(String, Int)] { def compare(a: (String, Int), b: (String, Int)) = b._2 compare a._2 })\nval topEndpointsDataFrame = sc.parallelize(topEndpoints).map(t => EndpointCounts(t._1, t._2)).toDF()\ndisplay(topEndpointsDataFrame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["/endpoint_327",165.0],["/endpoint_383",158.0],["/endpoint_315",158.0],["/endpoint_678",156.0],["/endpoint_637",156.0],["/endpoint_471",155.0],["/endpoint_755",152.0],["/endpoint_367",151.0],["/endpoint_55",150.0],["/endpoint_581",149.0]],"arguments":{},"schema":[{"type":"string","name":"endpoint"},{"type":"int","name":"count"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494386329E12,"submitTime":1.427494179034E12,"finishTime":1.427494386702E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f2cce73d-79b5-4055-b2eb-9d620b09add9"},{"version":"CommandV1","origId":3565,"guid":"31bfce8e-b507-46b7-a60c-fcd72e947579","subtype":"script","commandType":"auto","position":6.837837837837838,"command":"%md\n\n#### **Extra: Use SQL in a Scala Notebook**\n* A DataFrame can registered as a temporary SQL Table.\n* Then you can do SQL queries against the data in sql cells in this Scala notebook.\n* Results from select statements is SQL are automatically displayed.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### **Extra: Use SQL in a Scala Notebook**\n* A DataFrame can registered as a temporary SQL Table.\n* Then you can do SQL queries against the data in sql cells in this Scala notebook.\n* Results from select statements is SQL are automatically displayed.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494386707E12,"submitTime":1.427494187184E12,"finishTime":1.427494386707E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f3a36c71-3f6f-4f64-8ad9-dd25d60218ea"},{"version":"CommandV1","origId":3566,"guid":"a678881d-67d8-4f29-bbfb-e5e58842a6b1","subtype":"script","commandType":"auto","position":6.864864864864865,"command":"%sql DROP TABLE IF EXISTS SQLApacheAccessLogsTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494386711E12,"submitTime":1.427494189066E12,"finishTime":1.427494390326E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"ca340e8d-b936-4b00-8607-2963eb6a2d4d"},{"version":"CommandV1","origId":3567,"guid":"8b6606a5-1d7e-41f9-a2d1-af1f36b2a28a","subtype":"script","commandType":"auto","position":6.891891891891892,"command":"accessLogs.toDF().saveAsTable(\"SQLApacheAccessLogsTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494390331E12,"submitTime":1.427494191024E12,"finishTime":1.427494397312E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f426b017-5905-4413-9cb5-6e59d56096d7"},{"version":"CommandV1","origId":3568,"guid":"0799a009-8c90-4880-8385-788bd020a141","subtype":"script","commandType":"auto","position":6.918918918918919,"command":"%sql describe SQLApacheAccessLogsTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[["ipAddress","string",""],["clientIdentd","string",""],["userId","string",""],["dateTime","string",""],["method","string",""],["endpoint","string",""],["protocol","string",""],["responseCode","int",""],["contentSize","bigint",""]],"arguments":{},"schema":[{"type":"string","name":"col_name"},{"type":"string","name":"data_type"},{"type":"string","name":"comment"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494397317E12,"submitTime":1.427494196068E12,"finishTime":1.427494397409E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"c3040698-15f0-4da3-a692-00191f4ad431"},{"version":"CommandV1","origId":3569,"guid":"879e9929-fd4a-4336-b2f8-d8e9ea160a5c","subtype":"script","commandType":"auto","position":6.945945945945946,"command":"%sql SELECT * FROM SQLApacheAccessLogsTable limit 10;","commandVersion":0,"state":"finished","results":{"type":"table","data":[["127.0.0.1","-","-","21/Jul/2014:10:00:00 -0800","GET","/endpoint_494","HTTP/1.1",200.0,361.0],["3.3.3.3","-","-","21/Apr/2014:10:00:00 -0500","PUT","/endpoint_33","HTTP/1.1",200.0,288.0],["127.0.0.1","-","-","21/Jan/2014:10:00:00 -0200","GET","/endpoint_600","HTTP/1.1",200.0,468.0],["127.0.0.1","-","-","21/Jul/2014:10:00:00 -0800","GET","/endpoint_796","HTTP/1.1",200.0,342.0],["2.2.2.2","-","user1","21/Jan/2014:10:00:00 -0200","GET","/endpoint_132","HTTP/1.1",200.0,111.0],["127.0.0.1","-","-","21/Apr/2014:10:00:00 -0500","GET","/endpoint_645","HTTP/1.1",200.0,337.0],["4.4.4.4","-","-","21/Jan/2014:10:00:00 -0200","GET","/endpoint_925","HTTP/1.1",200.0,252.0],["4.4.4.4","-","-","21/Mar/2014:10:00:00 -0400","GET","/endpoint_711","HTTP/1.1",200.0,159.0],["2.2.2.2","-","-","21/Jan/2014:10:00:00 -0200","GET","/endpoint_03","HTTP/1.1",200.0,289.0],["4.4.4.4","-","-","21/Mar/2014:10:00:00 -0400","PUT","/endpoint_874","HTTP/1.1",200.0,114.0]],"arguments":{},"schema":[{"type":"string","name":"ipAddress"},{"type":"string","name":"clientIdentd"},{"type":"string","name":"userId"},{"type":"string","name":"dateTime"},{"type":"string","name":"method"},{"type":"string","name":"endpoint"},{"type":"string","name":"protocol"},{"type":"int","name":"responseCode"},{"type":"bigint","name":"contentSize"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494397414E12,"submitTime":1.427494196723E12,"finishTime":1.427494398036E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f24413f1-6a35-4285-b769-a4d7f041084d"},{"version":"CommandV1","origId":3570,"guid":"bb45fc51-c739-42a5-b560-4b924ceca913","subtype":"script","commandType":"auto","position":6.972972972972973,"command":"%md\n### Proceed to the **Log Analysis in SQL** Notebook to do the same analysis with SQL.\nSave yourself the trouble of converting results to a DataFrame to display them - results of SQL select statements are always displayed.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### Proceed to the **Log Analysis in SQL** Notebook to do the same analysis with SQL.\nSave yourself the trouble of converting results to a DataFrame to display them - results of SQL select statements are always displayed.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494398041E12,"submitTime":1.427494207039E12,"finishTime":1.427494398041E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["5b6b4a6a-14a2-41f1-92e9-b95878fa1ba0"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"8add343f-87c8-4fe0-a677-a8915f356476"},{"version":"CommandV1","origId":3571,"guid":"9e2d6f30-e7bd-4ac3-bc7d-e9e70bf5ac12","subtype":"command","commandType":"auto","position":7.000004877941176,"command":"val runEnd = System.currentTimeMillis() / 1000","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">runEnd: Long = 1427494398\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494398044E12,"submitTime":1.427494366212E12,"finishTime":1.427494398129E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"6e8352a8-9da0-4ca6-831f-b0d09410eb00"},{"version":"CommandV1","origId":3572,"guid":"42d788fb-296f-4843-af53-6a876f7317cb","subtype":"command","commandType":"auto","position":8.000004877941176,"command":"%md\n\n### **Step 3:** Insert a row to indicate the result of this run.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 3:** Insert a row to indicate the result of this run.","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494398135E12,"submitTime":1.427494366261E12,"finishTime":1.427494398135E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"deab919e-a54e-4469-9c2d-5b7774cd3040"},{"version":"CommandV1","origId":3573,"guid":"9f102818-247a-4faf-9c4c-652c2e8850b8","subtype":"command","commandType":"auto","position":9.000004877941176,"command":"case class Run(runStart: Long, runDuration: Long) \nval dataFrame = sc.parallelize(Array(Run(runStart, runEnd - runStart))).toDF()\ndataFrame.registerTempTable(\"oneRun\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Run\nschemaRDD: org.apache.spark.sql.DataFrame = [runStart: bigint, runDuration: bigint]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494407153E12,"submitTime":1.427494407079E12,"finishTime":1.427494407487E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"639d0965-b5d5-4ba1-8c6d-af562dd40bda"},{"version":"CommandV1","origId":3574,"guid":"987f2517-968a-4396-b83b-4de54656d70f","subtype":"command","commandType":"auto","position":10.000004877941176,"command":"%sql insert into TABLE logsAnalysisScala select runStart, runDuration from oneRun limit 1","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[{"type":"int","name":"runStart"},{"type":"int","name":"runDuration"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494408676E12,"submitTime":1.42749440861E12,"finishTime":1.427494411376E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"21d40eee-b68b-42d4-a410-7ebb3073f168"},{"version":"CommandV1","origId":3575,"guid":"536a57e0-5f21-4055-825f-161751d76210","subtype":"command","commandType":"auto","position":11.000004877941176,"command":"%sql select from_unixtime(runstart) as starttime, runduration from logsAnalysisScala","commandVersion":0,"state":"finished","results":{"type":"table","data":[["2014-12-02 21:36:17",13.0],["2015-03-27 22:13:00",18.0]],"arguments":{},"schema":[{"type":"string","name":"starttime"},{"type":"int","name":"runduration"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494412308E12,"submitTime":1.427494412253E12,"finishTime":1.427494413313E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"90439b3f-69a2-4ca0-82be-1519b217b012"}],"guid":"1a797db2-cf12-490a-9c5f-09fd1bebe8ba","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"2c809e4c-e789-43d0-9817-efc910dffb71","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>