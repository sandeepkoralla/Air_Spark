<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Sample Applications / Log Analysis / Monitor a Job in Python - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3576,"name":"Sample Applications / Log Analysis / Monitor a Job in Python","language":"python","commands":[{"version":"CommandV1","origId":3577,"guid":"9be46b16-9668-4c7f-ac17-d9a081d1974c","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n# **Monitoring in Python**\nThis notebook describes how to monitor runs of the log analysis notebook. ","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"# **Monitoring in Python**\nThis notebook describes how to monitor runs of the log analysis notebook.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494421979E12,"submitTime":1.427494420282E12,"finishTime":1.427494421984E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"1c8ce209-0dfe-4ac5-820e-4f32036fc302"},{"version":"CommandV1","origId":3578,"guid":"6726a35a-e380-49f9-ab97-47a630b86796","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n\n### **Step 1:** Create a table that will contain stats about the log analysis run that can be monitored.\nOptionally, these commands could be moved into the logs analysis notebook themselves if there are parameters there to track - such as the number of errored inputs, etc.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 1:** Create a table that will contain stats about the log analysis run that can be monitored.\nOptionally, these commands could be moved into the logs analysis notebook themselves if there are parameters there to track - such as the number of errored inputs, etc.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494421989E12,"submitTime":1.427494420394E12,"finishTime":1.427494421993E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"ccbcc7da-17b2-446b-9522-9aa526aecc75"},{"version":"CommandV1","origId":3579,"guid":"bc131f68-f96f-4bd4-a9bc-54a54a67a213","subtype":"command","commandType":"auto","position":2.0,"command":"%sql CREATE TABLE IF NOT EXISTS logsAnalysisPython (runStart INT, runDuration INT)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[{"type":"string","name":"result"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Error in SQL statement: java.lang.RuntimeException: org.apache.spark.sql.execution.QueryExecutionException: FAILED: SemanticException [Error 10072]: Database does not exist: default\n\tat org.apache.spark.sql.hive.HiveContext.runHive(HiveContext.scala:312)\n\tat org.apache.spark.sql.hive.HiveContext.runSqlHive(HiveContext.scala:280)\n\tat org.apache.spark.sql.hive.execution.HiveNativeCommand.run(HiveNativeCommand.scala:33)\n\tat org.apache.spark.sql.execution.ExecutedCommand.sideEffectResult$lzycompute(commands.scala:54)\n\tat org.apache.spark.sql.execution.ExecutedCommand.sideEffectResult(commands.scala:54)\n\tat org.apache.spark.sql.execution.ExecutedCommand.execute(commands.scala:64)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd$lzycompute(SQLContext.scala:1088)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd(SQLContext.scala:1088)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:147)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:130)\n\tat org.apache.spark.sql.DataFrame$.apply(DataFrame.scala:51)\n\tat org.apache.spark.sql.hive.HiveContext.sql(HiveContext.scala:92)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$2.apply(DriverLocal.scala:199)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$2.apply(DriverLocal.scala:178)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:178)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:78)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper$$anonfun$2.apply(DriverWrapper.scala:401)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper$$anonfun$2.apply(DriverWrapper.scala:401)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.executeCommand(DriverWrapper.scala:398)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.runInner(DriverWrapper.scala:301)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.run(DriverWrapper.scala:186)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.DriverLocal.executeSql(DriverLocal.scala:214)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:78)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper$$anonfun$2.apply(DriverWrapper.scala:401)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper$$anonfun$2.apply(DriverWrapper.scala:401)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.executeCommand(DriverWrapper.scala:398)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.runInner(DriverWrapper.scala:301)\n\tat com.databricks.backend.daemon.chauffeur.DriverWrapper.run(DriverWrapper.scala:186)\n\tat java.lang.Thread.run(Thread.java:745)\n","startTime":1.427494421997E12,"submitTime":1.427494420415E12,"finishTime":1.427494423106E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"4d9ef679-d4c2-416a-80ac-4ca02dc7403e"},{"version":"CommandV1","origId":3580,"guid":"aba854a3-7cb3-44ba-abfa-fc2af180c083","subtype":"command","commandType":"auto","position":2.5,"command":"%md\n\n### **Step 2:** Run the logs analysis notebook and time it.\nNote: Python notebooks can be run from other Python notebooks only.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 2:** Run the logs analysis notebook and time it.\nNote: Python notebooks can be run from other Python notebooks only.","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.42749442311E12,"submitTime":1.427494420438E12,"finishTime":1.427494423115E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"57d9aa09-a7ad-463c-aab0-e636bb782fb4"},{"version":"CommandV1","origId":3581,"guid":"bdd8cacc-d894-4f40-9da2-723daeafb90f","subtype":"command","commandType":"auto","position":3.0,"command":"import time\nrunStart = time.time()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494423118E12,"submitTime":1.427494420461E12,"finishTime":1.427494423145E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"b26fd898-c52f-4dd4-833b-e6f3070475a9"},{"version":"CommandV1","origId":3582,"guid":"67e9aad5-dbee-48bd-870c-981ec81a78b0","subtype":"command","commandType":"auto","position":3.5,"command":"runStart","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>1427494423.14197\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.42749442315E12,"submitTime":1.427494420492E12,"finishTime":1.427494423194E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"e15c5a66-3f61-4ba9-a09b-ae0ba1ab7601"},{"version":"CommandV1","origId":3583,"guid":"81f3cd69-39f4-440b-9752-126780e4276d","subtype":"command","commandType":"auto","position":3.75,"command":"%run \"/databricks_guide/12 Sample Applications/2 Log Analysis/2 Log Analysis in Python\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null,"nuid":"27190221-dc4b-4312-a8de-e1ca913247b2"},{"version":"CommandV1","origId":3584,"guid":"4d38c481-c469-4acd-99e7-e5f441553100","subtype":"script","commandType":"auto","position":4.027027027027027,"command":"%md\n\n# **Log Analysis in Python**\nThis notebook analyzes Apache access logs with Python.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"# **Log Analysis in Python**\nThis notebook analyzes Apache access logs with Python.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423199E12,"submitTime":1.427493587905E12,"finishTime":1.427494423203E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"b3629268-d0eb-45a7-90c1-fb65ccfd38f6"},{"version":"CommandV1","origId":3585,"guid":"c4d54fce-0c07-46d6-aab2-d06a54630d61","subtype":"script","commandType":"auto","position":4.054054054054054,"command":"%md\n\n### **Step 1:** Change this parameter to your sample logs directory.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 1:** Change this parameter to your sample logs directory.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423207E12,"submitTime":1.427493587922E12,"finishTime":1.427494423211E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1e958200-d652-4822-aed0-692a4cd4cba1"},{"version":"CommandV1","origId":3586,"guid":"32ef182c-fca1-4642-877c-057759bd2208","subtype":"script","commandType":"auto","position":4.081081081081081,"command":"DBFS_SAMPLE_LOGS_FOLDER = \"/dbguide/sample_logs\"  # If you modified this in step one, do the same thing.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423215E12,"submitTime":1.427493960472E12,"finishTime":1.427494423248E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"bee3ffaf-4325-4d00-b9ff-c605ccd01bb6"},{"version":"CommandV1","origId":3587,"guid":"66ab0353-16b4-4584-84bf-5ab4a1fc98b4","subtype":"script","commandType":"auto","position":4.108108108108108,"command":"%md\n\n### **Step 2:** Create a parser for the Apache Access log lines to create Row objects.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 2:** Create a parser for the Apache Access log lines to create Row objects.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423253E12,"submitTime":1.427493961925E12,"finishTime":1.427494423258E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"71fc4e7c-dba9-4980-bb5a-e0c346f4726b"},{"version":"CommandV1","origId":3588,"guid":"f6935e48-060e-4b4d-aced-489379dbf481","subtype":"script","commandType":"auto","position":4.135135135135135,"command":"import re\nfrom pyspark.sql import Row\n\nAPACHE_ACCESS_LOG_PATTERN = '^(\\S+) (\\S+) (\\S+) \\[([\\w:/]+\\s[+\\-]\\d{4})\\] \"(\\S+) (\\S+) (\\S+)\" (\\d{3}) (\\d+)'\n\n# Returns a dictionary containing the parts of the Apache Access Log.\ndef parse_apache_log_line(logline):\n    match = re.search(APACHE_ACCESS_LOG_PATTERN, logline)\n    if match is None:\n        # Optionally, you can change this to just ignore if each line of data is not critical.\n        #   Corrupt data is common when writing to files.\n        raise Error(\"Invalid logline: %s\" % logline)\n    return Row(\n        ipAddress    = match.group(1),\n        clientIdentd = match.group(2),\n        userId       = match.group(3),\n        dateTime     = match.group(4),\n        method       = match.group(5),\n        endpoint     = match.group(6),\n        protocol     = match.group(7),\n        responseCode = int(match.group(8)),\n        contentSize  = long(match.group(9)))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423261E12,"submitTime":1.427493962747E12,"finishTime":1.427494423281E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"9176dd65-3544-4a27-b78b-b3f16e344bf5"},{"version":"CommandV1","origId":3589,"guid":"ee5a2453-d387-458c-b7d6-4418755ae6cd","subtype":"script","commandType":"auto","position":4.162162162162162,"command":"%md\n\n### **Step 3:** Load the log lines into Spark.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 3:** Load the log lines into Spark.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423287E12,"submitTime":1.427493964383E12,"finishTime":1.427494423292E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"8375aec4-68b8-49b9-895e-b5e59e64b3d5"},{"version":"CommandV1","origId":3590,"guid":"66b59877-5db9-49f4-8c9e-047e916a301a","subtype":"script","commandType":"auto","position":4.1891891891891895,"command":"access_logs = (sc.textFile(DBFS_SAMPLE_LOGS_FOLDER)\n               # Call the parse_apace_log_line function on each line.\n               .map(parse_apache_log_line)\n               # Caches the objects in memory since they will be queried multiple times.\n               .cache())\n# An action must be called on the RDD to actually populate the cache.\naccess_logs.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>100000\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494423296E12,"submitTime":1.427493965325E12,"finishTime":1.427494424811E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"3601bd65-932b-4d07-abd1-b064dde39267"},{"version":"CommandV1","origId":3591,"guid":"07ba80db-e500-4015-9594-9ee8ce0e6e1c","subtype":"script","commandType":"auto","position":4.216216216216216,"command":"%md\n\n### **Step 4:** Calculate statistics on the Content Sizes returned.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 4:** Calculate statistics on the Content Sizes returned.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494424815E12,"submitTime":1.427493974344E12,"finishTime":1.427494424821E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"b2552a42-2cb9-4f28-8f21-6f766080fc43"},{"version":"CommandV1","origId":3592,"guid":"bf3160c7-c151-4e21-9986-9cae0bffac73","subtype":"script","commandType":"auto","position":4.243243243243243,"command":"# Create the content sizes rdd.\ncontent_sizes = (access_logs\n                 .map(lambda row: row.contentSize)\n                 .cache()) # Cache this as well since it will be queried many times.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494424825E12,"submitTime":1.427493974878E12,"finishTime":1.4274944249E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"118d1c38-f808-4e5c-9d7a-a590d4dfd715"},{"version":"CommandV1","origId":3593,"guid":"12456738-cb17-4e84-a467-9c5b4cd58f3d","subtype":"script","commandType":"auto","position":4.27027027027027,"command":"average_content_size = content_sizes.reduce(lambda x, y: x + y) / content_sizes.count()\naverage_content_size","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>251L\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494424905E12,"submitTime":1.427493975985E12,"finishTime":1.427494425282E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"6ef458a2-c9e1-4872-b035-1594493f073a"},{"version":"CommandV1","origId":3594,"guid":"063e0ccf-442c-4de8-a479-525ee77503a0","subtype":"script","commandType":"auto","position":4.297297297297297,"command":"min_content_size = content_sizes.min()\nmin_content_size","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>0L\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425287E12,"submitTime":1.427493977204E12,"finishTime":1.427494425361E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"c855aba8-e4ed-40c8-b17b-9ce34375b3ff"},{"version":"CommandV1","origId":3595,"guid":"79c39128-07c2-4d6c-94e3-03a450ae6fa8","subtype":"script","commandType":"auto","position":4.324324324324325,"command":"max_content_size = content_sizes.max()\nmax_content_size","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">22</span><span class=\"ansired\">]: </span>500L\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425365E12,"submitTime":1.427493977937E12,"finishTime":1.427494425439E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1a9977e9-d903-482b-8807-b207c2932231"},{"version":"CommandV1","origId":3596,"guid":"41d21b9d-7e54-4cb3-acf2-474491e95626","subtype":"script","commandType":"auto","position":4.351351351351352,"command":"print \"Content Size Statistics:\\n  Avg: %s\\n  Min: %s\\n  Max: %s\" % (average_content_size, min_content_size, max_content_size)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Content Size Statistics:\n  Avg: 251\n  Min: 0\n  Max: 500\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425444E12,"submitTime":1.427493978733E12,"finishTime":1.427494425458E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"b2042795-aede-4f8a-be14-eba23f94dc10"},{"version":"CommandV1","origId":3597,"guid":"4a4efaea-e2b1-4718-a9d2-f970c8cf3866","subtype":"script","commandType":"auto","position":4.378378378378378,"command":"%md ### **Step 5:** Display the response code to count statistics.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 5:** Display the response code to count statistics.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425463E12,"submitTime":1.427493979457E12,"finishTime":1.427494425467E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"4161585f-c262-4f6e-9a9d-110e64525a9d"},{"version":"CommandV1","origId":3598,"guid":"6659e82f-0bdf-49be-b6e8-96fc7755e053","subtype":"script","commandType":"auto","position":4.405405405405405,"command":"# First, calculate the response code to count pairs.\nresponse_code_to_count_pair_rdd = (access_logs\n                                   .map(lambda row: (row.responseCode, 1))\n                                   .reduceByKey(lambda x, y: x + y))\nresponse_code_to_count_pair_rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">24</span><span class=\"ansired\">]: </span>PythonRDD[506] at RDD at PythonRDD.scala:43\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425471E12,"submitTime":1.427493980024E12,"finishTime":1.427494425545E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"ea5f5033-cd96-4ff1-bc3a-3eb41870346e"},{"version":"CommandV1","origId":3599,"guid":"caeb8305-a5c0-4c1d-b26c-401c3468dc20","subtype":"script","commandType":"auto","position":4.4324324324324325,"command":"# View the responseCodeToCount by calling take on the RDD - which outputs an array of tuples.\n# Notice the use of take(100) - just in case bad data may have slipped in and there are too many response codes.\nresponse_code_to_count_array = response_code_to_count_pair_rdd.take(100)\nresponse_code_to_count_array","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>[(200, 70943), (500, 14612), (401, 14445)]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.42749442555E12,"submitTime":1.427493980467E12,"finishTime":1.427494425925E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"6806b421-ddce-4856-b7c8-40fd389caaaa"},{"version":"CommandV1","origId":3600,"guid":"ed8ca9cb-3ee7-40eb-9a2f-99dcdfe81a53","subtype":"script","commandType":"auto","position":4.45945945945946,"command":"# To call display(), the RDD of tuples must be converted to a DataFrame.\n# A simple map can accomplish that.\nresponse_code_to_count_row_rdd = response_code_to_count_pair_rdd.map(lambda (x, y): Row(response_code=x, count=y))\nresponse_code_to_count_data_frame = sqlContext.inferSchema(response_code_to_count_row_rdd)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494425931E12,"submitTime":1.427493980974E12,"finishTime":1.427494426256E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"6b5b9e99-be02-4f8c-836b-6334303aab81"},{"version":"CommandV1","origId":3601,"guid":"d306264c-12de-44a4-8a99-db16b46678f6","subtype":"script","commandType":"auto","position":4.486486486486487,"command":"# Now, display can be called on the resulting DataFrame.\n#   For this display, a Pie Chart is chosen by selecting that icon.\n#   Then, \"Plot Options...\" was used to make the response_code the key and count as the value.\ndisplay(response_code_to_count_data_frame)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[70943.0,200.0],[14612.0,500.0],[14445.0,401.0]],"arguments":{},"schema":[{"type":"bigint","name":"count"},{"type":"bigint","name":"response_code"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494426261E12,"submitTime":1.427493982561E12,"finishTime":1.427494426952E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"650","height":"auto","xColumns":["response_code"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"3bc59d0b-5cf2-4381-9ca9-99f4a9ce2c8c"},{"version":"CommandV1","origId":3602,"guid":"5bee8ee8-1c78-4077-a3ba-30eac51a1754","subtype":"script","commandType":"auto","position":4.513513513513513,"command":"%md #### NOTE: Instead of converting to a DataFrame for displaying, Spark SQL could also have been used.\n* At the end of this notebook, it's shown how to register this table for Spark SQL.\n* See the **Log Analysis in SQL** Notebook for more details on writing sql queries.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### NOTE: Instead of converting to a DataFrame for displaying, Spark SQL could also have been used.\n* At the end of this notebook, it's shown how to register this table for Spark SQL.\n* See the **Log Analysis in SQL** Notebook for more details on writing sql queries.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494426957E12,"submitTime":1.427493985249E12,"finishTime":1.427494426961E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"e2488f7d-fcab-4552-9b83-6b6a9b6b8a7f"},{"version":"CommandV1","origId":3603,"guid":"91d42281-75c8-4748-8103-655f16536c67","subtype":"script","commandType":"auto","position":4.54054054054054,"command":"%md\n\n### **Step 6:** View a list of IPAddresses that has accessed the server more than N times.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 6:** View a list of IPAddresses that has accessed the server more than N times.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494426965E12,"submitTime":1.427493987337E12,"finishTime":1.427494426969E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"ba8b3fdc-3324-42d3-962c-9bdcbe5579e7"},{"version":"CommandV1","origId":3604,"guid":"ee149cfd-8e47-4559-ac36-b5fcac97d9e4","subtype":"script","commandType":"auto","position":4.5675675675675675,"command":"# Change this number as it makes sense for your data set.\nn = 100","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494426973E12,"submitTime":1.427493988236E12,"finishTime":1.427494427091E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"7bea9f0b-0053-4f37-836a-bb4ab45f14f2"},{"version":"CommandV1","origId":3605,"guid":"41a3fcce-b86b-4aeb-a95f-cfc0c4e385b1","subtype":"script","commandType":"auto","position":4.594594594594595,"command":"ip_addresses_rdd = (access_logs\n                    .map(lambda log: (log.ipAddress, 1))\n                    .reduceByKey(lambda x, y : x + y)\n                    .filter(lambda s: s[1] > n)\n                    .map(lambda s: Row(ip_address = s[0]))) # Create a Row so this can be converted to a DataFrame.\nip_addresses_dataframe = sqlContext.inferSchema(ip_addresses_rdd)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494427096E12,"submitTime":1.427493989094E12,"finishTime":1.427494427722E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"8374783e-79ce-42c4-b1ee-81a2279fe656"},{"version":"CommandV1","origId":3606,"guid":"9122ad15-04a2-4b08-b89a-16b8b926a2fa","subtype":"script","commandType":"auto","position":4.621621621621622,"command":"# Display this list of IPAddresses in a chart with scrolling is a nice way to present this data.\ndisplay(ip_addresses_dataframe)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["3.3.3.3"],["2.2.2.2"],["1.1.1.1"],["4.4.4.4"],["127.0.0.1"]],"arguments":{},"schema":[{"type":"string","name":"ip_address"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494427727E12,"submitTime":1.427493990783E12,"finishTime":1.427494427892E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a5140bc2-9b48-44b3-bd7a-67ec040bccdf"},{"version":"CommandV1","origId":3607,"guid":"18f2777d-3ee4-4a1e-a2b9-b4d1cc7a711d","subtype":"script","commandType":"auto","position":4.648648648648649,"command":"%md #### **Tip:** To see how an rdd is computed, use the **toDebugString()** function.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### **Tip:** To see how an rdd is computed, use the **toDebugString()** function.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494427897E12,"submitTime":1.427493991967E12,"finishTime":1.427494427901E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"61e6fa95-9356-4f6c-94bf-439e3a0953d9"},{"version":"CommandV1","origId":3608,"guid":"21069b3a-2de0-475e-9734-099c7a3f931c","subtype":"script","commandType":"auto","position":4.675675675675675,"command":"print ip_addresses_dataframe.rdd.toDebugString()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(4) PythonRDD[539] at RDD at PythonRDD.scala:43 []\n |  MapPartitionsRDD[538] at mapPartitions at SerDeUtil.scala:143 []\n |  MapPartitionsRDD[537] at map at DataFrame.scala:1238 []\n |  MapPartitionsRDD[536] at map at DataFrame.scala:889 []\n |  MapPartitionsRDD[534] at mapPartitions at SQLContext.scala:1163 []\n |  MapPartitionsRDD[533] at map at SerDeUtil.scala:103 []\n |  MapPartitionsRDD[532] at mapPartitions at SerDeUtil.scala:150 []\n |  PythonRDD[531] at RDD at PythonRDD.scala:43 []\n |  MapPartitionsRDD[524] at mapPartitions at PythonRDD.scala:342 []\n |  ShuffledRDD[523] at partitionBy at NativeMethodAccessorImpl.java:-2 []\n +-(4) PairwiseRDD[522] at reduceByKey at &lt;ipython-input-29-98ae161e16fe&gt;:3 []\n    |  PythonRDD[521] at reduceByKey at &lt;ipython-input-29-98ae161e16fe&gt;:3 []\n    |  PythonRDD[494] at RDD at PythonRDD.scala:43 []\n    |      CachedPartitions: 4; MemorySize: 8.2 MB; TachyonSize: 0.0 B; DiskSize: 0.0 B\n    |  /dbguide/sample_logs MapPartitionsRDD[493] at textFile at NativeMethodAccessorImpl.java:-2 []\n    |  /dbguide/sample_logs HadoopRDD[492] at textFile at NativeMethodAccessorImpl.java:-2 []\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494427905E12,"submitTime":1.427493992922E12,"finishTime":1.427494428029E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"6e5a4fe1-6252-49ba-a0ba-12e936dadd86"},{"version":"CommandV1","origId":3609,"guid":"3d187144-2d22-48f3-b734-49b1bfab0591","subtype":"script","commandType":"auto","position":4.702702702702703,"command":"%md\n\n### **Step 7:** Explore Statistics about the endpoints. ","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 7:** Explore Statistics about the endpoints.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494428035E12,"submitTime":1.427493994183E12,"finishTime":1.42749442804E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"b3c4f038-e911-4f67-8145-74fcd9eeae2b"},{"version":"CommandV1","origId":3610,"guid":"3134d2dc-29d7-4c5c-8dc8-daf337da1911","subtype":"script","commandType":"auto","position":4.72972972972973,"command":"# Calculate the number of hits for each endpoint.\nendpoint_counts_rdd = (access_logs\n                       .map(lambda log: (log.endpoint, 1))\n                       .reduceByKey(lambda x, y: x + y)\n                       .map(lambda s: Row(endpoint = s[0], num_hits = s[1])))\nendpoint_counts_dataframe = sqlContext.inferSchema(endpoint_counts_rdd)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494428045E12,"submitTime":1.427494015196E12,"finishTime":1.427494428621E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"8e6b520b-3842-4936-bf7c-61c484932342"},{"version":"CommandV1","origId":3611,"guid":"3b9ce277-1c39-4304-8753-a19a6ce36df4","subtype":"script","commandType":"auto","position":4.756756756756757,"command":"# Display a plot of the distribution of the number of hits across the endpoints.\ndisplay(endpoint_counts_dataframe)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["/endpoint_772",132.0],["/endpoint_563",60.0],["/endpoint_776",69.0],["/endpoint_215",116.0],["/endpoint_480",92.0],["/endpoint_945",100.0],["/endpoint_534",68.0],["/endpoint_677",69.0],["/endpoint_286",125.0],["/endpoint_479",120.0],["/endpoint_376",86.0],["/endpoint_992",108.0],["/endpoint_439",118.0],["/endpoint_369",121.0],["/endpoint_83",109.0],["/endpoint_365",100.0],["/endpoint_567",122.0],["/endpoint_361",108.0],["/endpoint_967",89.0],["/endpoint_628",116.0],["/endpoint_963",108.0],["/endpoint_804",77.0],["/endpoint_372",76.0],["/endpoint_358",98.0],["/endpoint_912",68.0],["/endpoint_800",90.0],["/endpoint_956",118.0],["/endpoint_390",82.0],["/endpoint_673",102.0],["/endpoint_413",84.0],["/endpoint_251",92.0],["/endpoint_787",116.0],["/endpoint_196",90.0],["/endpoint_574",146.0],["/endpoint_255",100.0],["/endpoint_178",100.0],["/endpoint_879",96.0],["/endpoint_98",76.0],["/endpoint_989",105.0],["/endpoint_505",122.0],["/endpoint_985",80.0],["/endpoint_484",68.0],["/endpoint_668",110.0],["/endpoint_493",96.0],["/endpoint_620",76.0],["/endpoint_596",133.0],["/endpoint_76",90.0],["/endpoint_659",96.0],["/endpoint_72",100.0],["/endpoint_260",93.0],["/endpoint_970",108.0],["/endpoint_321",89.0],["/endpoint_893",70.0],["/endpoint_646",78.0],["/endpoint_974",115.0],["/endpoint_167",82.0],["/endpoint_871",94.0],["/endpoint_909",92.0],["/endpoint_343",86.0],["/endpoint_875",98.0],["/endpoint_174",84.0],["/endpoint_978",91.0],["/endpoint_404",123.0],["/endpoint_242",112.0],["/endpoint_831",61.0],["/endpoint_246",76.0],["/endpoint_880",78.0],["/endpoint_611",104.0],["/endpoint_453",84.0],["/endpoint_181",112.0],["/endpoint_996",124.0],["/endpoint_36",85.0],["/endpoint_189",96.0],["/endpoint_228",93.0],["/endpoint_69",97.0],["/endpoint_123",100.0],["/endpoint_109",99.0],["/endpoint_422",122.0],["/endpoint_65",99.0],["/endpoint_105",108.0],["/endpoint_457",96.0],["/endpoint_185",132.0],["/endpoint_101",109.0],["/endpoint_497",106.0],["/endpoint_400",113.0],["/endpoint_615",100.0],["/endpoint_192",96.0],["/endpoint_475",81.0],["/endpoint_282",90.0],["/endpoint_866",96.0],["/endpoint_277",132.0],["/endpoint_310",96.0],["/endpoint_462",80.0],["/endpoint_570",114.0],["/endpoint_901",100.0],["/endpoint_747",96.0],["/endpoint_523",92.0],["/endpoint_743",106.0],["/endpoint_602",52.0],["/endpoint_43",97.0],["/endpoint_552",104.0],["/endpoint_211",105.0],["/endpoint_884",130.0],["/endpoint_725",122.0],["/endpoint_642",108.0],["/endpoint_718",90.0],["/endpoint_905",100.0],["/endpoint_721",100.0],["/endpoint_94",76.0],["/endpoint_444",123.0],["/endpoint_307",141.0],["/endpoint_90",128.0],["/endpoint_761",89.0],["/endpoint_116",97.0],["/endpoint_808",104.0],["/endpoint_549",82.0],["/endpoint_112",113.0],["/endpoint_509",110.0],["/endpoint_163",112.0],["/endpoint_857",108.0],["/endpoint_354",89.0],["/endpoint_853",100.0],["/endpoint_14",104.0],["/endpoint_839",90.0],["/endpoint_10",136.0],["/endpoint_691",74.0],["/endpoint_916",74.0],["/endpoint_848",138.0],["/endpoint_264",105.0],["/endpoint_268",112.0],["/endpoint_299",109.0],["/endpoint_754",85.0],["/endpoint_206",74.0],["/endpoint_545",87.0],["/endpoint_431",72.0],["/endpoint_202",62.0],["/endpoint_736",113.0],["/endpoint_03",112.0],["/endpoint_556",72.0],["/endpoint_732",122.0],["/endpoint_426",92.0],["/endpoint_606",98.0],["/endpoint_87",132.0],["/endpoint_295",127.0],["/endpoint_325",92.0],["/endpoint_488",100.0],["/endpoint_329",80.0],["/endpoint_710",127.0],["/endpoint_127",111.0],["/endpoint_840",94.0],["/endpoint_259",72.0],["/endpoint_844",77.0],["/endpoint_813",88.0],["/endpoint_682",102.0],["/endpoint_291",76.0],["/endpoint_686",84.0],["/endpoint_923",94.0],["/endpoint_619",116.0],["/endpoint_927",103.0],["/endpoint_417",95.0],["/endpoint_512",96.0],["/endpoint_394",108.0],["/endpoint_516",100.0],["/endpoint_233",80.0],["/endpoint_699",72.0],["/endpoint_273",98.0],["/endpoint_237",134.0],["/endpoint_703",82.0],["/endpoint_651",113.0],["/endpoint_303",111.0],["/endpoint_707",116.0],["/endpoint_32",144.0],["/endpoint_332",100.0],["/endpoint_398",104.0],["/endpoint_336",89.0],["/endpoint_18",94.0],["/endpoint_138",93.0],["/endpoint_660",102.0],["/endpoint_581",149.0],["/endpoint_938",108.0],["/endpoint_934",101.0],["/endpoint_835",92.0],["/endpoint_930",54.0],["/endpoint_527",124.0],["/endpoint_794",122.0],["/endpoint_448",63.0],["/endpoint_637",156.0],["/endpoint_585",84.0],["/endpoint_350",81.0],["/endpoint_435",84.0],["/endpoint_633",84.0],["/endpoint_714",112.0],["/endpoint_664",130.0],["/endpoint_783",128.0],["/endpoint_541",90.0],["/endpoint_655",92.0],["/endpoint_695",74.0],["/endpoint_897",89.0],["/endpoint_141",102.0],["/endpoint_61",86.0],["/endpoint_826",96.0],["/endpoint_145",72.0],["/endpoint_466",72.0],["/endpoint_149",100.0],["/endpoint_471",155.0],["/endpoint_817",127.0],["/endpoint_25",86.0],["/endpoint_758",100.0],["/endpoint_21",112.0],["/endpoint_941",72.0],["/endpoint_347",121.0],["/endpoint_29",98.0],["/endpoint_798",102.0],["/endpoint_47",80.0],["/endpoint_530",100.0],["/endpoint_170",104.0],["/endpoint_822",108.0],["/endpoint_952",76.0],["/endpoint_538",86.0],["/endpoint_408",110.0],["/endpoint_624",96.0],["/endpoint_318",120.0],["/endpoint_949",101.0],["/endpoint_578",112.0],["/endpoint_765",101.0],["/endpoint_769",120.0],["/endpoint_981",102.0],["/endpoint_314",92.0],["/endpoint_501",135.0],["/endpoint_152",77.0],["/endpoint_750",70.0],["/endpoint_156",78.0],["/endpoint_07",80.0],["/endpoint_50",106.0],["/endpoint_134",85.0],["/endpoint_219",140.0],["/endpoint_54",99.0],["/endpoint_58",83.0],["/endpoint_440",107.0],["/endpoint_790",106.0],["/endpoint_888",98.0],["/endpoint_387",108.0],["/endpoint_862",114.0],["/endpoint_383",158.0],["/endpoint_729",92.0],["/endpoint_224",122.0],["/endpoint_130",82.0],["/endpoint_589",84.0],["/endpoint_220",76.0],["/endpoint_592",52.0],["/endpoint_773",128.0],["/endpoint_777",100.0],["/endpoint_562",78.0],["/endpoint_540",83.0],["/endpoint_672",74.0],["/endpoint_485",96.0],["/endpoint_944",97.0],["/endpoint_368",80.0],["/endpoint_377",96.0],["/endpoint_588",120.0],["/endpoint_364",68.0],["/endpoint_122",92.0],["/endpoint_360",118.0],["/endpoint_566",114.0],["/endpoint_629",112.0],["/endpoint_962",96.0],["/endpoint_782",130.0],["/endpoint_805",120.0],["/endpoint_95",136.0],["/endpoint_287",103.0],["/endpoint_801",92.0],["/endpoint_478",99.0],["/endpoint_73",78.0],["/endpoint_993",80.0],["/endpoint_391",114.0],["/endpoint_395",84.0],["/endpoint_481",131.0],["/endpoint_399",118.0],["/endpoint_254",102.0],["/endpoint_786",128.0],["/endpoint_179",97.0],["/endpoint_661",120.0],["/endpoint_971",88.0],["/endpoint_984",116.0],["/endpoint_197",109.0],["/endpoint_957",134.0],["/endpoint_669",124.0],["/endpoint_333",62.0],["/endpoint_162",73.0],["/endpoint_496",96.0],["/endpoint_621",101.0],["/endpoint_467",108.0],["/endpoint_77",88.0],["/endpoint_214",97.0],["/endpoint_373",107.0],["/endpoint_434",96.0],["/endpoint_878",58.0],["/endpoint_504",98.0],["/endpoint_975",92.0],["/endpoint_320",76.0],["/endpoint_870",84.0],["/endpoint_874",102.0],["/endpoint_908",96.0],["/endpoint_401",130.0],["/endpoint_405",72.0],["/endpoint_979",92.0],["/endpoint_243",108.0],["/endpoint_247",100.0],["/endpoint_324",104.0],["/endpoint_892",93.0],["/endpoint_610",82.0],["/endpoint_647",105.0],["/endpoint_166",100.0],["/endpoint_614",94.0],["/endpoint_603",146.0],["/endpoint_997",146.0],["/endpoint_889",85.0],["/endpoint_676",116.0],["/endpoint_188",97.0],["/endpoint_175",119.0],["/endpoint_37",83.0],["/endpoint_68",100.0],["/endpoint_359",86.0],["/endpoint_108",94.0],["/endpoint_522",72.0],["/endpoint_342",92.0],["/endpoint_64",148.0],["/endpoint_607",108.0],["/endpoint_91",80.0],["/endpoint_526",120.0],["/endpoint_430",112.0],["/endpoint_863",134.0],["/endpoint_867",118.0],["/endpoint_441",101.0],["/endpoint_283",75.0],["/endpoint_276",122.0],["/endpoint_423",132.0],["/endpoint_900",110.0],["/endpoint_665",110.0],["/endpoint_768",142.0],["/endpoint_184",92.0],["/endpoint_746",112.0],["/endpoint_593",108.0],["/endpoint_742",123.0],["/endpoint_830",89.0],["/endpoint_452",92.0],["/endpoint_193",76.0],["/endpoint_456",80.0],["/endpoint_337",96.0],["/endpoint_966",64.0],["/endpoint_724",102.0],["/endpoint_720",82.0],["/endpoint_315",158.0],["/endpoint_463",121.0],["/endpoint_571",80.0],["/endpoint_535",88.0],["/endpoint_298",140.0],["/endpoint_445",74.0],["/endpoint_117",89.0],["/endpoint_99",106.0],["/endpoint_760",106.0],["/endpoint_809",124.0],["/endpoint_856",83.0],["/endpoint_19",94.0],["/endpoint_355",103.0],["/endpoint_15",89.0],["/endpoint_759",111.0],["/endpoint_11",68.0],["/endpoint_838",107.0],["/endpoint_654",93.0],["/endpoint_917",68.0],["/endpoint_265",92.0],["/endpoint_913",86.0],["/endpoint_849",56.0],["/endpoint_896",106.0],["/endpoint_500",78.0],["/endpoint_508",89.0],["/endpoint_755",152.0],["/endpoint_597",146.0],["/endpoint_346",96.0],["/endpoint_207",136.0],["/endpoint_203",81.0],["/endpoint_544",109.0],["/endpoint_737",84.0],["/endpoint_492",72.0],["/endpoint_690",102.0],["/endpoint_733",78.0],["/endpoint_02",60.0],["/endpoint_86",90.0],["/endpoint_290",97.0],["/endpoint_82",106.0],["/endpoint_294",89.0],["/endpoint_328",98.0],["/endpoint_531",126.0],["/endpoint_126",75.0],["/endpoint_711",85.0],["/endpoint_841",75.0],["/endpoint_557",104.0],["/endpoint_845",81.0],["/endpoint_258",81.0],["/endpoint_683",64.0],["/endpoint_427",96.0],["/endpoint_687",92.0],["/endpoint_113",92.0],["/endpoint_180",120.0],["/endpoint_922",112.0],["/endpoint_489",102.0],["/endpoint_926",96.0],["/endpoint_131",108.0],["/endpoint_618",110.0],["/endpoint_513",88.0],["/endpoint_579",118.0],["/endpoint_517",66.0],["/endpoint_412",77.0],["/endpoint_232",72.0],["/endpoint_728",108.0],["/endpoint_812",114.0],["/endpoint_236",92.0],["/endpoint_698",92.0],["/endpoint_702",88.0],["/endpoint_706",62.0],["/endpoint_548",82.0],["/endpoint_438",48.0],["/endpoint_416",78.0],["/endpoint_250",80.0],["/endpoint_139",82.0],["/endpoint_852",109.0],["/endpoint_272",92.0],["/endpoint_939",116.0],["/endpoint_580",106.0],["/endpoint_302",92.0],["/endpoint_935",104.0],["/endpoint_269",97.0],["/endpoint_931",110.0],["/endpoint_834",104.0],["/endpoint_449",100.0],["/endpoint_795",108.0],["/endpoint_636",88.0],["/endpoint_904",99.0],["/endpoint_632",117.0],["/endpoint_885",134.0],["/endpoint_584",97.0],["/endpoint_715",66.0],["/endpoint_658",118.0],["/endpoint_474",118.0],["/endpoint_60",100.0],["/endpoint_306",88.0],["/endpoint_719",124.0],["/endpoint_694",116.0],["/endpoint_140",78.0],["/endpoint_575",111.0],["/endpoint_144",112.0],["/endpoint_104",94.0],["/endpoint_148",115.0],["/endpoint_553",113.0],["/endpoint_46",83.0],["/endpoint_470",112.0],["/endpoint_24",105.0],["/endpoint_351",115.0],["/endpoint_20",82.0],["/endpoint_261",77.0],["/endpoint_940",122.0],["/endpoint_28",137.0],["/endpoint_988",100.0],["/endpoint_100",145.0],["/endpoint_827",104.0],["/endpoint_823",100.0],["/endpoint_171",106.0],["/endpoint_539",124.0],["/endpoint_816",98.0],["/endpoint_625",107.0],["/endpoint_382",114.0],["/endpoint_319",118.0],["/endpoint_218",102.0],["/endpoint_764",88.0],["/endpoint_948",102.0],["/endpoint_210",102.0],["/endpoint_311",108.0],["/endpoint_799",72.0],["/endpoint_643",86.0],["/endpoint_980",90.0],["/endpoint_153",117.0],["/endpoint_953",70.0],["/endpoint_157",88.0],["/endpoint_881",82.0],["/endpoint_409",81.0],["/endpoint_751",104.0],["/endpoint_51",79.0],["/endpoint_55",150.0],["/endpoint_42",85.0],["/endpoint_135",88.0],["/endpoint_59",126.0],["/endpoint_791",60.0],["/endpoint_221",82.0],["/endpoint_386",101.0],["/endpoint_229",87.0],["/endpoint_225",102.0],["/endpoint_33",125.0],["/endpoint_06",76.0],["/endpoint_650",88.0],["/endpoint_918",86.0],["/endpoint_770",106.0],["/endpoint_323",130.0],["/endpoint_378",109.0],["/endpoint_774",122.0],["/endpoint_671",92.0],["/endpoint_679",136.0],["/endpoint_675",116.0],["/endpoint_886",72.0],["/endpoint_947",116.0],["/endpoint_712",70.0],["/endpoint_837",94.0],["/endpoint_367",151.0],["/endpoint_374",90.0],["/endpoint_363",100.0],["/endpoint_965",108.0],["/endpoint_532",78.0],["/endpoint_125",72.0],["/endpoint_565",100.0],["/endpoint_961",105.0],["/endpoint_648",78.0],["/endpoint_806",111.0],["/endpoint_781",111.0],["/endpoint_802",113.0],["/endpoint_392",128.0],["/endpoint_370",82.0],["/endpoint_396",128.0],["/endpoint_499",83.0],["/endpoint_253",89.0],["/endpoint_569",144.0],["/endpoint_257",81.0],["/endpoint_666",114.0],["/endpoint_785",120.0],["/endpoint_662",96.0],["/endpoint_536",64.0],["/endpoint_987",82.0],["/endpoint_983",102.0],["/endpoint_327",165.0],["/endpoint_819",146.0],["/endpoint_486",144.0],["/endpoint_78",104.0],["/endpoint_74",81.0],["/endpoint_576",82.0],["/endpoint_70",140.0],["/endpoint_972",132.0],["/endpoint_49",82.0],["/endpoint_976",108.0],["/endpoint_194",116.0],["/endpoint_954",101.0],["/endpoint_873",100.0],["/endpoint_882",94.0],["/endpoint_129",94.0],["/endpoint_877",104.0],["/endpoint_279",72.0],["/endpoint_604",121.0],["/endpoint_248",96.0],["/endpoint_626",92.0],["/endpoint_406",84.0],["/endpoint_240",109.0],["/endpoint_30",82.0],["/endpoint_244",101.0],["/endpoint_613",119.0],["/endpoint_81",92.0],["/endpoint_183",104.0],["/endpoint_994",98.0],["/endpoint_239",124.0],["/endpoint_217",100.0],["/endpoint_990",56.0],["/endpoint_349",105.0],["/endpoint_482",117.0],["/endpoint_34",123.0],["/endpoint_587",90.0],["/endpoint_107",106.0],["/endpoint_543",112.0],["/endpoint_284",97.0],["/endpoint_103",108.0],["/endpoint_644",100.0],["/endpoint_165",118.0],["/endpoint_455",122.0],["/endpoint_341",127.0],["/endpoint_558",105.0],["/endpoint_860",88.0],["/endpoint_518",97.0],["/endpoint_161",92.0],["/endpoint_402",102.0],["/endpoint_864",132.0],["/endpoint_495",82.0],["/endpoint_275",131.0],["/endpoint_833",96.0],["/endpoint_749",72.0],["/endpoint_745",76.0],["/endpoint_727",86.0],["/endpoint_741",66.0],["/endpoint_451",91.0],["/endpoint_280",116.0],["/endpoint_521",103.0],["/endpoint_213",101.0],["/endpoint_459",74.0],["/endpoint_738",94.0],["/endpoint_842",112.0],["/endpoint_723",79.0],["/endpoint_420",96.0],["/endpoint_561",100.0],["/endpoint_198",69.0],["/endpoint_118",105.0],["/endpoint_590",114.0],["/endpoint_114",116.0],["/endpoint_446",112.0],["/endpoint_110",108.0],["/endpoint_190",60.0],["/endpoint_855",111.0],["/endpoint_477",76.0],["/endpoint_09",116.0],["/endpoint_851",100.0],["/endpoint_608",104.0],["/endpoint_16",58.0],["/endpoint_96",116.0],["/endpoint_859",104.0],["/endpoint_572",90.0],["/endpoint_914",137.0],["/endpoint_529",142.0],["/endpoint_266",99.0],["/endpoint_752",70.0],["/endpoint_05",122.0],["/endpoint_507",112.0],["/endpoint_204",68.0],["/endpoint_92",114.0],["/endpoint_200",98.0],["/endpoint_907",122.0],["/endpoint_734",134.0],["/endpoint_716",79.0],["/endpoint_208",120.0],["/endpoint_85",134.0],["/endpoint_969",90.0],["/endpoint_288",91.0],["/endpoint_316",116.0],["/endpoint_121",114.0],["/endpoint_297",130.0],["/endpoint_89",80.0],["/endpoint_688",78.0],["/endpoint_617",88.0],["/endpoint_846",89.0],["/endpoint_491",105.0],["/endpoint_01",111.0],["/endpoint_680",61.0],["/endpoint_415",72.0],["/endpoint_684",122.0],["/endpoint_622",126.0],["/endpoint_921",126.0],["/endpoint_293",109.0],["/endpoint_925",142.0],["/endpoint_828",88.0],["/endpoint_464",114.0],["/endpoint_929",100.0],["/endpoint_657",88.0],["/endpoint_514",96.0],["/endpoint_433",116.0],["/endpoint_554",84.0],["/endpoint_709",96.0],["/endpoint_442",104.0],["/endpoint_411",80.0],["/endpoint_235",88.0],["/endpoint_356",74.0],["/endpoint_424",96.0],["/endpoint_701",106.0],["/endpoint_958",95.0],["/endpoint_705",77.0],["/endpoint_594",97.0],["/endpoint_330",100.0],["/endpoint_132",123.0],["/endpoint_653",57.0],["/endpoint_334",108.0],["/endpoint_338",88.0],["/endpoint_510",89.0],["/endpoint_998",100.0],["/endpoint_811",80.0],["/endpoint_38",84.0],["/endpoint_169",88.0],["/endpoint_936",84.0],["/endpoint_583",82.0],["/endpoint_932",88.0],["/endpoint_525",96.0],["/endpoint_41",106.0],["/endpoint_419",90.0],["/endpoint_639",139.0],["/endpoint_635",125.0],["/endpoint_730",98.0],["/endpoint_693",124.0],["/endpoint_631",118.0],["/endpoint_903",76.0],["/endpoint_899",112.0],["/endpoint_309",116.0],["/endpoint_305",70.0],["/endpoint_231",112.0],["/endpoint_895",122.0],["/endpoint_460",89.0],["/endpoint_143",72.0],["/endpoint_12",139.0],["/endpoint_147",136.0],["/endpoint_1000",100.0],["/endpoint_271",110.0],["/endpoint_63",87.0],["/endpoint_697",105.0],["/endpoint_27",100.0],["/endpoint_891",120.0],["/endpoint_473",91.0],["/endpoint_23",74.0],["/endpoint_943",108.0],["/endpoint_262",118.0],["/endpoint_547",98.0],["/endpoint_824",144.0],["/endpoint_345",112.0],["/endpoint_820",92.0],["/endpoint_550",130.0],["/endpoint_222",90.0],["/endpoint_789",96.0],["/endpoint_187",84.0],["/endpoint_172",117.0],["/endpoint_437",73.0],["/endpoint_352",118.0],["/endpoint_763",84.0],["/endpoint_67",116.0],["/endpoint_301",78.0],["/endpoint_910",133.0],["/endpoint_767",112.0],["/endpoint_598",77.0],["/endpoint_312",67.0],["/endpoint_868",112.0],["/endpoint_640",96.0],["/endpoint_778",89.0],["/endpoint_150",94.0],["/endpoint_176",96.0],["/endpoint_154",92.0],["/endpoint_815",92.0],["/endpoint_158",148.0],["/endpoint_503",64.0],["/endpoint_468",80.0],["/endpoint_428",104.0],["/endpoint_52",120.0],["/endpoint_56",82.0],["/endpoint_796",108.0],["/endpoint_45",140.0],["/endpoint_136",114.0],["/endpoint_792",104.0],["/endpoint_950",100.0],["/endpoint_385",114.0],["/endpoint_756",144.0],["/endpoint_381",69.0],["/endpoint_600",148.0],["/endpoint_226",95.0],["/endpoint_389",102.0],["/endpoint_731",100.0],["/endpoint_678",156.0],["/endpoint_775",110.0],["/endpoint_44",97.0],["/endpoint_762",113.0],["/endpoint_670",120.0],["/endpoint_674",96.0],["/endpoint_48",92.0],["/endpoint_771",82.0],["/endpoint_601",88.0],["/endpoint_753",90.0],["/endpoint_366",86.0],["/endpoint_151",87.0],["/endpoint_362",72.0],["/endpoint_807",108.0],["/endpoint_964",110.0],["/endpoint_959",90.0],["/endpoint_960",137.0],["/endpoint_739",98.0],["/endpoint_803",116.0],["/endpoint_75",87.0],["/endpoint_393",100.0],["/endpoint_713",118.0],["/endpoint_410",72.0],["/endpoint_04",95.0],["/endpoint_252",101.0],["/endpoint_256",60.0],["/endpoint_779",86.0],["/endpoint_887",98.0],["/endpoint_649",101.0],["/endpoint_663",68.0],["/endpoint_168",104.0],["/endpoint_920",82.0],["/endpoint_986",76.0],["/endpoint_177",124.0],["/endpoint_973",126.0],["/endpoint_869",86.0],["/endpoint_498",69.0],["/endpoint_79",82.0],["/endpoint_487",96.0],["/endpoint_71",86.0],["/endpoint_483",102.0],["/endpoint_623",92.0],["/endpoint_821",122.0],["/endpoint_97",124.0],["/endpoint_977",102.0],["/endpoint_285",88.0],["/endpoint_502",70.0],["/endpoint_872",118.0],["/endpoint_722",122.0],["/endpoint_876",97.0],["/endpoint_403",98.0],["/endpoint_407",106.0],["/endpoint_627",107.0],["/endpoint_942",121.0],["/endpoint_245",79.0],["/endpoint_902",102.0],["/endpoint_186",82.0],["/endpoint_612",90.0],["/endpoint_195",126.0],["/endpoint_999",72.0],["/endpoint_995",116.0],["/endpoint_142",90.0],["/endpoint_278",112.0],["/endpoint_605",132.0],["/endpoint_991",102.0],["/endpoint_450",96.0],["/endpoint_465",72.0],["/endpoint_577",82.0],["/endpoint_586",92.0],["/endpoint_62",105.0],["/endpoint_66",72.0],["/endpoint_249",91.0],["/endpoint_120",114.0],["/endpoint_238",90.0],["/endpoint_212",116.0],["/endpoint_836",108.0],["/endpoint_865",124.0],["/endpoint_00",100.0],["/endpoint_906",70.0],["/endpoint_308",115.0],["/endpoint_748",131.0],["/endpoint_379",90.0],["/endpoint_744",89.0],["/endpoint_890",116.0],["/endpoint_645",112.0],["/endpoint_740",96.0],["/endpoint_164",88.0],["/endpoint_506",114.0],["/endpoint_388",95.0],["/endpoint_216",125.0],["/endpoint_340",121.0],["/endpoint_454",90.0],["/endpoint_458",80.0],["/endpoint_788",119.0],["/endpoint_494",104.0],["/endpoint_199",98.0],["/endpoint_124",94.0],["/endpoint_843",84.0],["/endpoint_296",116.0],["/endpoint_119",122.0],["/endpoint_115",75.0],["/endpoint_814",114.0],["/endpoint_93",93.0],["/endpoint_111",102.0],["/endpoint_854",90.0],["/endpoint_357",88.0],["/endpoint_641",108.0],["/endpoint_850",70.0],["/endpoint_17",60.0],["/endpoint_858",96.0],["/endpoint_560",116.0],["/endpoint_911",100.0],["/endpoint_915",126.0],["/endpoint_421",114.0],["/endpoint_591",108.0],["/endpoint_267",136.0],["/endpoint_418",105.0],["/endpoint_137",92.0],["/endpoint_528",92.0],["/endpoint_616",125.0],["/endpoint_191",104.0],["/endpoint_919",120.0],["/endpoint_757",102.0],["/endpoint_476",79.0],["/endpoint_205",86.0],["/endpoint_832",88.0],["/endpoint_201",73.0],["/endpoint_353",126.0],["/endpoint_461",68.0],["/endpoint_573",120.0],["/endpoint_524",73.0],["/endpoint_209",114.0],["/endpoint_537",82.0],["/endpoint_322",101.0],["/endpoint_80",113.0],["/endpoint_968",68.0],["/endpoint_281",86.0],["/endpoint_692",100.0],["/endpoint_689",96.0],["/endpoint_810",108.0],["/endpoint_274",100.0],["/endpoint_847",70.0],["/endpoint_609",85.0],["/endpoint_681",118.0],["/endpoint_656",92.0],["/endpoint_685",116.0],["/endpoint_375",118.0],["/endpoint_519",108.0],["/endpoint_894",121.0],["/endpoint_317",122.0],["/endpoint_924",86.0],["/endpoint_160",82.0],["/endpoint_928",96.0],["/endpoint_344",106.0],["/endpoint_515",80.0],["/endpoint_708",116.0],["/endpoint_861",113.0],["/endpoint_490",141.0],["/endpoint_234",64.0],["/endpoint_883",86.0],["/endpoint_700",81.0],["/endpoint_292",90.0],["/endpoint_704",116.0],["/endpoint_241",108.0],["/endpoint_331",80.0],["/endpoint_829",112.0],["/endpoint_335",110.0],["/endpoint_339",66.0],["/endpoint_432",106.0],["/endpoint_555",93.0],["/endpoint_227",93.0],["/endpoint_88",104.0],["/endpoint_159",90.0],["/endpoint_551",95.0],["/endpoint_39",80.0],["/endpoint_582",136.0],["/endpoint_955",92.0],["/endpoint_520",106.0],["/endpoint_425",89.0],["/endpoint_564",126.0],["/endpoint_35",117.0],["/endpoint_937",96.0],["/endpoint_182",134.0],["/endpoint_595",76.0],["/endpoint_933",82.0],["/endpoint_326",91.0],["/endpoint_133",137.0],["/endpoint_348",102.0],["/endpoint_638",130.0],["/endpoint_696",90.0],["/endpoint_634",101.0],["/endpoint_630",82.0],["/endpoint_447",117.0],["/endpoint_898",107.0],["/endpoint_429",77.0],["/endpoint_542",103.0],["/endpoint_735",116.0],["/endpoint_304",108.0],["/endpoint_300",91.0],["/endpoint_414",108.0],["/endpoint_667",93.0],["/endpoint_951",112.0],["/endpoint_146",90.0],["/endpoint_13",71.0],["/endpoint_270",84.0],["/endpoint_106",91.0],["/endpoint_652",91.0],["/endpoint_22",100.0],["/endpoint_371",112.0],["/endpoint_472",84.0],["/endpoint_946",94.0],["/endpoint_128",110.0],["/endpoint_825",106.0],["/endpoint_784",104.0],["/endpoint_511",98.0],["/endpoint_230",85.0],["/endpoint_102",116.0],["/endpoint_717",76.0],["/endpoint_436",84.0],["/endpoint_08",124.0],["/endpoint_40",109.0],["/endpoint_173",105.0],["/endpoint_766",110.0],["/endpoint_313",100.0],["/endpoint_546",82.0],["/endpoint_559",124.0],["/endpoint_26",90.0],["/endpoint_31",96.0],["/endpoint_155",124.0],["/endpoint_443",64.0],["/endpoint_982",128.0],["/endpoint_780",82.0],["/endpoint_568",116.0],["/endpoint_53",118.0],["/endpoint_599",97.0],["/endpoint_57",104.0],["/endpoint_797",104.0],["/endpoint_533",103.0],["/endpoint_793",68.0],["/endpoint_289",128.0],["/endpoint_384",76.0],["/endpoint_263",72.0],["/endpoint_726",91.0],["/endpoint_380",90.0],["/endpoint_84",121.0],["/endpoint_397",80.0],["/endpoint_818",107.0],["/endpoint_469",76.0]],"arguments":{},"schema":[{"type":"string","name":"endpoint"},{"type":"bigint","name":"num_hits"}],"overflow":true,"aggData":[["/endpoint_00",100.0],["/endpoint_01",111.0],["/endpoint_02",60.0],["/endpoint_03",112.0],["/endpoint_04",95.0],["/endpoint_05",122.0],["/endpoint_06",76.0],["/endpoint_07",80.0],["/endpoint_08",124.0],["/endpoint_09",116.0],["/endpoint_10",136.0],["/endpoint_100",145.0],["/endpoint_1000",100.0],["/endpoint_101",109.0],["/endpoint_102",116.0],["/endpoint_103",108.0],["/endpoint_104",94.0],["/endpoint_105",108.0],["/endpoint_106",91.0],["/endpoint_107",106.0],["/endpoint_108",94.0],["/endpoint_109",99.0],["/endpoint_11",68.0],["/endpoint_110",108.0],["/endpoint_111",102.0],["/endpoint_112",113.0],["/endpoint_113",92.0],["/endpoint_114",116.0],["/endpoint_115",75.0],["/endpoint_116",97.0],["/endpoint_117",89.0],["/endpoint_118",105.0],["/endpoint_119",122.0],["/endpoint_12",139.0],["/endpoint_120",114.0],["/endpoint_121",114.0],["/endpoint_122",92.0],["/endpoint_123",100.0],["/endpoint_124",94.0],["/endpoint_125",72.0],["/endpoint_126",75.0],["/endpoint_127",111.0],["/endpoint_128",110.0],["/endpoint_129",94.0],["/endpoint_13",71.0],["/endpoint_130",82.0],["/endpoint_131",108.0],["/endpoint_132",123.0],["/endpoint_133",137.0],["/endpoint_134",85.0],["/endpoint_135",88.0],["/endpoint_136",114.0],["/endpoint_137",92.0],["/endpoint_138",93.0],["/endpoint_139",82.0],["/endpoint_14",104.0],["/endpoint_140",78.0],["/endpoint_141",102.0],["/endpoint_142",90.0],["/endpoint_143",72.0],["/endpoint_144",112.0],["/endpoint_145",72.0],["/endpoint_146",90.0],["/endpoint_147",136.0],["/endpoint_148",115.0],["/endpoint_149",100.0],["/endpoint_15",89.0],["/endpoint_150",94.0],["/endpoint_151",87.0],["/endpoint_152",77.0],["/endpoint_153",117.0],["/endpoint_154",92.0],["/endpoint_155",124.0],["/endpoint_156",78.0],["/endpoint_157",88.0],["/endpoint_158",148.0],["/endpoint_159",90.0],["/endpoint_16",58.0],["/endpoint_160",82.0],["/endpoint_161",92.0],["/endpoint_162",73.0],["/endpoint_163",112.0],["/endpoint_164",88.0],["/endpoint_165",118.0],["/endpoint_166",100.0],["/endpoint_167",82.0],["/endpoint_168",104.0],["/endpoint_169",88.0],["/endpoint_17",60.0],["/endpoint_170",104.0],["/endpoint_171",106.0],["/endpoint_172",117.0],["/endpoint_173",105.0],["/endpoint_174",84.0],["/endpoint_175",119.0],["/endpoint_176",96.0],["/endpoint_177",124.0],["/endpoint_178",100.0],["/endpoint_179",97.0],["/endpoint_18",94.0],["/endpoint_180",120.0],["/endpoint_181",112.0],["/endpoint_182",134.0],["/endpoint_183",104.0],["/endpoint_184",92.0],["/endpoint_185",132.0],["/endpoint_186",82.0],["/endpoint_187",84.0],["/endpoint_188",97.0],["/endpoint_189",96.0],["/endpoint_19",94.0],["/endpoint_190",60.0],["/endpoint_191",104.0],["/endpoint_192",96.0],["/endpoint_193",76.0],["/endpoint_194",116.0],["/endpoint_195",126.0],["/endpoint_196",90.0],["/endpoint_197",109.0],["/endpoint_198",69.0],["/endpoint_199",98.0],["/endpoint_20",82.0],["/endpoint_200",98.0],["/endpoint_201",73.0],["/endpoint_202",62.0],["/endpoint_203",81.0],["/endpoint_204",68.0],["/endpoint_205",86.0],["/endpoint_206",74.0],["/endpoint_207",136.0],["/endpoint_208",120.0],["/endpoint_209",114.0],["/endpoint_21",112.0],["/endpoint_210",102.0],["/endpoint_211",105.0],["/endpoint_212",116.0],["/endpoint_213",101.0],["/endpoint_214",97.0],["/endpoint_215",116.0],["/endpoint_216",125.0],["/endpoint_217",100.0],["/endpoint_218",102.0],["/endpoint_219",140.0],["/endpoint_22",100.0],["/endpoint_220",76.0],["/endpoint_221",82.0],["/endpoint_222",90.0],["/endpoint_223",92.0],["/endpoint_224",122.0],["/endpoint_225",102.0],["/endpoint_226",95.0],["/endpoint_227",93.0],["/endpoint_228",93.0],["/endpoint_229",87.0],["/endpoint_23",74.0],["/endpoint_230",85.0],["/endpoint_231",112.0],["/endpoint_232",72.0],["/endpoint_233",80.0],["/endpoint_234",64.0],["/endpoint_235",88.0],["/endpoint_236",92.0],["/endpoint_237",134.0],["/endpoint_238",90.0],["/endpoint_239",124.0],["/endpoint_24",105.0],["/endpoint_240",109.0],["/endpoint_241",108.0],["/endpoint_242",112.0],["/endpoint_243",108.0],["/endpoint_244",101.0],["/endpoint_245",79.0],["/endpoint_246",76.0],["/endpoint_247",100.0],["/endpoint_248",96.0],["/endpoint_249",91.0],["/endpoint_25",86.0],["/endpoint_250",80.0],["/endpoint_251",92.0],["/endpoint_252",101.0],["/endpoint_253",89.0],["/endpoint_254",102.0],["/endpoint_255",100.0],["/endpoint_256",60.0],["/endpoint_257",81.0],["/endpoint_258",81.0],["/endpoint_259",72.0],["/endpoint_26",90.0],["/endpoint_260",93.0],["/endpoint_261",77.0],["/endpoint_262",118.0],["/endpoint_263",72.0],["/endpoint_264",105.0],["/endpoint_265",92.0],["/endpoint_266",99.0],["/endpoint_267",136.0],["/endpoint_268",112.0],["/endpoint_269",97.0],["/endpoint_27",100.0],["/endpoint_270",84.0],["/endpoint_271",110.0],["/endpoint_272",92.0],["/endpoint_273",98.0],["/endpoint_274",100.0],["/endpoint_275",131.0],["/endpoint_276",122.0],["/endpoint_277",132.0],["/endpoint_278",112.0],["/endpoint_279",72.0],["/endpoint_28",137.0],["/endpoint_280",116.0],["/endpoint_281",86.0],["/endpoint_282",90.0],["/endpoint_283",75.0],["/endpoint_284",97.0],["/endpoint_285",88.0],["/endpoint_286",125.0],["/endpoint_287",103.0],["/endpoint_288",91.0],["/endpoint_289",128.0],["/endpoint_29",98.0],["/endpoint_290",97.0],["/endpoint_291",76.0],["/endpoint_292",90.0],["/endpoint_293",109.0],["/endpoint_294",89.0],["/endpoint_295",127.0],["/endpoint_296",116.0],["/endpoint_297",130.0],["/endpoint_298",140.0],["/endpoint_299",109.0],["/endpoint_30",82.0],["/endpoint_300",91.0],["/endpoint_301",78.0],["/endpoint_302",92.0],["/endpoint_303",111.0],["/endpoint_304",108.0],["/endpoint_305",70.0],["/endpoint_306",88.0],["/endpoint_307",141.0],["/endpoint_308",115.0],["/endpoint_309",116.0],["/endpoint_31",96.0],["/endpoint_310",96.0],["/endpoint_311",108.0],["/endpoint_312",67.0],["/endpoint_313",100.0],["/endpoint_314",92.0],["/endpoint_315",158.0],["/endpoint_316",116.0],["/endpoint_317",122.0],["/endpoint_318",120.0],["/endpoint_319",118.0],["/endpoint_32",144.0],["/endpoint_320",76.0],["/endpoint_321",89.0],["/endpoint_322",101.0],["/endpoint_323",130.0],["/endpoint_324",104.0],["/endpoint_325",92.0],["/endpoint_326",91.0],["/endpoint_327",165.0],["/endpoint_328",98.0],["/endpoint_329",80.0],["/endpoint_33",125.0],["/endpoint_330",100.0],["/endpoint_331",80.0],["/endpoint_332",100.0],["/endpoint_333",62.0],["/endpoint_334",108.0],["/endpoint_335",110.0],["/endpoint_336",89.0],["/endpoint_337",96.0],["/endpoint_338",88.0],["/endpoint_339",66.0],["/endpoint_34",123.0],["/endpoint_340",121.0],["/endpoint_341",127.0],["/endpoint_342",92.0],["/endpoint_343",86.0],["/endpoint_344",106.0],["/endpoint_345",112.0],["/endpoint_346",96.0],["/endpoint_347",121.0],["/endpoint_348",102.0],["/endpoint_349",105.0],["/endpoint_35",117.0],["/endpoint_350",81.0],["/endpoint_351",115.0],["/endpoint_352",118.0],["/endpoint_353",126.0],["/endpoint_354",89.0],["/endpoint_355",103.0],["/endpoint_356",74.0],["/endpoint_357",88.0],["/endpoint_358",98.0],["/endpoint_359",86.0],["/endpoint_36",85.0],["/endpoint_360",118.0],["/endpoint_361",108.0],["/endpoint_362",72.0],["/endpoint_363",100.0],["/endpoint_364",68.0],["/endpoint_365",100.0],["/endpoint_366",86.0],["/endpoint_367",151.0],["/endpoint_368",80.0],["/endpoint_369",121.0],["/endpoint_37",83.0],["/endpoint_370",82.0],["/endpoint_371",112.0],["/endpoint_372",76.0],["/endpoint_373",107.0],["/endpoint_374",90.0],["/endpoint_375",118.0],["/endpoint_376",86.0],["/endpoint_377",96.0],["/endpoint_378",109.0],["/endpoint_379",90.0],["/endpoint_38",84.0],["/endpoint_380",90.0],["/endpoint_381",69.0],["/endpoint_382",114.0],["/endpoint_383",158.0],["/endpoint_384",76.0],["/endpoint_385",114.0],["/endpoint_386",101.0],["/endpoint_387",108.0],["/endpoint_388",95.0],["/endpoint_389",102.0],["/endpoint_39",80.0],["/endpoint_390",82.0],["/endpoint_391",114.0],["/endpoint_392",128.0],["/endpoint_393",100.0],["/endpoint_394",108.0],["/endpoint_395",84.0],["/endpoint_396",128.0],["/endpoint_397",80.0],["/endpoint_398",104.0],["/endpoint_399",118.0],["/endpoint_40",109.0],["/endpoint_400",113.0],["/endpoint_401",130.0],["/endpoint_402",102.0],["/endpoint_403",98.0],["/endpoint_404",123.0],["/endpoint_405",72.0],["/endpoint_406",84.0],["/endpoint_407",106.0],["/endpoint_408",110.0],["/endpoint_409",81.0],["/endpoint_41",106.0],["/endpoint_410",72.0],["/endpoint_411",80.0],["/endpoint_412",77.0],["/endpoint_413",84.0],["/endpoint_414",108.0],["/endpoint_415",72.0],["/endpoint_416",78.0],["/endpoint_417",95.0],["/endpoint_418",105.0],["/endpoint_419",90.0],["/endpoint_42",85.0],["/endpoint_420",96.0],["/endpoint_421",114.0],["/endpoint_422",122.0],["/endpoint_423",132.0],["/endpoint_424",96.0],["/endpoint_425",89.0],["/endpoint_426",92.0],["/endpoint_427",96.0],["/endpoint_428",104.0],["/endpoint_429",77.0],["/endpoint_43",97.0],["/endpoint_430",112.0],["/endpoint_431",72.0],["/endpoint_432",106.0],["/endpoint_433",116.0],["/endpoint_434",96.0],["/endpoint_435",84.0],["/endpoint_436",84.0],["/endpoint_437",73.0],["/endpoint_438",48.0],["/endpoint_439",118.0],["/endpoint_44",97.0],["/endpoint_440",107.0],["/endpoint_441",101.0],["/endpoint_442",104.0],["/endpoint_443",64.0],["/endpoint_444",123.0],["/endpoint_445",74.0],["/endpoint_446",112.0],["/endpoint_447",117.0],["/endpoint_448",63.0],["/endpoint_449",100.0],["/endpoint_45",140.0],["/endpoint_450",96.0],["/endpoint_451",91.0],["/endpoint_452",92.0],["/endpoint_453",84.0],["/endpoint_454",90.0],["/endpoint_455",122.0],["/endpoint_456",80.0],["/endpoint_457",96.0],["/endpoint_458",80.0],["/endpoint_459",74.0],["/endpoint_46",83.0],["/endpoint_460",89.0],["/endpoint_461",68.0],["/endpoint_462",80.0],["/endpoint_463",121.0],["/endpoint_464",114.0],["/endpoint_465",72.0],["/endpoint_466",72.0],["/endpoint_467",108.0],["/endpoint_468",80.0],["/endpoint_469",76.0],["/endpoint_47",80.0],["/endpoint_470",112.0],["/endpoint_471",155.0],["/endpoint_472",84.0],["/endpoint_473",91.0],["/endpoint_474",118.0],["/endpoint_475",81.0],["/endpoint_476",79.0],["/endpoint_477",76.0],["/endpoint_478",99.0],["/endpoint_479",120.0],["/endpoint_48",92.0],["/endpoint_480",92.0],["/endpoint_481",131.0],["/endpoint_482",117.0],["/endpoint_483",102.0],["/endpoint_484",68.0],["/endpoint_485",96.0],["/endpoint_486",144.0],["/endpoint_487",96.0],["/endpoint_488",100.0],["/endpoint_489",102.0],["/endpoint_49",82.0],["/endpoint_490",141.0],["/endpoint_491",105.0],["/endpoint_492",72.0],["/endpoint_493",96.0],["/endpoint_494",104.0],["/endpoint_495",82.0],["/endpoint_496",96.0],["/endpoint_497",106.0],["/endpoint_498",69.0],["/endpoint_499",83.0],["/endpoint_50",106.0],["/endpoint_500",78.0],["/endpoint_501",135.0],["/endpoint_502",70.0],["/endpoint_503",64.0],["/endpoint_504",98.0],["/endpoint_505",122.0],["/endpoint_506",114.0],["/endpoint_507",112.0],["/endpoint_508",89.0],["/endpoint_509",110.0],["/endpoint_51",79.0],["/endpoint_510",89.0],["/endpoint_511",98.0],["/endpoint_512",96.0],["/endpoint_513",88.0],["/endpoint_514",96.0],["/endpoint_515",80.0],["/endpoint_516",100.0],["/endpoint_517",66.0],["/endpoint_518",97.0],["/endpoint_519",108.0],["/endpoint_52",120.0],["/endpoint_520",106.0],["/endpoint_521",103.0],["/endpoint_522",72.0],["/endpoint_523",92.0],["/endpoint_524",73.0],["/endpoint_525",96.0],["/endpoint_526",120.0],["/endpoint_527",124.0],["/endpoint_528",92.0],["/endpoint_529",142.0],["/endpoint_53",118.0],["/endpoint_530",100.0],["/endpoint_531",126.0],["/endpoint_532",78.0],["/endpoint_533",103.0],["/endpoint_534",68.0],["/endpoint_535",88.0],["/endpoint_536",64.0],["/endpoint_537",82.0],["/endpoint_538",86.0],["/endpoint_539",124.0],["/endpoint_54",99.0],["/endpoint_540",83.0],["/endpoint_541",90.0],["/endpoint_542",103.0],["/endpoint_543",112.0],["/endpoint_544",109.0],["/endpoint_545",87.0],["/endpoint_546",82.0],["/endpoint_547",98.0],["/endpoint_548",82.0],["/endpoint_549",82.0],["/endpoint_55",150.0],["/endpoint_550",130.0],["/endpoint_551",95.0],["/endpoint_552",104.0],["/endpoint_553",113.0],["/endpoint_554",84.0],["/endpoint_555",93.0],["/endpoint_556",72.0],["/endpoint_557",104.0],["/endpoint_558",105.0],["/endpoint_559",124.0],["/endpoint_56",82.0],["/endpoint_560",116.0],["/endpoint_561",100.0],["/endpoint_562",78.0],["/endpoint_563",60.0],["/endpoint_564",126.0],["/endpoint_565",100.0],["/endpoint_566",114.0],["/endpoint_567",122.0],["/endpoint_568",116.0],["/endpoint_569",144.0],["/endpoint_57",104.0],["/endpoint_570",114.0],["/endpoint_571",80.0],["/endpoint_572",90.0],["/endpoint_573",120.0],["/endpoint_574",146.0],["/endpoint_575",111.0],["/endpoint_576",82.0],["/endpoint_577",82.0],["/endpoint_578",112.0],["/endpoint_579",118.0],["/endpoint_58",83.0],["/endpoint_580",106.0],["/endpoint_581",149.0],["/endpoint_582",136.0],["/endpoint_583",82.0],["/endpoint_584",97.0],["/endpoint_585",84.0],["/endpoint_586",92.0],["/endpoint_587",90.0],["/endpoint_588",120.0],["/endpoint_589",84.0],["/endpoint_59",126.0],["/endpoint_590",114.0],["/endpoint_591",108.0],["/endpoint_592",52.0],["/endpoint_593",108.0],["/endpoint_594",97.0],["/endpoint_595",76.0],["/endpoint_596",133.0],["/endpoint_597",146.0],["/endpoint_598",77.0],["/endpoint_599",97.0],["/endpoint_60",100.0],["/endpoint_600",148.0],["/endpoint_601",88.0],["/endpoint_602",52.0],["/endpoint_603",146.0],["/endpoint_604",121.0],["/endpoint_605",132.0],["/endpoint_606",98.0],["/endpoint_607",108.0],["/endpoint_608",104.0],["/endpoint_609",85.0],["/endpoint_61",86.0],["/endpoint_610",82.0],["/endpoint_611",104.0],["/endpoint_612",90.0],["/endpoint_613",119.0],["/endpoint_614",94.0],["/endpoint_615",100.0],["/endpoint_616",125.0],["/endpoint_617",88.0],["/endpoint_618",110.0],["/endpoint_619",116.0],["/endpoint_62",105.0],["/endpoint_620",76.0],["/endpoint_621",101.0],["/endpoint_622",126.0],["/endpoint_623",92.0],["/endpoint_624",96.0],["/endpoint_625",107.0],["/endpoint_626",92.0],["/endpoint_627",107.0],["/endpoint_628",116.0],["/endpoint_629",112.0],["/endpoint_63",87.0],["/endpoint_630",82.0],["/endpoint_631",118.0],["/endpoint_632",117.0],["/endpoint_633",84.0],["/endpoint_634",101.0],["/endpoint_635",125.0],["/endpoint_636",88.0],["/endpoint_637",156.0],["/endpoint_638",130.0],["/endpoint_639",139.0],["/endpoint_64",148.0],["/endpoint_640",96.0],["/endpoint_641",108.0],["/endpoint_642",108.0],["/endpoint_643",86.0],["/endpoint_644",100.0],["/endpoint_645",112.0],["/endpoint_646",78.0],["/endpoint_647",105.0],["/endpoint_648",78.0],["/endpoint_649",101.0],["/endpoint_65",99.0],["/endpoint_650",88.0],["/endpoint_651",113.0],["/endpoint_652",91.0],["/endpoint_653",57.0],["/endpoint_654",93.0],["/endpoint_655",92.0],["/endpoint_656",92.0],["/endpoint_657",88.0],["/endpoint_658",118.0],["/endpoint_659",96.0],["/endpoint_66",72.0],["/endpoint_660",102.0],["/endpoint_661",120.0],["/endpoint_662",96.0],["/endpoint_663",68.0],["/endpoint_664",130.0],["/endpoint_665",110.0],["/endpoint_666",114.0],["/endpoint_667",93.0],["/endpoint_668",110.0],["/endpoint_669",124.0],["/endpoint_67",116.0],["/endpoint_670",120.0],["/endpoint_671",92.0],["/endpoint_672",74.0],["/endpoint_673",102.0],["/endpoint_674",96.0],["/endpoint_675",116.0],["/endpoint_676",116.0],["/endpoint_677",69.0],["/endpoint_678",156.0],["/endpoint_679",136.0],["/endpoint_68",100.0],["/endpoint_680",61.0],["/endpoint_681",118.0],["/endpoint_682",102.0],["/endpoint_683",64.0],["/endpoint_684",122.0],["/endpoint_685",116.0],["/endpoint_686",84.0],["/endpoint_687",92.0],["/endpoint_688",78.0],["/endpoint_689",96.0],["/endpoint_69",97.0],["/endpoint_690",102.0],["/endpoint_691",74.0],["/endpoint_692",100.0],["/endpoint_693",124.0],["/endpoint_694",116.0],["/endpoint_695",74.0],["/endpoint_696",90.0],["/endpoint_697",105.0],["/endpoint_698",92.0],["/endpoint_699",72.0],["/endpoint_70",140.0],["/endpoint_700",81.0],["/endpoint_701",106.0],["/endpoint_702",88.0],["/endpoint_703",82.0],["/endpoint_704",116.0],["/endpoint_705",77.0],["/endpoint_706",62.0],["/endpoint_707",116.0],["/endpoint_708",116.0],["/endpoint_709",96.0],["/endpoint_71",86.0],["/endpoint_710",127.0],["/endpoint_711",85.0],["/endpoint_712",70.0],["/endpoint_713",118.0],["/endpoint_714",112.0],["/endpoint_715",66.0],["/endpoint_716",79.0],["/endpoint_717",76.0],["/endpoint_718",90.0],["/endpoint_719",124.0],["/endpoint_72",100.0],["/endpoint_720",82.0],["/endpoint_721",100.0],["/endpoint_722",122.0],["/endpoint_723",79.0],["/endpoint_724",102.0],["/endpoint_725",122.0],["/endpoint_726",91.0],["/endpoint_727",86.0],["/endpoint_728",108.0],["/endpoint_729",92.0],["/endpoint_73",78.0],["/endpoint_730",98.0],["/endpoint_731",100.0],["/endpoint_732",122.0],["/endpoint_733",78.0],["/endpoint_734",134.0],["/endpoint_735",116.0],["/endpoint_736",113.0],["/endpoint_737",84.0],["/endpoint_738",94.0],["/endpoint_739",98.0],["/endpoint_74",81.0],["/endpoint_740",96.0],["/endpoint_741",66.0],["/endpoint_742",123.0],["/endpoint_743",106.0],["/endpoint_744",89.0],["/endpoint_745",76.0],["/endpoint_746",112.0],["/endpoint_747",96.0],["/endpoint_748",131.0],["/endpoint_749",72.0],["/endpoint_75",87.0],["/endpoint_750",70.0],["/endpoint_751",104.0],["/endpoint_752",70.0],["/endpoint_753",90.0],["/endpoint_754",85.0],["/endpoint_755",152.0],["/endpoint_756",144.0],["/endpoint_757",102.0],["/endpoint_758",100.0],["/endpoint_759",111.0],["/endpoint_76",90.0],["/endpoint_760",106.0],["/endpoint_761",89.0],["/endpoint_762",113.0],["/endpoint_763",84.0],["/endpoint_764",88.0],["/endpoint_765",101.0],["/endpoint_766",110.0],["/endpoint_767",112.0],["/endpoint_768",142.0],["/endpoint_769",120.0],["/endpoint_77",88.0],["/endpoint_770",106.0],["/endpoint_771",82.0],["/endpoint_772",132.0],["/endpoint_773",128.0],["/endpoint_774",122.0],["/endpoint_775",110.0],["/endpoint_776",69.0],["/endpoint_777",100.0],["/endpoint_778",89.0],["/endpoint_779",86.0],["/endpoint_78",104.0],["/endpoint_780",82.0],["/endpoint_781",111.0],["/endpoint_782",130.0],["/endpoint_783",128.0],["/endpoint_784",104.0],["/endpoint_785",120.0],["/endpoint_786",128.0],["/endpoint_787",116.0],["/endpoint_788",119.0],["/endpoint_789",96.0],["/endpoint_79",82.0],["/endpoint_790",106.0],["/endpoint_791",60.0],["/endpoint_792",104.0],["/endpoint_793",68.0],["/endpoint_794",122.0],["/endpoint_795",108.0],["/endpoint_796",108.0],["/endpoint_797",104.0],["/endpoint_798",102.0],["/endpoint_799",72.0],["/endpoint_80",113.0],["/endpoint_800",90.0],["/endpoint_801",92.0],["/endpoint_802",113.0],["/endpoint_803",116.0],["/endpoint_804",77.0],["/endpoint_805",120.0],["/endpoint_806",111.0],["/endpoint_807",108.0],["/endpoint_808",104.0],["/endpoint_809",124.0],["/endpoint_81",92.0],["/endpoint_810",108.0],["/endpoint_811",80.0],["/endpoint_812",114.0],["/endpoint_813",88.0],["/endpoint_814",114.0],["/endpoint_815",92.0],["/endpoint_816",98.0],["/endpoint_817",127.0],["/endpoint_818",107.0],["/endpoint_819",146.0],["/endpoint_82",106.0],["/endpoint_820",92.0],["/endpoint_821",122.0],["/endpoint_822",108.0],["/endpoint_823",100.0],["/endpoint_824",144.0],["/endpoint_825",106.0],["/endpoint_826",96.0],["/endpoint_827",104.0],["/endpoint_828",88.0],["/endpoint_829",112.0],["/endpoint_83",109.0],["/endpoint_830",89.0],["/endpoint_831",61.0],["/endpoint_832",88.0],["/endpoint_833",96.0],["/endpoint_834",104.0],["/endpoint_835",92.0],["/endpoint_836",108.0],["/endpoint_837",94.0],["/endpoint_838",107.0],["/endpoint_839",90.0],["/endpoint_84",121.0],["/endpoint_840",94.0],["/endpoint_841",75.0],["/endpoint_842",112.0],["/endpoint_843",84.0],["/endpoint_844",77.0],["/endpoint_845",81.0],["/endpoint_846",89.0],["/endpoint_847",70.0],["/endpoint_848",138.0],["/endpoint_849",56.0],["/endpoint_85",134.0],["/endpoint_850",70.0],["/endpoint_851",100.0],["/endpoint_852",109.0],["/endpoint_853",100.0],["/endpoint_854",90.0],["/endpoint_855",111.0],["/endpoint_856",83.0],["/endpoint_857",108.0],["/endpoint_858",96.0],["/endpoint_859",104.0],["/endpoint_86",90.0],["/endpoint_860",88.0],["/endpoint_861",113.0],["/endpoint_862",114.0],["/endpoint_863",134.0],["/endpoint_864",132.0],["/endpoint_865",124.0],["/endpoint_866",96.0],["/endpoint_867",118.0],["/endpoint_868",112.0],["/endpoint_869",86.0],["/endpoint_87",132.0],["/endpoint_870",84.0],["/endpoint_871",94.0],["/endpoint_872",118.0],["/endpoint_873",100.0],["/endpoint_874",102.0],["/endpoint_875",98.0],["/endpoint_876",97.0],["/endpoint_877",104.0],["/endpoint_878",58.0],["/endpoint_879",96.0],["/endpoint_88",104.0],["/endpoint_880",78.0],["/endpoint_881",82.0],["/endpoint_882",94.0],["/endpoint_883",86.0],["/endpoint_884",130.0],["/endpoint_885",134.0],["/endpoint_886",72.0],["/endpoint_887",98.0],["/endpoint_888",98.0],["/endpoint_889",85.0],["/endpoint_89",80.0],["/endpoint_890",116.0],["/endpoint_891",120.0],["/endpoint_892",93.0],["/endpoint_893",70.0],["/endpoint_894",121.0],["/endpoint_895",122.0],["/endpoint_896",106.0],["/endpoint_897",89.0],["/endpoint_898",107.0],["/endpoint_899",112.0],["/endpoint_90",128.0],["/endpoint_900",110.0],["/endpoint_901",100.0],["/endpoint_902",102.0],["/endpoint_903",76.0],["/endpoint_904",99.0],["/endpoint_905",100.0],["/endpoint_906",70.0],["/endpoint_907",122.0],["/endpoint_908",96.0],["/endpoint_909",92.0],["/endpoint_91",80.0],["/endpoint_910",133.0],["/endpoint_911",100.0],["/endpoint_912",68.0],["/endpoint_913",86.0],["/endpoint_914",137.0],["/endpoint_915",126.0],["/endpoint_916",74.0],["/endpoint_917",68.0],["/endpoint_918",86.0],["/endpoint_919",120.0],["/endpoint_92",114.0],["/endpoint_920",82.0],["/endpoint_921",126.0],["/endpoint_922",112.0],["/endpoint_923",94.0],["/endpoint_924",86.0],["/endpoint_925",142.0],["/endpoint_926",96.0],["/endpoint_927",103.0],["/endpoint_928",96.0],["/endpoint_929",100.0],["/endpoint_93",93.0],["/endpoint_930",54.0],["/endpoint_931",110.0],["/endpoint_932",88.0],["/endpoint_933",82.0],["/endpoint_934",101.0],["/endpoint_935",104.0],["/endpoint_936",84.0],["/endpoint_937",96.0],["/endpoint_938",108.0],["/endpoint_939",116.0],["/endpoint_94",76.0],["/endpoint_940",122.0],["/endpoint_941",72.0],["/endpoint_942",121.0],["/endpoint_943",108.0],["/endpoint_944",97.0],["/endpoint_945",100.0],["/endpoint_946",94.0],["/endpoint_947",116.0],["/endpoint_948",102.0],["/endpoint_949",101.0],["/endpoint_95",136.0],["/endpoint_950",100.0],["/endpoint_951",112.0],["/endpoint_952",76.0],["/endpoint_953",70.0],["/endpoint_954",101.0],["/endpoint_955",92.0],["/endpoint_956",118.0],["/endpoint_957",134.0],["/endpoint_958",95.0],["/endpoint_959",90.0],["/endpoint_96",116.0],["/endpoint_960",137.0],["/endpoint_961",105.0],["/endpoint_962",96.0],["/endpoint_963",108.0],["/endpoint_964",110.0],["/endpoint_965",108.0],["/endpoint_966",64.0],["/endpoint_967",89.0],["/endpoint_968",68.0],["/endpoint_969",90.0],["/endpoint_97",124.0],["/endpoint_970",108.0],["/endpoint_971",88.0],["/endpoint_972",132.0],["/endpoint_973",126.0],["/endpoint_974",115.0],["/endpoint_975",92.0],["/endpoint_976",108.0],["/endpoint_977",102.0],["/endpoint_978",91.0],["/endpoint_979",92.0],["/endpoint_98",76.0],["/endpoint_980",90.0],["/endpoint_981",102.0],["/endpoint_982",128.0],["/endpoint_983",102.0],["/endpoint_984",116.0],["/endpoint_985",80.0],["/endpoint_986",76.0],["/endpoint_987",82.0],["/endpoint_988",100.0],["/endpoint_989",105.0],["/endpoint_99",106.0],["/endpoint_990",56.0],["/endpoint_991",102.0],["/endpoint_992",108.0],["/endpoint_993",80.0],["/endpoint_994",98.0],["/endpoint_995",116.0],["/endpoint_996",124.0],["/endpoint_997",146.0],["/endpoint_998",100.0]],"aggSchema":[{"type":"string","name":"endpoint"},{"type":"bigint","name":"num_hits"}],"aggOverflow":true,"aggSeriesLimitReached":false,"aggError":"","aggType":"scalar","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494428626E12,"submitTime":1.427494018462E12,"finishTime":1.42749442958E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["endpoint"],"yColumns":["num_hits"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"9a4520ea-53ed-49b5-8247-37112ab748cc"},{"version":"CommandV1","origId":3612,"guid":"b4a95a40-b27c-45a2-ab5b-3261a528f5f5","subtype":"script","commandType":"auto","position":4.783783783783784,"command":"# Drill down to the top endpoints.\ntop_endpoints_array = endpoint_counts_rdd.takeOrdered(10, lambda row: -1 * row.num_hits)\ntop_endpoints_dataframe = sqlContext.inferSchema(sc.parallelize(top_endpoints_array))\ndisplay(top_endpoints_dataframe)\n                            ","commandVersion":0,"state":"finished","results":{"type":"table","data":[["/endpoint_327",165.0],["/endpoint_383",158.0],["/endpoint_315",158.0],["/endpoint_637",156.0],["/endpoint_678",156.0],["/endpoint_471",155.0],["/endpoint_755",152.0],["/endpoint_367",151.0],["/endpoint_55",150.0],["/endpoint_581",149.0]],"arguments":{},"schema":[{"type":"string","name":"endpoint"},{"type":"bigint","name":"num_hits"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494429596E12,"submitTime":1.427494035121E12,"finishTime":1.427494430098E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"03c13d33-2b8b-498f-9e84-1c967cbe50f4"},{"version":"CommandV1","origId":3613,"guid":"1a950963-cf25-4647-9266-bce6bd48db80","subtype":"script","commandType":"auto","position":4.8108108108108105,"command":"%md\n\n#### **Extra: Use SQL in a Python Notebook**\n* A dataframe can registered as a temporary SQL Table.\n* Then you can do SQL queries against the data in sql cells in this Python notebook.\n* Results from select statements is SQL are automatically displayed.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"#### **Extra: Use SQL in a Python Notebook**\n* A dataframe can registered as a temporary SQL Table.\n* Then you can do SQL queries against the data in sql cells in this Python notebook.\n* Results from select statements is SQL are automatically displayed.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494430103E12,"submitTime":1.427494044404E12,"finishTime":1.427494430109E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"37be2aae-5c94-4ff3-ba59-c8afa1783ea6"},{"version":"CommandV1","origId":3614,"guid":"5a4308ba-d38b-49e7-8cc7-47d17d082391","subtype":"script","commandType":"auto","position":4.837837837837838,"command":"# Create a Schema RDD from the rdd of Row's.\naccess_logs_dataframe = sqlContext.inferSchema(access_logs)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494430114E12,"submitTime":1.42749405133E12,"finishTime":1.427494430242E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"9da63114-c9d1-48fd-892b-9efcb6407c06"},{"version":"CommandV1","origId":3615,"guid":"906c9a97-cc71-481d-98dd-12458575a4f7","subtype":"script","commandType":"auto","position":4.864864864864865,"command":"%sql DROP TABLE IF EXISTS SQLApacheAccessLogsTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494430247E12,"submitTime":1.427494066188E12,"finishTime":1.427494430943E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"58a4e583-ae03-4869-b770-0f1c509ab3a0"},{"version":"CommandV1","origId":3616,"guid":"dc1c759d-3f65-4a41-a798-ef10e61f5c26","subtype":"script","commandType":"auto","position":4.891891891891892,"command":"# Register the table.\naccess_logs_dataframe.saveAsTable(\"SQLApacheAccessLogsTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494430947E12,"submitTime":1.427494089236E12,"finishTime":1.427494435576E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"ffae3510-bc37-4c1c-ab67-b4a04517bdae"},{"version":"CommandV1","origId":3617,"guid":"eb05b8e8-0ede-428c-bf18-a7a96a74fe9b","subtype":"script","commandType":"auto","position":4.918918918918919,"command":"%sql describe SQLApacheAccessLogsTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[["clientIdentd","string",""],["contentSize","bigint",""],["dateTime","string",""],["endpoint","string",""],["ipAddress","string",""],["method","string",""],["protocol","string",""],["responseCode","bigint",""],["userId","string",""]],"arguments":{},"schema":[{"type":"string","name":"col_name"},{"type":"string","name":"data_type"},{"type":"string","name":"comment"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.42749443558E12,"submitTime":1.427494093751E12,"finishTime":1.427494435639E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"e9accefa-a027-4513-9770-a6be0d66227f"},{"version":"CommandV1","origId":3618,"guid":"d9fdc487-6dfa-4a78-83a2-9a8ca5a2cb68","subtype":"script","commandType":"auto","position":4.945945945945946,"command":"%sql SELECT * FROM SQLApacheAccessLogsTable limit 10;","commandVersion":0,"state":"finished","results":{"type":"table","data":[["-",361.0,"21/Jul/2014:10:00:00 -0800","/endpoint_494","127.0.0.1","GET","HTTP/1.1",200.0,"-"],["-",288.0,"21/Apr/2014:10:00:00 -0500","/endpoint_33","3.3.3.3","PUT","HTTP/1.1",200.0,"-"],["-",468.0,"21/Jan/2014:10:00:00 -0200","/endpoint_600","127.0.0.1","GET","HTTP/1.1",200.0,"-"],["-",342.0,"21/Jul/2014:10:00:00 -0800","/endpoint_796","127.0.0.1","GET","HTTP/1.1",200.0,"-"],["-",111.0,"21/Jan/2014:10:00:00 -0200","/endpoint_132","2.2.2.2","GET","HTTP/1.1",200.0,"user1"],["-",337.0,"21/Apr/2014:10:00:00 -0500","/endpoint_645","127.0.0.1","GET","HTTP/1.1",200.0,"-"],["-",252.0,"21/Jan/2014:10:00:00 -0200","/endpoint_925","4.4.4.4","GET","HTTP/1.1",200.0,"-"],["-",159.0,"21/Mar/2014:10:00:00 -0400","/endpoint_711","4.4.4.4","GET","HTTP/1.1",200.0,"-"],["-",289.0,"21/Jan/2014:10:00:00 -0200","/endpoint_03","2.2.2.2","GET","HTTP/1.1",200.0,"-"],["-",114.0,"21/Mar/2014:10:00:00 -0400","/endpoint_874","4.4.4.4","PUT","HTTP/1.1",200.0,"-"]],"arguments":{},"schema":[{"type":"string","name":"clientIdentd"},{"type":"bigint","name":"contentSize"},{"type":"string","name":"dateTime"},{"type":"string","name":"endpoint"},{"type":"string","name":"ipAddress"},{"type":"string","name":"method"},{"type":"string","name":"protocol"},{"type":"bigint","name":"responseCode"},{"type":"string","name":"userId"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427494435644E12,"submitTime":1.427494094716E12,"finishTime":1.427494436244E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"c36b2b46-e06f-4bfd-a531-844fa98b9413"},{"version":"CommandV1","origId":3619,"guid":"08a9c34a-f496-4503-bb77-72a377b2769d","subtype":"script","commandType":"auto","position":4.972972972972973,"command":"%md\n### Proceed to the **Log Analysis in SQL** Notebook to do the same analysis with SQL.\nSave yourself the trouble of converting results to a DataFrame to display them - results of SQL select statements are always displayed.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### Proceed to the **Log Analysis in SQL** Notebook to do the same analysis with SQL.\nSave yourself the trouble of converting results to a DataFrame to display them - results of SQL select statements are always displayed.","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427494436249E12,"submitTime":1.427494104567E12,"finishTime":1.427494436253E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":["1aac79da-dc99-4f58-98a5-09955cd97552"],"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"d841f066-1eaf-45a7-9d46-985b23b40205"},{"version":"CommandV1","origId":3620,"guid":"0fe3b58a-3179-4462-b76d-b3d87748a08f","subtype":"command","commandType":"auto","position":5.000004877941176,"command":"runEnd = time.time()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494436257E12,"submitTime":1.427494421825E12,"finishTime":1.427494436299E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"f2301bca-80e1-4719-be18-69d0f9d66dbc"},{"version":"CommandV1","origId":3621,"guid":"d9bbf9ba-05d3-4022-8b60-194e32a21bfd","subtype":"command","commandType":"auto","position":6.000004877941176,"command":"%md\n\n### **Step 3:** Insert a row to indicate the result of this run.","commandVersion":0,"state":"finished","results":{"type":"markdown","data":"### **Step 3:** Insert a row to indicate the result of this run.","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494436304E12,"submitTime":1.427494421839E12,"finishTime":1.427494436309E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"4ebd027e-c87c-430a-b6bb-ed8965dca8d5"},{"version":"CommandV1","origId":3622,"guid":"f7a89a1e-279f-4188-b38f-14f31d22dae0","subtype":"command","commandType":"auto","position":7.000004877941176,"command":"from pyspark.sql import Row\nrdd = sc.parallelize([Row(runStart=runStart, runDuration=(runEnd - runStart))])\nschemaRDD = sqlContext.createDataFrame(rdd)\nschemaRDD.registerTempTable(\"oneRun\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"Command skipped","startTime":1.427494436312E12,"submitTime":1.427494421853E12,"finishTime":1.427494436638E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"4b30a865-7b54-4c07-b770-384afcfaffc4"},{"version":"CommandV1","origId":3623,"guid":"30fa3c03-a737-4e49-b7ae-62ccbdd53664","subtype":"command","commandType":"auto","position":8.000004877941176,"command":"%sql insert into TABLE logsAnalysisPython select runStart, runDuration from oneRun limit 1","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[{"type":"int","name":"runStart"},{"type":"int","name":"runDuration"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.427494436642E12,"submitTime":1.427494421868E12,"finishTime":1.427494438849E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"d9ca29a5-7fa0-4b6b-8e4f-e9536bec8c88"},{"version":"CommandV1","origId":3624,"guid":"766f286c-de49-4419-9aca-213d1f07666b","subtype":"command","commandType":"auto","position":9.000004877941176,"command":"%sql select from_unixtime(runstart) as starttime, runduration from logsAnalysisPython","commandVersion":0,"state":"finished","results":{"type":"table","data":[["2014-12-02 20:07:40",132.0],["2015-03-27 21:47:14",5.0],["2015-03-27 22:13:43",13.0]],"arguments":{},"schema":[{"type":"string","name":"starttime"},{"type":"int","name":"runduration"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":"Command skipped","startTime":1.427494438853E12,"submitTime":1.427494421895E12,"finishTime":1.427494439345E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"2a85dbb3-6cc7-4f80-ac4d-2c81a4bb5bc8"}],"guid":"1f4dc48f-3f7c-4820-a072-a09e275e0212","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"6693c525-1deb-473c-8a94-9c2bdcf766cf","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>