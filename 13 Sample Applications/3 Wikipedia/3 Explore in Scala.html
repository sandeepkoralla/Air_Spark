<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Sample Applications / Wikipedia / Explore in Scala - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3382,"name":"Sample Applications / Wikipedia / Explore in Scala","language":"scala","commands":[{"version":"CommandV1","origId":3383,"guid":"8113a979-3656-4d1b-befd-0e5a8fa7fe1c","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n# **Explore/Analyze Wikipedia Table**\nThis notebook covers data exploration against the Wikipedia Table using a combination of Scala and SQL.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.426530663874E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{"barChart":[],"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"da8a87f0-d90f-42c0-9785-82b02b8221ec"},{"version":"CommandV1","origId":3384,"guid":"964c226b-bd53-456b-8e5b-79300b6fa6a7","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n\n### **Step 1:** Display the titles of some articles in Wikipedia that contain a particular word.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.426530666657E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{"barChart":[],"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"33f05826-f766-44a1-abe9-5a0a8fac8ec2"},{"version":"CommandV1","origId":3385,"guid":"165e0a25-efbf-4ad4-95c2-1de4574f0f93","subtype":"command","commandType":"auto","position":3.0,"command":"// Register a function that can search that a string is found.\n// You could just use the sql \"like\" syntax, but this demonstrates how to register a function which you can do more with.\nval containsWord = (s: String, w: String) => {\n  (s != null && s.indexOfSlice(w) >= 0).toString()\n}\nsqlContext.udf.register(\"containsWord\", containsWord)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">containsWord: (String, String) =&gt; String = &lt;function2&gt;\nres4: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(&lt;function2&gt;,StringType)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828185612E12,"submitTime":1.427828185562E12,"finishTime":1.427828186158E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{"barChart":[],"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"1a957957-87f3-427c-99d9-79729510128f"},{"version":"CommandV1","origId":3386,"guid":"5b492b28-4a31-410a-85b2-271995ef8db5","subtype":"command","commandType":"auto","position":3.75,"command":"%sql \n-- Use a parameterized query so a user can easily change the word to search for.\nselect title from wikipedia where containsWord(text, '$word') == 'true'","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Anarchism"],["Autism"],["Alabama"],["Achilles"],["Aristotle"],["Animalia (book)"],["Altruism"],["Algeria"],["Anthropology"],["Agricultural science"],["Alchemy"],["Animation"],["Apollo"],["Animal Farm"],["Amphibian"],["Agriculture"],["Algae"],["Alkane"],["Acid"],["A Modest Proposal"],["Alkali metal"],["Anatomy"],["Animal (disambiguation)"],["Aardvark"],["Aardwolf"],["Atlantic Ocean"],["Arthur Schopenhauer"],["Angola"],["Android (robot)"],["Alberta"],["Actinopterygii"],["Azerbaijan"],["Art"],["Agnostida"],["Abortion"],["Annual plant"],["Atlas (disambiguation)"],["Alexander the Great"],["Aries (constellation)"],["Arabic language"],["Anaconda"],["Aircraft"],["Anatolia"],["American Civil War"],["Akira Kurosawa"],["Ancient Egypt"],["Arsenic"],["Antimony"],["Aluminium"],["Angst"],["A. A. Milne"],["The Amazing Spider-Man"],["Asteraceae"],["Axon"],["Acute disseminated encephalomyelitis"],["Alps"],["Abscess"],["Aarhus"],["Alexis Carrel"],["Anatole France"],["Antisemitism"],["Avicenna"],["Artificial intelligence"],["Anaximander"],["Architect"],["Aphrodite"],["Afterlife"],["Athena"],["Acoustics"],["Amino acid"],["Athens"],["Ashoka"],["Antoninus Pius"],["Geography of Alabama"],["Antarctic Treaty System"],["Ames, Iowa"],["Abalone"],["Casa Batlló"],["Casa Milà"],["Apatosaurus"],["Allosaurus"],["Andes"],["Ammonia"],["Albertosaurus"],["Ambrose"],["Amber"],["Amos Bronson Alcott"],["Arachnophobia"],["Animism"],["Adrian"],["Abraham"],["Abydos, Egypt"],["Acacia"],["Acapulco"],["Alemanni"],["Alfred Russel Wallace"],["Dodo (Alice's Adventures in Wonderland)"],["Aspirin"],["Ainu people"],["Acupuncture"],["Agamemnon"],["Agni"],["Akkadian Empire"],["Albertus Magnus"],["Afonso de Albuquerque"],["Alexander Jannaeus"],["Aberdeen"],["Aquaculture"],["Alhazen"],["Aloe"],["Amaryllis"],["Amazons"],["Ambergris"],["Amazon River"],["Ancyra (genus)"],["Andaman Islands"],["An Enquiry Concerning Human Understanding"],["Adenosine triphosphate"],["Antibiotics"],["Adam Smith"],["Antoine Lavoisier"],["Allegory"],["Alternative medicine"],["Natural history of Africa"],["Geography of Africa"],["American English"],["Abzyme"],["Antibiotic resistance"],["Alessandro Volta"],["Ara (constellation)"],["Alexander Fleming"],["Australian Democrats"],["Australian Capital Territory"],["Austin, Texas"],["Archery"],["Comparison of American and British English"],["Ares"],["Auguste Rodin"],["Acts of the Apostles"],["Assyria"],["Ark"],["Aphasia"],["Aorta"],["Asterix"],["Astrology"],["Aesthetics"],["Aaliyah"],["Armour"],["Afrikaans"],["Cuisine of the United States"],["Armadillo"],["Arctic fox"],["Folklore of the United States"],["Sid Meier's Alpha Centauri"],["Armenian language"],["Apicomplexa"],["Argentine cuisine"],["Abiotic stress"],["Ascorbic acid"],["Actinide"],["Anita Hill"],["AD (disambiguation)"],["Alkaloid"],["A.S. Roma"],["Antibody"],["Andhra Pradesh"],["Aalen"],["Aedile"],["Adhesive"],["Albrecht Dürer"],["A cappella"],["Ann Widdecombe"],["Action Against Hunger"],["Apoptosis"],["Anal sex"],["Aarau"],["American Quarter Horse"],["Anthroposophy"],["Aurochs"],["Anus"],["Amphetamine"],["Artillery"],["Agent Orange"],["Arthur Phillip"],["Ant"],["Aegina"],["Aegis"],["Ajanta Caves"],["Affection"],["Andalusia"],["Azad Kashmir"],["Arabian Sea"],["Aspartame"],["Asexual reproduction"],["Aelbert Cuyp"],["Ames test"],["Ahimsa"],["Astrobiology"],["A Vindication of the Rights of Woman"],["Afghan Hound"],["Ai"],["Aberdeen Bestiary"],["Advertising"],["Amoxicillin"],["A Wizard of Earthsea"],["Artemis"],["Ahuitzotl"],["Albinism"],["Antarctic"],["Anoa"],["Alkali"],["Alcoholism"],["Abstraction"],["Amphibian (disambiguation)"],["Amputation"],["Archaeopteryx"],["Anubis"],["Aleut"],["Alexandria"],["Alexandria, Louisiana"],["Arteriovenous malformation"],["Atlanta"],["Attribution of recent climate change"],["Mexican tetra"],["Azores"],["Outback"],["Anthony the Great"],["Amblypoda"],["Amygdalin"],["Running amok"],["Agar"],["Acid rain"],["Antioxidant"],["Baltic Sea"],["Brackish water"],["The Beverly Hillbillies"],["Britney Spears"],["Brazil"],["Black Forest"],["Black Sea"],["British Columbia"],["Gautama Buddha"],["Beadwork"],["Board game"],["Bead"],["Branchiopoda"],["Being"],["Bird"],["Bulgaria"],["Bryozoa"],["Burgess Shale"],["Beavis and Butt-head"],["Blindness"],["The Bahamas"],["Bangladesh"],["Barbados"],["Belize"],["Benin"],["Bolivia"],["Botswana"],["Burkina Faso"],["Economy of the Bahamas"],["Economy of Bhutan"],["Geography of Brazil"],["Economy of the British Virgin Islands"],["Geography of Bulgaria"],["Brain"],["Biotic"],["British Isles"],["Blade Runner"],["Belgian Blue"],["Boron"],["Bromine"],["Berkelium"],["Body"],["Brigitte Bardot"],["Banjo"],["Bluetongue disease"],["Biostatistics"],["British and Irish Lions"],["Basketball"],["Ball"],["Bagpipes"],["Biochemistry"],["Book of Mormon"],["Benjamin Franklin"],["Boat"],["Blood"],["Bigfoot"],["Bing Crosby"],["Butterfly effect"],["Black"],["Bone"],["Benzoic acid"],["Beast of Bodmin"],["Brown University"],["Utility knife"],["Babe Ruth"],["Barge"],["British English"],["Botany"],["Bacillus thuringiensis"],["Bacteriophage"],["Bactericide"],["Brion Gysin"],["BCG vaccine"],["Bipedalism"],["Bioinformatics"],["Cell (biology)"],["Bollywood"],["Barcelonnette"],["Beltane"],["Bastarnae"],["Boomerang"],["Biological warfare"],["Beagle"],["Boiled leather"],["Browser"],["Bioterrorism"],["Beaver"],["Bear"],["Bald eagle"],["Brown bear"],["Brewing"],["Breast reconstruction"],["Beauty"],["Book of Jonah"],["Book of Micah"],["Book of Malachi"],["Book of Zephaniah"],["Blue crane"],["Buddhist philosophy"],["Beatrix Potter"],["Bean"],["Breast"],["Baghdad"],["Outline of biology"],["Band"],["Black Death"],["Biotechnology"],["Bongo (antelope)"],["Bunyip"],["Banshee"],["Genetically modified maize"],["Borneo"],["Blue"],["BDSM"],["Bikini"],["Balalaika"],["Bison"],["Bronze Age"],["Bill Oddie"],["Bee"],["Basques"],["Balochistan, Pakistan"],["Bob Jones University"],["Batman (1966 film)"],["Batman & Robin (film)"],["Plague (disease)"],["Bestiary"],["Ballad of the Green Berets"],["Borzoi"],["Basenji"],["Brit milah"],["Business ethics"],["Benzodiazepine"],["Bladder (disambiguation)"],["Biome"],["Biosphere"],["Budweiser"],["B. F. Skinner"],["Black metal"],["Basel"],["Bunnies & Burrows"],["Blue whale"],["Brass instrument"],["Blood libel"],["Ballarat"],["Battle of Bouvines"],["Zebrafish"],["Brisbane Broncos"],["Bride of the Monster"],["Belfast"],["Chordate"],["Charlize Theron"],["Communication"],["Cytoplasm"],["Khmer language"],["Carnivora"],["Colombia"],["Callitrichidae"],["Cebidae"],["Carl Linnaeus"],["Coast"],["Common descent"],["Constellation"],["Car (disambiguation)"],["Carbon"],["Cone (disambiguation)"],["The Consolation of Philosophy"],["Charlemagne"],["Computer science"],["Creationism"],["History of Chad"],["Geography of Chad"],["Transport in Chad"],["Cooking"],["Cambrian"],["Condom"],["Cladistics"],["Cultural anthropology"],["Carboniferous"],["China"],["California"],["Cardiology"],["History of Cambodia"],["Khmer architecture"],["Capricorn"],["Politics of Cameroon"],["History of the Cayman Islands"],["Chad"],["Chile"],["Economy of Chile"],["Christmas Island"],["Clipperton Island"],["Costa Rica"],["History of Costa Rica"],["Croatia"],["Geography of Croatia"],["Economy of Cuba"],["Cretaceous"],["Creutzfeldt–Jakob disease"],["Canal"],["Cognitive science"],["Copula (linguistics)"],["Channel Islands"],["Cult film"],["Constantinople"],["Cow (disambiguation)"],["Cannibalism"],["Chemical element"],["Consciousness"],["Chlorine"],["Calcium"],["Codex"],["Calf"],["Cross-dressing"],["Comic strip"],["Canary Islands"],["Cape Breton Island"],["Consequentialism"],["Cognitive behavioral therapy"],["History of China"],["Çatalhöyük"],["Caving"],["Cave"],["Chinese numerals"],["Crime"],["Cretaceous–Paleogene extinction event"],["Celebrity"],["C. S. Lewis"],["Cenozoic"],["Chinese philosophy"],["Cryptozoology"],["County Mayo"],["Climbing"],["Coronary artery disease"],["Capital punishment"],["Chalcogen"],["Carbon dioxide"],["Cyanide"],["Color"],["Carbohydrate"],["History of The Church of Jesus Christ of Latter-day Saints"],["Christian eschatology"],["Circe"],["Canadian Pacific Railway"],["Compost"],["Capoeira"],["Carbon sink"],["Traditional Chinese medicine"],["Climate"],["Celibacy"],["Continental drift"],["Collagen"],["Calvin and Hobbes"],["Chechnya"],["Carboxylic acid"],["Cream"],["Central America"],["Carbon monoxide"],["Claudius"],["Chinese Islamic cuisine"],["Cantonese cuisine"],["Cologne"],["Buddhist cuisine"],["Convention on Biological Diversity"],["CITES"],["Chinese room"],["Cell nucleus"],["Christmas"],["Civilization"],["Chupacabra"],["Classical element"],["Carolina parakeet"],["Cell biology"],["Czech language"],["Cretinism"],["Cetus"],["Camelopardalis"],["Centaurus"],["Chojnów"],["Cholesterol"],["Chromosome"],["Carcinogen"],["Camouflage"],["Cow tipping"],["Cassandra"],["Carnivore"],["Celts"],["Carthage"],["Columba"],["Chinese cuisine"],["Crete"],["Computer vision"],["Camel"],["Yangtze"],["Chrono Trigger"],["Cornwall Wildlife Trust"],["Cnidaria"],["Cane toad"],["Cape Town"],["Cuisine"],["October 2003"],["Cement"],["Cat"],["Clade"],["Mail (armour)"],["Coyote"],["Christianity and antisemitism"],["Canidae"],["Subspecies of Canis lupus"],["Cryonics"],["Ciprofloxacin"],["Chlorophyta"],["Capybara"],["Computer animation"],["Cytosol"],["Chiapas"],["Charge-coupled device"],["Cavalry"],["Citric acid cycle"],["Carl Sagan"],["Caligula"],["Caffeine"],["Cyc"],["Cyborgs in fiction"],["Cecilia Beaux"],["City of London"],["Clitoris"],["Census"],["Cotswolds"],["Chakra"],["Cloning"],["Cellulose"],["Rod (optics)"],["Carmilla"],["Cheddar cheese"],["Crossbow"],["Chinese calendar"],["Chipmunk"],["Carotene"],["Chagas disease"],["Christiaan Barnard"],["Jean-Baptiste-Siméon Chardin"],["Confederate States of America"],["Candidiasis"],["Beetle"],["Cannon"],["Chocolate"],["Cordwainer Smith"],["Collective noun"],["Cartoon"],["Chemotherapy"],["Chinese historiography"],["Cryogenics"],["Cairn"],["List of cat breeds"],["Claudius Aelianus"],["Choctaw"],["Cholistan Desert"],["Constantine the Great"],["Central nervous system"],["Cell cycle"],["Canchim"],["Centromere"],["Cardiac glycoside"],["Hypothetical types of biochemistry"],["Creation myth"],["Cyprinidae"],["Chimera"],["Clement of Alexandria"],["Carl Barks"],["Christian views on marriage"],["Centaur"],["Chemotaxis"],["Crochet"],["Jews as the chosen people"],["Chaparral"],["RDX"],["Christianity and Judaism"],["Charles Evans Hughes"],["Coin"],["Christmas in Poland"],["Christadelphians"],["Cholera"],["Caldera"],["Cetacea"],["The Canterbury Tales"],["Catharism"],["Charles F. Hockett"],["Cognitivism"],["Costume"],["Cable car (railway)"],["Centriole"],["Creation science"],["Cocaine"],["Coprophagia"],["Professor X"],["Chiropractic"],["Christmas tree"],["Coriolis effect"],["Critical psychology"],["Cruising (maritime)"],["Cavitation"],["Cernunnos"],["Click consonant"],["Cactus"],["CCC"],["Civilian Conservation Corps"],["Common chimpanzee"],["Charcot–Marie–Tooth disease"],["Dance"],["Dune"],["David Lynch"],["Dracula"],["David Hume"],["Dictionary"],["Dungeons & Dragons"],["DNA"],["Drink"],["Devonian"],["Dentistry"],["Data compression"],["Demographics of the Democratic Republic of the Congo"],["Economy of the Democratic Republic of the Congo"],["Geography of Denmark"],["Economy of Denmark"],["History of Djibouti"],["Geography of Dominica"],["History of the Dominican Republic"],["Disease"],["Diamond"],["Documentary film"],["Douglas Adams"],["Dairy product"],["Deforestation"],["Desertification"],["Dock"],["Dose"],["Digitalis"],["Dendrite"],["Dartmoor"],["Dye"],["Dejima"],["Detective fiction"],["Desmond Morris"],["Timeline of chemical element discoveries"],["Doctor Who"],["Democritus"],["Death"],["Demeter"],["Don Quixote"],["Dice"],["Dayton, Ohio"],["Doris Day"],["Down syndrome"],["Dinosaur"],["Diamagnetism"],["December 17"],["Draugr"],["Day"],["Major depressive disorder"],["Diana (mythology)"],["Decibel"],["Darwinism"],["Doraemon"],["Dodo"],["Sideroxylon grandiflorum"],["Didgeridoo"],["Developmental biology"],["Dartmoor wildlife"],["Dieting"],["DDT"],["Dachshund"],["Denver"],["Deuterium"],["Discordianism"],["Dead Sea"],["Dragon"],["Devil"],["Diesel engine"],["Dedham, Massachusetts"],["Book of Deuteronomy"],["Diocletian"],["Deism"],["Dispersion"],["List of dog breeds"],["Dhole"],["Druze"],["Door"],["Don't ask, don't tell"],["Divination"],["Dr. Strangelove"],["Dukkha"],["December 10"],["Taiko"],["Diprotodon"],["December 22"],["N,N-Dimethyltryptamine"],["Dominatrix"],["Dharma"],["Daniel Dennett"],["Darwin's Dangerous Idea"],["Dahomey"],["DNA virus"],["Demiurge"],["D. B. Cooper"],["Deicide (band)"],["West Memphis Three"],["Dr. Seuss"],["Recreational use of dextromethorphan"],["Deconstruction"],["Discrimination"],["Don Rosa"],["Detroit River"],["Dsungaripterus"],["Developmental psychology"],["Daisy Duck"],["Drosophila"],["Dolphin"],["DC Comics"],["Davis, California"],["Dolly (sheep)"],["Earth"],["Evolution"],["Europe"],["Esperanto"],["Encyclopedia"],["Enzyme"],["Ethics"],["Entertainment"],["Elephant"],["Evolutionary linguistics"],["Elvis Presley"],["Erasmus Darwin"],["Ediacaran"],["Endocrinology"],["Endocrine system"],["Easter egg"],["Ethan Allen"],["Ecuador"],["History of Ecuador"],["Geography of Ecuador"],["Economy of Egypt"],["Transport in Egypt"],["Foreign relations of Egypt"],["Economy of Equatorial Guinea"],["Economy of Eritrea"],["Economy of Ethiopia"],["Eocene"],["Eindhoven"],["Ethology"],["The Downward Spiral"],["Event"],["Etruscan language"],["Longest word in English"],["Einsteinium"],["Eskimo"],["Epiphenomenalism"],["Endometrium"],["Euphemism"],["Design of experiments"],["Electricity"],["Empedocles"],["Euthanasia"],["Extraterrestrial life"],["Electrochemistry"],["Evolutionarily stable strategy"],["Extremophile"],["Ecology"],["Ecosystem"],["Engine"],["Energy"],["Eugène Viollet-le-Duc"],["Book of Exodus"],["Ernst Haeckel"],["Ethiopian cuisine"],["Evolutionary psychology"],["Ernest Thayer"],["List of recently extinct birds"],["Eugenics"],["Endoplasmic reticulum"],["Emily Brontë"],["Extinction event"],["European Convention on Human Rights"],["Economy of Afghanistan"],["Elf"],["Entamoeba"],["Endomembrane system"],["Eurovision Song Contest"],["Nitrox"],["Erik Satie"],["Ewe"],["Essenes"]],"arguments":{"word":"animal"},"schema":[{"type":"string","name":"title"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.427828188379E12,"submitTime":1.427828188307E12,"finishTime":1.427828192337E12,"collapsed":false,"bindings":{"word":"animal"},"inputWidgets":{},"displayType":"table","width":"1254","height":"309.0","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{"barChart":[],"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"05245128-b796-45df-931e-280f95a0326b"},{"version":"CommandV1","origId":3387,"guid":"96b4e803-d710-4ae1-a656-41e12f1757bd","subtype":"command","commandType":"auto","position":4.75,"command":"%md\n\n### **Step 2:** Explore Word Counts in Wikipedia.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.4278281949E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{"barChart":[],"mapPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"8b205d2c-a167-4ae8-9102-0970fc6618c8"},{"version":"CommandV1","origId":3388,"guid":"1278011e-4b91-48e9-8597-ef1b2a55a677","subtype":"command","commandType":"auto","position":5.75,"command":"val cleanAndSplit = (somestring: String) => {\n  if (somestring == null) {\n    Array[String]()\n  } else {\n    somestring.toLowerCase().replaceAll(\"[^\\\\w]\", \" \").trim().split(\"\\\\s\").filter(s => s.length() > 0)\n  }\n}\n\ncase class WordCount(word: String, count: Long)\n\nval wordCountsRdd = (sqlContext.sql(\"select text from wikipedia\").rdd\n  .flatMap(row => cleanAndSplit(row.getString(0)))\n  .map(s => (s, 1))\n  .reduceByKey(_ + _)\n  .map(t => WordCount(t._1, t._2))).toDF()\n\nwordCountsRdd.registerTempTable(\"word_counts\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">cleanAndSplit: String =&gt; Array[String] = &lt;function1&gt;\ndefined class WordCount\nwordCountsRdd: org.apache.spark.sql.DataFrame = [word: string, count: bigint]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.4278282074E12,"submitTime":1.427828207312E12,"finishTime":1.427828208419E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"de3e5eea-1dcc-4abf-bad0-81fe52c3c3a6"},{"version":"CommandV1","origId":3389,"guid":"3a262cd2-880a-4cfa-af91-9b309e902c21","subtype":"command","commandType":"auto","position":6.75,"command":"%sql\n-- Try toggling the view between the table view (for reading out the top words)\n--- and a bar chart to allow you to see the word count distribution.\nselect word, count from word_counts order by count desc limit 1000","commandVersion":0,"state":"finished","results":{"type":"table","data":[["the",2.08625703E8],["of",1.2542823E8],["in",8.4885139E7],["and",8.4198884E7],["to",6.9271796E7],["a",6.9265553E7],["ref",5.65573E7],["user",3.8212564E7],["s",3.6372997E7],["is",3.5957508E7],["http",3.5911999E7],["for",3.1509501E7],["1",2.9854737E7],["on",2.8966871E7],["0",2.7591483E7],["category",2.7095172E7],["was",2.6837842E7],["com",2.6607443E7],["www",2.6525812E7],["as",2.5221317E7],["name",2.4807217E7],["talk",2.378513E7],["by",2.3321028E7],["title",2.2034515E7],["that",2.1153967E7],["with",2.1007071E7],["it",2.0960934E7],["2",2.0636666E7],["from",1.8371054E7],["wikipedia",1.7997128E7],["date",1.7719716E7],["at",1.722355E7],["this",1.6280276E7],["align",1.6192946E7],["i",1.588465E7],["org",1.5754644E7],["style",1.4982978E7],["3",1.468304E7],["be",1.4258775E7],["an",1.3890499E7],["cite",1.3753224E7],["he",1.3722244E7],["utc",1.2750386E7],["small",1.2732971E7],["not",1.2563072E7],["br",1.2027657E7],["url",1.1927118E7],["center",1.1620222E7],["4",1.1197518E7],["his",1.1151896E7],["page",1.1113619E7],["or",1.1048029E7],["are",1.0955451E7],["w",1.0949756E7],["new",1.0900698E7],["link",1.0873376E7],["span",1.082631E7],["en",1.0749603E7],["5",1.0463023E7],["u",1.0275196E7],["font",1.009257E7],["first",1.0081342E7],["2011",9874013.0],["color",9658663.0],["web",9628665.0],["accessdate",9610898.0],["l",9566147.0],["x",9425151.0],["10",9384050.0],["publisher",9232148.0],["6",9111130.0],["php",8855467.0],["coibot",8742701.0],["2010",8686597.0],["no",8618911.0],["article",8547266.0],["2012",8398866.0],["index",8179237.0],["t",7919545.0],["has",7898118.0],["redirect",7872072.0],["which",7780262.0],["2013",7744449.0],["html",7642640.0],["you",7617394.0],["2009",7584239.0],["2008",7579143.0],["also",7562915.0],["news",7478692.0],["but",7306078.0],["diff",7266400.0],["12",7215325.0],["one",7208432.0],["nbsp",7199014.0],["7",7180370.0],["have",7174749.0],["domain",7118353.0],["may",7106664.0],["c",7025432.0],["left",7010598.0],["11",6985318.0],["were",6980612.0],["time",6979214.0],["image",6852308.0],["year",6796936.0],["otherlinks",6784848.0],["united",6767476.0],["8",6544371.0],["2007",6516712.0],["class",6504739.0],["de",6269635.0],["deletion",6262134.0],["m",6214527.0],["ul",6181373.0],["20",6138227.0],["r",6137170.0],["all",6113219.0],["2014",6091366.0],["wul",6064755.0],["id",6044861.0],["uk",5932070.0],["oldid",5926013.0],["9",5787788.0],["there",5738118.0],["n",5716543.0],["p",5677671.0],["15",5639383.0],["list",5608862.0],["other",5590154.0],["jpg",5587951.0],["13",5540808.0],["flagicon",5491770.0],["14",5488386.0],["who",5385389.0],["last",5380300.0],["states",5375017.0],["if",5367459.0],["people",5365762.0],["they",5356064.0],["16",5340609.0],["county",5273511.0],["work",5192972.0],["2006",5167262.0],["18",5142660.0],["state",5142611.0],["background",5107650.0],["world",5107326.0],["special",5074361.0],["had",5024683.0],["their",5009024.0],["after",5005879.0],["17",4995233.0],["see",4994574.0],["sup",4976904.0],["d",4962813.0],["22",4918579.0],["american",4916034.0],["discussion",4874311.0],["football",4842980.0],["text",4829556.0],["articles",4818331.0],["party",4801340.0],["been",4791692.0],["its",4747621.0],["19",4730238.0],["21",4718802.0],["made",4617653.0],["references",4605835.0],["can",4593258.0],["file",4589721.0],["about",4574182.0],["f",4570369.0],["national",4568734.0],["march",4562098.0],["right",4505467.0],["july",4491449.0],["city",4454021.0],["more",4442750.0],["two",4412228.0],["film",4392657.0],["b",4390892.0],["january",4379460.0],["history",4369912.0],["place",4368681.0],["august",4360019.0],["23",4343709.0],["september",4341502.0],["university",4315961.0],["should",4309482.0],["june",4306348.0],["co",4296621.0],["october",4290938.0],["do",4276366.0],["30",4241100.0],["april",4241080.0],["e",4210737.0],["when",4207958.0],["use",4170338.0],["team",4155249.0],["school",4133032.0],["width",4077243.0],["would",4055705.0],["25",4039908.0],["december",4034911.0],["her",4021686.0],["links",4013414.0],["bgcolor",3998522.0],["november",3927498.0],["album",3903889.0],["top",3861039.0],["24",3853904.0],["february",3840975.0],["death",3836454.0],["up",3786580.0],["edit",3732102.0],["only",3688619.0],["she",3647985.0],["birth",3616502.0],["contributions",3570662.0],["john",3566252.0],["29",3545164.0],["such",3536748.0],["2005",3522556.0],["review",3504458.0],["some",3502727.0],["infobox",3490459.0],["south",3488973.0],["season",3481907.0],["journal",3471859.0],["book",3460130.0],["music",3431981.0],["26",3424869.0],["box",3416357.0],["28",3396621.0],["01",3379517.0],["template",3374164.0],["27",3355266.0],["so",3343259.0],["reflist",3327045.0],["author",3307781.0],["into",3274196.0],["nowiki",3270575.0],["out",3219119.0],["series",3154575.0],["league",3154551.0],["district",3153900.0],["york",3116252.0],["will",3114545.0],["years",3107092.0],["wp",3101989.0],["language",3084311.0],["books",3037224.0],["us",3013704.0],["j",2999787.0],["used",2984952.0],["location",2973608.0],["pages",2967311.0],["please",2945835.0],["02",2914334.0],["htm",2901756.0],["north",2881349.0],["over",2865923.0],["rd1",2856745.0],["03",2852229.0],["2004",2818319.0],["06",2817130.0],["war",2803756.0],["most",2792995.0],["04",2776991.0],["red",2774219.0],["than",2758647.0],["07",2752380.0],["09",2751458.0],["stub",2750551.0],["05",2749888.0],["what",2743860.0],["during",2742056.0],["high",2730066.0],["delete",2718229.0],["08",2690689.0],["yes",2688841.0],["then",2676566.0],["website",2659949.0],["100",2659256.0],["31",2652155.0],["ndash",2648601.0],["00",2630422.0],["country",2598675.0],["english",2596687.0],["my",2583891.0],["group",2580838.0],["any",2579691.0],["free",2576215.0],["type",2574123.0],["div",2573672.0],["election",2573510.0],["where",2554544.0],["g",2551547.0],["we",2511800.0],["non",2507149.0],["external",2501621.0],["gov",2496619.0],["description",2476807.0],["your",2475221.0],["player",2469074.0],["white",2459934.0],["like",2453482.0],["pdf",2437092.0],["under",2429140.0],["action",2429126.0],["family",2415162.0],["border",2411758.0],["o",2397677.0],["being",2395670.0],["international",2385441.0],["v",2379789.0],["these",2365285.0],["three",2365084.0],["west",2359043.0],["game",2353895.0],["archive",2346379.0],["house",2345834.0],["st",2337740.0],["isbn",2337718.0],["many",2313707.0],["defaultsort",2312194.0],["rowspan",2310943.0],["part",2305185.0],["area",2304634.0],["him",2300191.0],["end",2296358.0],["before",2291391.0],["club",2290161.0],["general",2286109.0],["them",2284425.0],["source",2275897.0],["british",2269224.0],["well",2260791.0],["40",2259046.0],["h",2258595.0],["short",2255915.0],["company",2250382.0],["2000",2234688.0],["between",2230769.0],["tv",2229092.0],["second",2222854.0],["la",2193977.0],["number",2183813.0],["net",2180871.0],["line",2178590.0],["song",2171603.0],["deleted",2168726.0],["google",2164453.0],["information",2159397.0],["2003",2156538.0],["persondata",2150856.0],["players",2142445.0],["me",2142182.0],["ship",2132114.0],["just",2130421.0],["added",2124613.0],["sub",2115813.0],["50",2112823.0],["age",2107392.0],["born",2103985.0],["base",2102477.0],["contribs",2093054.0],["result",2088416.0],["convert",2074364.0],["while",2071987.0],["now",2070959.0],["college",2056049.0],["000",2051942.0],["best",2046757.0],["games",2042613.0],["thumb",2032350.0],["main",2016056.0],["k",2015021.0],["life",2011332.0],["2002",2011311.0],["later",2010290.0],["section",1989672.0],["men",1984084.0],["london",1980046.0],["2001",1971601.0],["size",1970724.0],["day",1959288.0],["further",1955283.0],["times",1951371.0],["station",1943197.0],["known",1941598.0],["both",1936783.0],["following",1926840.0],["since",1922794.0],["names",1916365.0],["here",1914520.0],["black",1909089.0],["through",1906997.0],["issue",1893751.0],["colspan",1885762.0],["comments",1868405.0],["y",1858881.0],["because",1858791.0],["report",1857012.0],["undo",1844900.0],["don",1843276.0],["east",1837994.0],["press",1837272.0],["home",1826961.0],["old",1810846.0],["single",1810363.0],["cup",1803409.0],["town",1801474.0],["summer",1797972.0],["wiki",1789638.0],["church",1788351.0],["re",1784390.0],["alternative",1775198.0],["band",1772705.0],["against",1771428.0],["same",1769925.0],["public",1769066.0],["women",1759631.0],["start",1759306.0],["afd",1759209.0],["long",1753405.0],["edits",1745653.0],["lang",1745609.0],["could",1745018.0],["however",1744236.0],["century",1742015.0],["above",1735566.0],["volume",1734984.0],["sources",1717611.0],["association",1712916.0],["note",1705034.0],["park",1692398.0],["ii",1688047.0],["released",1685278.0],["england",1681559.0],["search",1674279.0],["government",1671772.0],["order",1671331.0],["how",1669860.0],["rd2",1664497.0],["including",1663766.0],["system",1660412.0],["david",1657889.0],["noinclude",1654271.0],["usa",1650606.0],["river",1646894.0],["based",1639565.0],["show",1638495.0],["edu",1634267.0],["39",1632299.0],["region",1629860.0],["california",1618329.0],["baseip",1617973.0],["basedomain",1617973.0],["41",1605448.0],["debate",1602540.0],["using",1602496.0],["road",1599482.0],["view",1598903.0],["1999",1597681.0],["artist",1589484.0],["record",1577619.0],["central",1572099.0],["set",1571266.0],["without",1569199.0],["change",1568586.0],["32",1567862.0],["did",1564480.0],["television",1563317.0],["back",1561582.0],["william",1561553.0],["early",1560144.0],["go",1558217.0],["media",1554182.0],["very",1550177.0],["official",1548680.0],["australia",1547910.0],["james",1534815.0],["good",1533943.0],["way",1532509.0],["solid",1532231.0],["per",1526702.0],["pagename",1526066.0],["al",1522783.0],["keep",1522388.0],["division",1522243.0],["india",1521131.0],["svg",1512145.0],["35",1506766.0],["service",1501543.0],["42",1501396.0],["four",1501163.0],["cover",1501001.0],["air",1500210.0],["story",1497312.0],["45",1495083.0],["became",1492818.0],["fb",1491547.0],["law",1485031.0],["until",1483604.0],["census",1481242.0],["video",1475994.0],["records",1475643.0],["33",1475394.0],["sports",1474939.0],["flag",1474122.0],["green",1473182.0],["space",1472806.0],["french",1472117.0],["population",1470582.0],["wikiproject",1469673.0],["38",1469132.0],["won",1468386.0],["nomination",1468354.0],["bbc",1468266.0],["make",1465799.0],["man",1465439.0],["art",1460525.0],["award",1457559.0],["original",1456678.0],["canada",1449955.0],["below",1448389.0],["whitelisted",1446246.0],["wikitable",1445769.0],["format",1445616.0],["1998",1444118.0],["living",1439414.0],["1px",1436976.0],["major",1433180.0],["does",1432208.0],["reason",1430941.0],["content",1428418.0],["36",1421153.0],["even",1418535.0],["several",1412103.0],["support",1408346.0],["closed",1406521.0],["off",1406000.0],["former",1405081.0],["big",1404006.0],["metadata",1403630.0],["34",1403211.0],["local",1402876.0],["round",1399148.0],["german",1396947.0],["great",1395077.0],["members",1385193.0],["isip",1383191.0],["france",1381523.0],["george",1381459.0],["another",1380962.0],["military",1378793.0],["fr",1375782.0],["each",1374664.0],["final",1370611.0],["10px",1366545.0],["site",1364352.0],["37",1361950.0],["found",1361920.0],["comment",1361629.0],["display",1359820.0],["awards",1359254.0],["ca",1354558.0],["union",1350346.0],["summary",1350027.0],["called",1349851.0],["stadium",1345422.0],["math",1341045.0],["caption",1338686.0],["king",1335123.0],["candidate",1332810.0],["log",1332649.0],["ga",1332402.0],["appropriate",1330973.0],["au",1327959.0],["44",1325604.0],["changed",1324906.0],["kingdom",1324312.0],["51",1323643.0],["point",1318551.0],["san",1318513.0],["research",1318398.0],["still",1316308.0],["australian",1312434.0],["1996",1307527.0],["post",1305337.0],["films",1302001.0],["1997",1301172.0],["championship",1297677.0],["village",1297008.0],["member",1293591.0],["those",1288526.0],["think",1288121.0],["43",1284199.0],["european",1280344.0],["played",1276834.0],["own",1275642.0],["46",1275599.0],["president",1274067.0],["army",1272954.0],["help",1271235.0],["much",1265809.0],["species",1264644.0],["asp",1260273.0],["subsequent",1259143.0],["goal",1258089.0],["code",1257645.0],["48",1250024.0],["magazine",1249883.0],["commons",1249047.0],["education",1246947.0],["png",1246501.0],["robert",1245654.0],["community",1243630.0],["michael",1243373.0],["case",1242222.0],["reference",1241349.0],["user_talk",1238474.0],["username",1235417.0],["province",1234866.0],["modify",1234330.0],["row",1231443.0],["55",1231139.0],["aspx",1230083.0],["baseball",1224009.0],["q",1222034.0],["career",1218758.0],["notable",1217281.0],["52",1216775.0],["science",1215504.0],["radio",1213864.0],["episode",1209844.0],["version",1208755.0],["km",1207867.0],["blue",1207759.0],["paul",1206995.0],["open",1204650.0],["create",1194570.0],["next",1188065.0],["street",1187717.0],["department",1186524.0],["53",1183667.0],["coord",1181500.0],["must",1181125.0],["island",1179471.0],["railway",1179126.0],["rock",1177202.0],["1995",1174022.0],["position",1172661.0],["third",1170468.0],["business",1170330.0],["get",1169474.0],["citation",1168032.0],["47",1165193.0],["am",1159971.0],["around",1154320.0],["score",1147158.0],["live",1147116.0],["building",1145731.0],["washington",1145504.0],["births",1145312.0],["padding",1143381.0],["down",1142717.0],["power",1138857.0],["basketball",1138105.0],["published",1135850.0],["80",1135520.0],["children",1133781.0],["1994",1132000.0],["related",1131387.0],["ru",1130026.0],["thomas",1129174.0],["america",1128019.0],["col",1127131.0],["1992",1125164.0],["votes",1122243.0],["bot",1115391.0],["director",1113353.0],["germany",1109988.0],["established",1109084.0],["office",1108755.0],["star",1106276.0],["western",1104395.0],["project",1102738.0],["bottom",1099388.0],["named",1098212.0],["54",1097063.0],["japan",1095385.0],["royal",1092268.0],["society",1091651.0],["notes",1091623.0],["field",1091240.0],["1990",1090430.0],["included",1089542.0],["canadian",1087926.0],["90",1085303.0],["council",1084868.0],["newspaper",1084333.0],["2nd",1081271.0],["said",1079565.0],["albums",1078724.0],["portal",1077651.0],["texas",1073967.0],["places",1072730.0],["49",1072388.0],["within",1070508.0],["find",1065849.0],["championships",1065740.0],["olympics",1063433.0],["know",1062622.0],["total",1062488.0],["doi",1060984.0],["data",1057221.0],["1993",1055490.0],["label",1055192.0],["love",1055035.0],["again",1054673.0],["low",1052777.0],["logo",1051833.0],["political",1048426.0],["editor",1045797.0],["results",1043578.0],["1991",1043022.0],["current",1041039.0],["rationale",1040740.0],["route",1035970.0],["es",1034678.0],["charles",1034631.0],["abbr",1034551.0],["margin",1031815.0],["full",1025420.0],["built",1025036.0],["different",1022505.0],["present",1020578.0],["court",1018094.0],["water",1017638.0],["development",1016438.0],["play",1014959.0],["located",1014420.0],["created",1013217.0],["function",1009776.0],["map",1007253.0],["57",1005943.0],["force",1005583.0],["five",1004887.0],["take",999385.0],["fc",996893.0],["56",995761.0],["little",994954.0],["scope",992883.0],["sport",991579.0],["grand",990318.0],["large",989603.0],["58",989347.0],["side",988767.0],["control",984618.0],["china",982851.0],["sort",978448.0],["hall",978092.0],["although",977291.0],["held",976438.0],["due",975872.0],["none",974763.0],["mark",974226.0],["peter",974011.0],["pos",971100.0],["independent",970868.0],["republic",970569.0],["include",970222.0],["75",959674.0],["given",958341.0],["others",955725.0],["days",954877.0],["songs",954308.0],["museum",952483.0],["59",952074.0],["works",950161.0],["battle",946797.0],["1988",946635.0],["icon",946144.0],["person",944729.0],["near",940027.0],["japanese",939966.0],["gf",939282.0],["1989",938849.0],["young",937838.0],["release",935216.0],["gold",934724.0],["hockey",932880.0],["level",932106.0],["track",931513.0],["subject",925624.0],["richard",925394.0],["retrieved",924627.0],["overlap",920425.0],["democratic",918887.0],["example",916409.0],["northern",915404.0],["form",915079.0],["60",914890.0],["along",913927.0],["need",913915.0],["nowrap",913463.0],["needed",913327.0],["undoafter",912643.0],["df",910208.0],["written",908668.0],["though",906878.0],["face",906846.0],["archives",903685.0],["ireland",903303.0],["pp",901132.0],["virginia",899499.0],["historic",898787.0],["land",896922.0],["began",895390.0],["pg",892426.0],["1st",890400.0],["took",888540.0],["indian",885572.0],["pennsylvania",884685.0],["head",884081.0],["ve",881616.0],["images",881362.0],["namespace",881281.0],["human",880396.0],["library",878532.0],["lake",876944.0],["act",876285.0],["having",875527.0],["few",873946.0],["licensing",872175.0],["edition",871635.0],["smith",865433.0],["event",863572.0],["brown",861446.0],["200",861110.0],["1987",860834.0],["died",859494.0],["network",857696.0],["europe",855584.0],["away",854713.0],["term",853828.0],["saint",852989.0],["politician",850291.0],["social",849448.0],["online",846404.0],["son",846216.0],["actor",845746.0],["schools",845582.0],["percentage",844877.0],["resolved",844183.0],["often",843496.0],["issues",842524.0],["importance",840404.0],["provide",839330.0],["roman",838751.0],["arts",838646.0],["services",837486.0],["1986",837315.0],["conference",836540.0],["biography",835661.0],["purpose",834756.0],["el",834574.0],["every",833280.0],["1984",832700.0],["why",830975.0],["chemobot",830647.0],["entry",829840.0],["too",829834.0],["70",829717.0],["program",827490.0],["los",826006.0],["proposed",823941.0],["tour",822610.0],["race",822059.0],["our",820522.0],["never",820065.0],["rd3",819739.0],["eastern",819476.0],["writer",819422.0],["rugby",819286.0],["run",817196.0],["africa",814611.0],["iran",813993.0],["parliament",813743.0],["henry",812164.0],["production",810255.0],["1985",808914.0],["airport",808173.0],["producer",807748.0],["ice",807627.0],["southern",807352.0],["match",801361.0],["role",801238.0],["singles",799426.0],["containing",799100.0],["zealand",798759.0],["quality",797577.0],["received",796732.0],["done",794648.0],["featured",794336.0],["checked",793789.0],["archived",793375.0],["1980",793106.0],["standard",792157.0],["nat",791438.0],["real",790154.0],["chart",788916.0],["self",788068.0],["cross",787739.0],["policy",786869.0],["points",786392.0],["according",785951.0],["valign",784460.0],["aircraft",784311.0],["height",782932.0],["professional",781468.0],["cat",780673.0],["listed",778966.0],["late",777638.0],["chicago",777163.0],["navy",775929.0],["lost",775865.0],["info",774674.0],["institute",774375.0],["board",773872.0],["978",773489.0],["notability",771173.0],["period",769964.0],["civil",769843.0],["fullurl",769450.0],["million",768749.0],["cgi",767575.0],["81",766218.0],["father",764778.0],["minister",764253.0],["florida",764148.0],["events",763610.0],["served",762995.0],["1982",761788.0],["dates",759822.0],["various",757786.0],["centre",757225.0],["1983",755774.0],["66",754650.0],["students",754042.0],["mdash",753146.0],["among",752857.0],["say",752414.0],["light",750458.0],["win",750052.0],["six",747663.0],["night",747648.0],["dead",747614.0],["85",746259.0],["making",744959.0],["teams",744012.0],["wales",742696.0],["82",742235.0],["design",738282.0],["length",736716.0],["true",734826.0],["72",734016.0],["76",732668.0],["common",730831.0],["modern",728652.0],["65",727772.0],["christian",727628.0],["health",726816.0],["dr",725773.0],["et",725637.0],["spanish",724776.0],["revid",724415.0],["editsummary",723696.0],["wikidomain",723553.0],["sortdomain",723203.0],["origdiff",723203.0],["coiflag",723203.0],["usercount",722965.0],["van",722950.0],["blacklisteduser",722921.0],["blackreason",722921.0],["whitereason",722921.0],["ft",722582.0],["95",721705.0],["71",720957.0],["lead",720437.0],["1981",718553.0],["italy",718154.0],["geo",717012.0],["deaths",716013.0],["le",713927.0],["hill",712274.0],["birth_date",712065.0]],"arguments":{},"schema":[{"type":"string","name":"word"},{"type":"bigint","name":"count"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.416880346461E12,"submitTime":1.416880346027E12,"finishTime":1.416880483046E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"520.0","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"d05a9a1e-d143-4ef3-86b9-7f75b1eb3ab8"},{"version":"CommandV1","origId":3390,"guid":"3f228186-7bd4-4a8f-8806-f8bb49655cab","subtype":"command","commandType":"auto","position":7.75,"command":"%md\n\n### **Step 3:** Create a World Graph that displays the number of articles that mention each country.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.426530677175E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"14f999f6-d869-419f-8202-79da874544ec"},{"version":"CommandV1","origId":3391,"guid":"f2689e9e-4f12-41f9-85e8-efe6d2482361","subtype":"command","commandType":"auto","position":8.75,"command":"// Pull in the ISO-3166 country codes and mappings.\nimport au.com.bytecode.opencsv.CSVReader\nimport java.net.URL\nimport java.io.File\nimport java.io.FileReader\nimport org.apache.commons.io.FileUtils\n\nval tmpFile = new File(\"/tmp/countries.csv\")\nFileUtils.copyURLToFile(new URL(\"https://commondatastorage.googleapis.com/ckannet-storage/2011-11-25T132653/iso_3166_2_countries.csv\"), tmpFile)\nval lines = new CSVReader(new FileReader(\"/tmp/countries.csv\"), ',', '\"').readAll()\ntmpFile.delete()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import au.com.bytecode.opencsv.CSVReader\nimport java.net.URL\nimport java.io.File\nimport java.io.FileReader\nimport org.apache.commons.io.FileUtils\ntmpFile: java.io.File = /tmp/countries.csv\nlines: java.util.List[Array[String]] = [[Ljava.lang.String;@75ad928e, [Ljava.lang.String;@5670e4fd, [Ljava.lang.String;@dc9ca61, [Ljava.lang.String;@3b05ad59, [Ljava.lang.String;@71b7cc54, [Ljava.lang.String;@59c7d91f, [Ljava.lang.String;@4f7fb045, [Ljava.lang.String;@480daac9, [Ljava.lang.String;@79479713, [Ljava.lang.String;@4b0f9e99, [Ljava.lang.String;@6e75754e, [Ljava.lang.String;@61688c89, [Ljava.lang.String;@16e2a855, [Ljava.lang.String;@7a99702f, [Ljava.lang.String;@6f945c8a, [Ljava.lang.String;@7547a140, [Ljava.lang.String;@31abace7, [Ljava.lang.String;@7de48b2a, [Ljava.lang.String;@276cb2f8, [Ljava.lang.String;@5159cc00, [Ljava.lang.String;@5e603db9, [Ljava.lang.String;@746d17, [Ljava.lang.String;@5ba6013c, [Ljava.lang.String;@6f9b3925, [Ljava.lang.String;@37c4e561, [Ljava.lang.String;@5faf5fe1, [Ljava.lang.String;@72bfddda, [Ljava.lang.String;@127e4e11, [Ljava.lang.String;@22374793, [Ljava.lang.String;@5b3c1571, [Ljava.lang.String;@45a3dc82, [Ljava.lang.String;@8e1fe86, [Ljava.lang.String;@2d0d13f8, [Ljava.lang.String;@359a15e3, [Ljava.lang.String;@17130593, [Ljava.lang.String;@61d301ba, [Ljava.lang.String;@64168c82, [Ljava.lang.String;@462de24, [Ljava.lang.String;@76e60fbb, [Ljava.lang.String;@7a12faf8, [Ljava.lang.String;@741aee64, [Ljava.lang.String;@141922c9, [Ljava.lang.String;@7e3ac46d, [Ljava.lang.String;@443610d9, [Ljava.lang.String;@398c398b, [Ljava.lang.String;@2515f231, [Ljava.lang.String;@43cf81fc, [Ljava.lang.String;@6c5eea2b, [Ljava.lang.String;@4b5fe4a2, [Ljava.lang.String;@49b6e57, [Ljava.lang.String;@7869141d, [Ljava.lang.String;@3aa7b9ad, [Ljava.lang.String;@598f2af0, [Ljava.lang.String;@464c207f, [Ljava.lang.String;@2fe995e7, [Ljava.lang.String;@10708944, [Ljava.lang.String;@4c43d7ca, [Ljava.lang.String;@7a0c35e3, [Ljava.lang.String;@37a608ae, [Ljava.lang.String;@7583f40c, [Ljava.lang.String;@2a0b7c1a, [Ljava.lang.String;@5800a486, [Ljava.lang.String;@1231868d, [Ljava.lang.String;@71789c4f, [Ljava.lang.String;@255e40bc, [Ljava.lang.String;@4eec09ce, [Ljava.lang.String;@6a77dbdc, [Ljava.lang.String;@63037f1f, [Ljava.lang.String;@7a8eff01, [Ljava.lang.String;@4207d983, [Ljava.lang.String;@11594953, [Ljava.lang.String;@7cdcf10a, [Ljava.lang.String;@d550791, [Ljava.lang.String;@4963c76d, [Ljava.lang.String;@35b9eabf, [Ljava.lang.String;@40e2bd27, [Ljava.lang.String;@65f06cb8, [Ljava.lang.String;@b71d851, [Ljava.lang.String;@5f30b3b5, [Ljava.lang.String;@766660e5, [Ljava.lang.String;@3b63971d, [Ljava.lang.String;@7560f61, [Ljava.lang.String;@230bad0a, [Ljava.lang.String;@538d7d7f, [Ljava.lang.String;@6e2a47b3, [Ljava.lang.String;@19c97146, [Ljava.lang.String;@782bb7e3, [Ljava.lang.String;@7e35d5b7, [Ljava.lang.String;@62221d, [Ljava.lang.String;@2aad9e1d, [Ljava.lang.String;@6c6797ce, [Ljava.lang.String;@51f8cfc, [Ljava.lang.String;@5a60f704, [Ljava.lang.String;@13f955f7, [Ljava.lang.String;@567ad55f, [Ljava.lang.String;@1a4e7c54, [Ljava.lang.String;@16c47c4a, [Ljava.lang.String;@3dbbe9f3, [Ljava.lang.String;@7bfc702e, [Ljava.lang.String;@7a291b99, [Ljava.lang.String;@20d31877, [Ljava.lang.String;@2eb3d77, [Ljava.lang.String;@22105120, [Ljava.lang.String;@5d3e1d58, [Ljava.lang.String;@18f8ac3b, [Ljava.lang.String;@6df3624b, [Ljava.lang.String;@5ba6252, [Ljava.lang.String;@f8cf86e, [Ljava.lang.String;@700a05bb, [Ljava.lang.String;@21fe7174, [Ljava.lang.String;@47ca881b, [Ljava.lang.String;@41adc96f, [Ljava.lang.String;@7883b818, [Ljava.lang.String;@fab6d78, [Ljava.lang.String;@3f9fe951, [Ljava.lang.String;@1b8ee579, [Ljava.lang.String;@427b7911, [Ljava.lang.String;@38496d30, [Ljava.lang.String;@5c9f872e, [Ljava.lang.String;@6d640c83, [Ljava.lang.String;@4371a490, [Ljava.lang.String;@59eb0c87, [Ljava.lang.String;@5683a12f, [Ljava.lang.String;@5bcb4108, [Ljava.lang.String;@7d1aa34c, [Ljava.lang.String;@5fd712be, [Ljava.lang.String;@210fa91a, [Ljava.lang.String;@b26faeb, [Ljava.lang.String;@2c236005, [Ljava.lang.String;@4674fee6, [Ljava.lang.String;@2b0ad22d, [Ljava.lang.String;@536c9e6e, [Ljava.lang.String;@15728c, [Ljava.lang.String;@13455f, [Ljava.lang.String;@712f6002, [Ljava.lang.String;@5d485d5b, [Ljava.lang.String;@39e93135, [Ljava.lang.String;@7c9dac46, [Ljava.lang.String;@53996794, [Ljava.lang.String;@7c5f506c, [Ljava.lang.String;@5599223e, [Ljava.lang.String;@38974059, [Ljava.lang.String;@5201b015, [Ljava.lang.String;@6ccf5cc2, [Ljava.lang.String;@21d2fc5d, [Ljava.lang.String;@22b64f04, [Ljava.lang.String;@6efda169, [Ljava.lang.String;@4d702d6c, [Ljava.lang.String;@7fb6352b, [Ljava.lang.String;@135cdb8e, [Ljava.lang.String;@35525190, [Ljava.lang.String;@2f68e049, [Ljava.lang.String;@e5cf0f0, [Ljava.lang.String;@77ce23ed, [Ljava.lang.String;@7e98da0d, [Ljava.lang.String;@6513cc69, [Ljava.lang.String;@76d13556, [Ljava.lang.String;@2104de0b, [Ljava.lang.String;@468db51c, [Ljava.lang.String;@16d6574, [Ljava.lang.String;@351fa367, [Ljava.lang.String;@3020da70, [Ljava.lang.String;@3ce507bf, [Ljava.lang.String;@605fabd4, [Ljava.lang.String;@290a1cba, [Ljava.lang.String;@56e40c62, [Ljava.lang.String;@15e9227f, [Ljava.lang.String;@7cd7cb15, [Ljava.lang.String;@3b560fbb, [Ljava.lang.String;@f22dc6c, [Ljava.lang.String;@39b53e37, [Ljava.lang.String;@2a07aa7a, [Ljava.lang.String;@5d494524, [Ljava.lang.String;@755a6e54, [Ljava.lang.String;@40188fd, [Ljava.lang.String;@c89c19, [Ljava.lang.String;@72802db5, [Ljava.lang.String;@3d3900cd, [Ljava.lang.String;@6963b221, [Ljava.lang.String;@1043ca95, [Ljava.lang.String;@52a9048a, [Ljava.lang.String;@56692a6b, [Ljava.lang.String;@1260031f, [Ljava.lang.String;@5d6cf1a5, [Ljava.lang.String;@1b6cb78e, [Ljava.lang.String;@7e86d9b2, [Ljava.lang.String;@473e7603, [Ljava.lang.String;@55b5e37f, [Ljava.lang.String;@186ad2cf, [Ljava.lang.String;@d36208f, [Ljava.lang.String;@5c93930f, [Ljava.lang.String;@5c9bed44, [Ljava.lang.String;@f63adc, [Ljava.lang.String;@25924202, [Ljava.lang.String;@252ba493, [Ljava.lang.String;@5441c1f5, [Ljava.lang.String;@2924e70a, [Ljava.lang.String;@35bc56a0, [Ljava.lang.String;@5fdb3def, [Ljava.lang.String;@32bf4713, [Ljava.lang.String;@2bd34a6c, [Ljava.lang.String;@3cbb0eee, [Ljava.lang.String;@1cd14a68, [Ljava.lang.String;@706c009f, [Ljava.lang.String;@429d0062, [Ljava.lang.String;@51844418, [Ljava.lang.String;@4292ad77, [Ljava.lang.String;@2bba81c6, [Ljava.lang.String;@619e0497, [Ljava.lang.String;@4d3f8792, [Ljava.lang.String;@5dda9dd, [Ljava.lang.String;@1bbaef2d, [Ljava.lang.String;@dac8194, [Ljava.lang.String;@386f228f, [Ljava.lang.String;@845f73b, [Ljava.lang.String;@296a46bb, [Ljava.lang.String;@49b43b, [Ljava.lang.String;@66d78da2, [Ljava.lang.String;@5193bb6d, [Ljava.lang.String;@39f61af2, [Ljava.lang.String;@4c632398, [Ljava.lang.String;@b5f756, [Ljava.lang.String;@2a812f77, [Ljava.lang.String;@753436e, [Ljava.lang.String;@6b6fee83, [Ljava.lang.String;@1941190, [Ljava.lang.String;@200d05bf, [Ljava.lang.String;@36f44f09, [Ljava.lang.String;@6170f40e, [Ljava.lang.String;@3ea6f51c, [Ljava.lang.String;@43262166, [Ljava.lang.String;@7c5ad1fa, [Ljava.lang.String;@2e8fb3de, [Ljava.lang.String;@5c69cbb3, [Ljava.lang.String;@25bc842b, [Ljava.lang.String;@7b893667, [Ljava.lang.String;@6d52e38d, [Ljava.lang.String;@5cd9760d, [Ljava.lang.String;@48d57f1a, [Ljava.lang.String;@388ba951, [Ljava.lang.String;@591921d7, [Ljava.lang.String;@fcd7f4, [Ljava.lang.String;@57c5d4ad, [Ljava.lang.String;@7d0dd6df, [Ljava.lang.String;@17960a9d, [Ljava.lang.String;@7b92d583, [Ljava.lang.String;@64ffcad6, [Ljava.lang.String;@555ddb67, [Ljava.lang.String;@4ef72fa, [Ljava.lang.String;@4657d9e, [Ljava.lang.String;@231a1253, [Ljava.lang.String;@4a91926, [Ljava.lang.String;@79b2102d, [Ljava.lang.String;@194438c6, [Ljava.lang.String;@4deb5c1f, [Ljava.lang.String;@16ed1f30, [Ljava.lang.String;@299a9412, [Ljava.lang.String;@636f3f14, [Ljava.lang.String;@1c966d0c, [Ljava.lang.String;@57d13d7d, [Ljava.lang.String;@6a1c0695, [Ljava.lang.String;@55f4569f, [Ljava.lang.String;@1c630ccf, [Ljava.lang.String;@2addf898, [Ljava.lang.String;@52ebd924, [Ljava.lang.String;@79fcf503, [Ljava.lang.String;@4e39d686, [Ljava.lang.String;@37331f89, [Ljava.lang.String;@7d5b77ae]\nres7: Boolean = true\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828217896E12,"submitTime":1.427828217829E12,"finishTime":1.427828218394E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"a1766211-ab6c-41ab-9a2a-bfbf61e62add"},{"version":"CommandV1","origId":3392,"guid":"459a51f8-31a2-4ddb-8d0c-cffb8c391409","subtype":"command","commandType":"auto","position":9.25,"command":"val headerLine = lines.remove(0)\n(headerLine(1), headerLine(11))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">headerLine: Array[String] = Array(Sort Order, Common Name, Formal Name, Type, Sub Type, Sovereignty, Capital, ISO 4217 Currency Code, ISO 4217 Currency Name, ITU-T Telephone Code, ISO 3166-1 2 Letter Code, ISO 3166-1 3 Letter Code, ISO 3166-1 Number, IANA Country Code TLD)\nres8: (String, String) = (Common Name,ISO 3166-1 3 Letter Code)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828224622E12,"submitTime":1.427828224556E12,"finishTime":1.427828224859E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"82646cad-665a-49f1-973d-4d9e79ca2ce5"},{"version":"CommandV1","origId":3393,"guid":"525628c4-c0da-44cd-a2c4-a35efe9600df","subtype":"command","commandType":"auto","position":9.375,"command":"// This data is crudely cleaned - this could be done better.\nimport scala.collection.mutable.HashMap\n\nval countryDict = new HashMap[String, String]()\nfor (i <- 1 until lines.size()) {\n  val line = lines.get(i)\n  var countryName = line(1)\n  if (countryName.indexOfSlice(\"Taiwan\") >= 0) {\n    countryName = \"Taiwan\"\n  } else if (countryName.indexOfSlice(\"Korea, North\") >= 0) {\n    countryName = \"North Korea\"\n  } else if (countryName.indexOfSlice(\"Korea, South\") >= 0) {\n    countryName = \"South Korea\"\n  }\n  countryName = countryName.split(\",\")(0)\n  countryName = countryName.split(\"[(]\")(0)\n  val code = line(11)\n  if (!code.equals(\"\") && !code.equals(\"ANT\") && !code.equals(\"TAA\") && !code.equals(\"ASC\")) {\n    countryDict += (countryName -> code)\n  }\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import scala.collection.mutable.HashMap\ncountryDict: scala.collection.mutable.HashMap[String,String] = Map(Azerbaijan -&gt; AZE, Saint Kitts and Nevis -&gt; KNA, Egypt -&gt; EGY, Saudi Arabia -&gt; SAU, British Virgin Islands -&gt; VGB, Turkmenistan -&gt; TKM, Christmas Island -&gt; CXR, Brazil -&gt; BRA, Nagorno-Karabakh -&gt; AZE, Senegal -&gt; SEN, Kuwait -&gt; KWT, Ashmore and Cartier Islands -&gt; AUS, Austria -&gt; AUT, South Africa -&gt; ZAF, Vietnam -&gt; VNM, Canada -&gt; CAN, Tokelau -&gt; TKL, Niue -&gt; NIU, Saint Pierre and Miquelon -&gt; SPM, Eritrea -&gt; ERI, Switzerland -&gt; CHE, Qatar -&gt; QAT, Slovenia -&gt; SVN, Australia -&gt; AUS, Taiwan -&gt; TWN, Johnston Atoll -&gt; UMI, Palmyra Atoll -&gt; UMI, Sao Tome and Principe -&gt; STP, Mongolia -&gt; MNG, Reunion -&gt; REU, Belarus -&gt; BLR, Central African Republic -&gt; CAF, Gibraltar -&gt; GIB, Comoros -&gt; COM, Uganda -&gt; UGA, Tanzania -&gt; TZA, Macedonia -&gt; MKD, Panama -&gt; PAN, Pitcairn Islands -&gt; PCN, &quot;Falkland Islands &quot; -&gt; FLK, Costa Rica -&gt; CRI, Luxembourg -&gt; LUX, Belgium -&gt; BEL, French Guiana -&gt; GUF, French Polynesia -&gt; PYF, Norfolk Island -&gt; NFK, Heard Island and McDonald Islands -&gt; HMD, Romania -&gt; ROU, Saint Helena -&gt; SHN, Bouvet Island -&gt; BVT, Slovakia -&gt; SVK, Tunisia -&gt; TUN, Morocco -&gt; MAR, Niger -&gt; NER, Congo -&gt; COG, Mauritius -&gt; MUS, Gambia -&gt; GMB, Guam -&gt; GUM, Thailand -&gt; THA, Ghana -&gt; GHA, Monaco -&gt; MCO, Argentina -&gt; ARG, Faroe Islands -&gt; FRO, Solomon Islands -&gt; SLB, Australian Antarctic Territory -&gt; ATA, Aruba -&gt; ABW, Malawi -&gt; MWI, Saint Martin -&gt; GLP, Sudan -&gt; SDN, Papua New Guinea -&gt; PNG, Lesotho -&gt; LSO, Mali -&gt; MLI, Tonga -&gt; TON, Saint Barthelemy -&gt; GLP, Dominica -&gt; DMA, Cape Verde -&gt; CPV, Peru -&gt; PER, Honduras -&gt; HND, South Korea -&gt; KOR, Laos -&gt; LAO, Zimbabwe -&gt; ZWE, Northern Cyprus -&gt; CYP, Kiribati -&gt; KIR, Maldives -&gt; MDV, Seychelles -&gt; SYC, Vanuatu -&gt; VUT, Yemen -&gt; YEM, Bahamas -&gt; BHS, British Indian Ocean Territory -&gt; IOT, Brunei -&gt; BRN, Norway -&gt; NOR, Guadeloupe -&gt; GLP, Kingman Reef -&gt; UMI, Montserrat -&gt; MSR, Greenland -&gt; GRL, North Korea -&gt; PRK, Madagascar -&gt; MDG, Guatemala -&gt; GTM, San Marino -&gt; SMR, Malta -&gt; MLT, Germany -&gt; DEU, Nigeria -&gt; NGA, France -&gt; FRA, New Caledonia -&gt; NCL, Northern Mariana Islands -&gt; MNP, Ireland -&gt; IRL, Cyprus -&gt; CYP, Italy -&gt; ITA, French Southern and Antarctic Lands -&gt; ATF, Venezuela -&gt; VEN, Baker Island -&gt; UMI, Somaliland -&gt; SOM, Kyrgyzstan -&gt; KGZ, Kenya -&gt; KEN, Pakistan -&gt; PAK, Bhutan -&gt; BTN, Bangladesh -&gt; BGD, Czech Republic -&gt; CZE, Benin -&gt; BEN, Palau -&gt; PLW, Midway Islands -&gt; UMI, Marshall Islands -&gt; MHL, Martinique -&gt; MTQ, &quot;Cote d'Ivoire &quot; -&gt; CIV, Poland -&gt; POL, British Antarctic Territory -&gt; ATA, Howland Island -&gt; UMI, Estonia -&gt; EST, Burundi -&gt; BDI, Uruguay -&gt; URY, Ecuador -&gt; ECU, Ukraine -&gt; UKR, Coral Sea Islands -&gt; AUS, Cayman Islands -&gt; CYM, Haiti -&gt; HTI, Dominican Republic -&gt; DOM, Guinea-Bissau -&gt; GNB, Denmark -&gt; DNK, Saint Lucia -&gt; LCA, Sri Lanka -&gt; LKA, Guernsey -&gt; GGY, China -&gt; CHN, Isle of Man -&gt; IMN, Zambia -&gt; ZMB, Grenada -&gt; GRD, Puerto Rico -&gt; PRI, Kazakhstan -&gt; KAZ, Turks and Caicos Islands -&gt; TCA, Liberia -&gt; LBR, El Salvador -&gt; SLV, Russia -&gt; RUS, Bahrain -&gt; BHR, Svalbard -&gt; SJM, Liechtenstein -&gt; LIE, Greece -&gt; GRC, Suriname -&gt; SUR, Portugal -&gt; PRT, Aland -&gt; ALA, Bulgaria -&gt; BGR, Bosnia and Herzegovina -&gt; BIH, Somalia -&gt; SOM, Iceland -&gt; ISL, Sweden -&gt; SWE, United Arab Emirates -&gt; ARE, Netherlands -&gt; NLD, Ethiopia -&gt; ETH, Philippines -&gt; PHL, United States -&gt; USA, Colombia -&gt; COL, Oman -&gt; OMN, Swaziland -&gt; SWZ, Samoa -&gt; WSM, Turkey -&gt; TUR, Wallis and Futuna -&gt; WLF, Lithuania -&gt; LTU, Trinidad and Tobago -&gt; TTO, India -&gt; IND, Anguilla -&gt; AIA, Djibouti -&gt; DJI, Macau -&gt; MAC, Navassa Island -&gt; UMI, Nepal -&gt; NPL, Cook Islands -&gt; COK, Latvia -&gt; LVA, Hungary -&gt; HUN, Antigua and Barbuda -&gt; ATG, Libya -&gt; LBY, Chad -&gt; TCD, Algeria -&gt; DZA, Jordan -&gt; JOR, Gabon -&gt; GAB, Paraguay -&gt; PRY, Lebanon -&gt; LBN, Togo -&gt; TGO, Fiji -&gt; FJI, Vatican City -&gt; VAT, Sierra Leone -&gt; SLE, &quot;Myanmar &quot; -&gt; MMR, Mauritania -&gt; MRT, South Ossetia -&gt; GEO, American Samoa -&gt; ASM, Uzbekistan -&gt; UZB, South Georgia &amp; South Sandwich Islands -&gt; SGS, Guyana -&gt; GUY, Saint Vincent and the Grenadines -&gt; VCT, Tuvalu -&gt; TUV, Nauru -&gt; NRU, Spain -&gt; ESP, &quot;Timor-Leste &quot; -&gt; TLS, Albania -&gt; ALB, Namibia -&gt; NAM, Syria -&gt; SYR, Mexico -&gt; MEX, Serbia -&gt; SRB, Iraq -&gt; IRQ, Cameroon -&gt; CMR, Guinea -&gt; GIN, New Zealand -&gt; NZL, Belize -&gt; BLZ, Chile -&gt; CHL, &quot;Cocos &quot; -&gt; CCK, Armenia -&gt; ARM, Botswana -&gt; BWA, Hong Kong -&gt; HKG, Israel -&gt; ISR, Croatia -&gt; HRV, U.S. Virgin Islands -&gt; VIR, Cuba -&gt; CUB, Rwanda -&gt; RWA, Jarvis Island -&gt; UMI, Malaysia -&gt; MYS, United Kingdom -&gt; GBR, Ross Dependency -&gt; ATA, Jersey -&gt; JEY, Burkina Faso -&gt; BFA, Singapore -&gt; SGP, Equatorial Guinea -&gt; GNQ, Cambodia -&gt; KHM, Mozambique -&gt; MOZ, Bermuda -&gt; BMU, Montenegro -&gt; MNE, Georgia -&gt; GEO, Japan -&gt; JPN, Mayotte -&gt; MYT, Finland -&gt; FIN, Abkhazia -&gt; GEO, Queen Maud Land -&gt; ATA, Moldova -&gt; MDA, Tajikistan -&gt; TJK, Andorra -&gt; AND, Peter I Island -&gt; ATA, Barbados -&gt; BRB, Nicaragua -&gt; NIC, Clipperton Island -&gt; PYF, &quot;Pridnestrovie &quot; -&gt; MDA, Micronesia -&gt; FSM, Indonesia -&gt; IDN, Wake Island -&gt; UMI, Jamaica -&gt; JAM, Iran -&gt; IRN, Bolivia -&gt; BOL, Angola -&gt; AGO)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828227409E12,"submitTime":1.427828227084E12,"finishTime":1.4278282278E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"84cd0a5a-f045-4a35-b331-784284d95638"},{"version":"CommandV1","origId":3394,"guid":"2b60faa7-82a8-47d1-91fd-6ba9df60682a","subtype":"command","commandType":"auto","position":9.5,"command":"// Create a function that figures out what countries are mentioned in an string.\nimport scala.collection.mutable.ArrayBuffer\n\nval getCountryCount = (text: String) => {\n  val countryCounts = ArrayBuffer[Tuple2[String, Long]]()\n  for (key <- countryDict.keys) {\n    if (text != null && text.indexOfSlice(key) >= 0) {\n      countryCounts += new Tuple2(countryDict(key), 1)\n    }\n  }\n  countryCounts.toArray\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import scala.collection.mutable.ArrayBuffer\ngetCountryCount: String =&gt; Array[(String, Long)] = &lt;function1&gt;\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828231933E12,"submitTime":1.427828231644E12,"finishTime":1.427828232193E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"3eec7cf8-c048-4d89-b2d8-e7abdb633ed6"},{"version":"CommandV1","origId":3395,"guid":"14c58fae-ca65-439e-9bf3-45dee1702c42","subtype":"command","commandType":"auto","position":12.375,"command":"// Calculate the country counts and register that as a temporary table so SQL queries can be done against it.\ncase class CountryCodeCounts(countryCode: String, articleCount: Long)\n\nval countryCountsRdd = (sqlContext.sql(\"select text from wikipedia\").rdd\n  .flatMap(row => getCountryCount(row.getString(0)))\n  .reduceByKey(_ + _)\n  .map(t => CountryCodeCounts(t._1, t._2))).toDF()\n\ncountryCountsRdd.registerTempTable(\"wikipedia_country_counts\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class CountryCodeCounts\ncountryCountsRdd: org.apache.spark.sql.DataFrame = [countryCode: string, articleCount: bigint]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.427828241609E12,"submitTime":1.427828241412E12,"finishTime":1.427828242218E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"f5cc596f-c8f3-436d-8043-f7ee2f04c8bd"},{"version":"CommandV1","origId":3396,"guid":"13b45fc9-7a6e-4a6a-83df-83a936615d6a","subtype":"command","commandType":"auto","position":13.375,"command":"%sql CACHE TABLE wikipedia_country_counts","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.416887010331E12,"submitTime":1.416887009643E12,"finishTime":1.416891210285E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"22229090-1da9-4d92-9e67-4c9ffe772626"},{"version":"CommandV1","origId":3397,"guid":"aa04a3d5-e5d0-4729-8abc-7696c2f84057","subtype":"command","commandType":"auto","position":14.375,"command":"%sql select countryCode, articleCount from wikipedia_country_counts order by articleCount desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",1329842.0],["IND",578918.0],["FRA",471081.0],["AUS",458767.0],["CAN",393932.0],["GBR",391382.0],["DEU",383046.0],["JPN",382923.0],["RUS",293819.0],["CHN",249881.0],["ITA",246663.0],["IRL",212272.0],["ESP",198881.0],["MEX",178148.0],["POL",176067.0],["GEO",170431.0],["NZL",160934.0],["BRA",152073.0],["IRN",150379.0],["NLD",144560.0],["AUT",143740.0],["SWE",133551.0],["JEY",133475.0],["ISR",121664.0],["ZAF",121650.0],["CHE",111121.0],["NOR",110458.0],["GRC",100779.0],["TUR",100746.0],["BEL",99233.0],["EGY",95278.0],["ROU",92303.0],["DNK",89744.0],["PAK",87173.0],["JOR",84363.0],["ARG",84163.0],["PHL",83751.0],["HUN",81961.0],["PRT",81869.0],["FIN",75968.0],["HKG",74861.0],["VNM",73558.0],["IDN",71230.0],["SRB",69581.0],["KOR",69107.0],["MLI",67861.0],["SGP",65819.0],["MYS",65490.0],["PER",64426.0],["HRV",62515.0],["CHL",61569.0],["UKR",61298.0],["BGR",61161.0],["IRQ",61016.0],["CZE",56029.0],["THA",55854.0],["CUB",55608.0],["COL",54874.0],["TWN",52235.0],["NER",51373.0],["GIN",48035.0],["LKA",46608.0],["SYR",46401.0],["VEN",44388.0],["TCD",44206.0],["AZE",43878.0],["SVN",43765.0],["NGA",43542.0],["LTU",42929.0],["ARM",40614.0],["EST",40294.0],["KEN",39090.0],["LBN",36898.0],["JAM",36572.0],["SVK",36414.0],["ISL",36367.0],["BGD",36329.0],["PRI",35646.0],["COG",34903.0],["ALB",34732.0],["PAN",33963.0],["CYP",33345.0],["MKD",33297.0],["MAR",33177.0],["DMA",33111.0],["NPL",32016.0],["DZA",31933.0],["ECU",31817.0],["LVA",30714.0],["URY",30104.0],["LUX",30020.0],["ETH",29271.0],["BLR",28802.0],["SAU",27552.0],["MLT",26639.0],["BOL",26606.0],["GHA",26527.0],["SDN",25419.0],["BIH",25267.0],["TZA",23945.0],["CRI",23748.0],["LBY",23152.0],["TUN",23108.0],["ZWE",23023.0],["UGA",22799.0],["KAZ",22304.0],["GTM",22013.0],["HTI",21810.0],["MNG",21221.0],["MNE",21183.0],["MDG",20915.0],["CMR",20424.0],["KHM",20200.0],["PRY",20051.0],["ARE",19514.0],["AGO",19296.0],["DOM",19165.0],["QAT",19092.0],["MCO",19010.0],["PRK",18647.0],["MDA",18339.0],["KWT",18321.0],["YEM",18105.0],["SOM",17627.0],["FJI",17309.0],["NIC",16754.0],["PNG",16674.0],["HND",16648.0],["SEN",16435.0],["WSM",15618.0],["MAC",15583.0],["OMN",15395.0],["NAM",15284.0],["GIB",14755.0],["SLV",14563.0],["BHR",14557.0],["BMU",14435.0],["ZMB",14330.0],["MOZ",14035.0],["TTO",13964.0],["REU",13882.0],["BHS",13711.0],["UZB",13576.0],["LBR",13095.0],["LAO",12958.0],["SLE",12774.0],["RWA",12398.0],["BRB",12327.0],["GRL",12165.0],["MUS",12149.0],["GUY",12063.0],["TON",11908.0],["BEN",11612.0],["GUM",11584.0],["MWI",10956.0],["BFA",10682.0],["TGO",10444.0],["GAB",10122.0],["BWA",10037.0],["BRN",9995.0],["BLZ",9919.0],["IMN",9872.0],["BTN",9795.0],["KGZ",9707.0],["SMR",9266.0],["SLB",9266.0],["GLP",9150.0],["LIE",9037.0],["TJK",8793.0],["CPV",8709.0],["GMB",8257.0],["SUR",8201.0],["TKM",7895.0],["PLW",7790.0],["MRT",7708.0],["ERI",7705.0],["MDV",7648.0],["AND",7639.0],["BDI",7551.0],["NCL",7460.0],["CAF",7447.0],["GRD",7390.0],["SYC",7031.0],["FRO",6464.0],["SWZ",6203.0],["GGY",6172.0],["LSO",6088.0],["VUT",6062.0],["FSM",5979.0],["MMR",5930.0],["GNQ",5859.0],["DJI",5463.0],["MTQ",5423.0],["VAT",5405.0],["ATA",5355.0],["GNB",5204.0],["ATG",5202.0],["MHL",5043.0],["MSR",5039.0],["ABW",5005.0],["GUF",4943.0],["LCA",4915.0],["COK",4819.0],["COM",4721.0],["CYM",4693.0],["ASM",4506.0],["PYF",4273.0],["UMI",4064.0],["VCT",3973.0],["NRU",3966.0],["KNA",3941.0],["TUV",3635.0],["KIR",3600.0],["ALA",3581.0],["FLK",3564.0],["VGB",3556.0],["VIR",3424.0],["AIA",3243.0],["SHN",3021.0],["MNP",3008.0],["SJM",2867.0],["NIU",2504.0],["TCA",2466.0],["NFK",2299.0],["MYT",2020.0],["CXR",1885.0],["CCK",1865.0],["WLF",1564.0],["TKL",1467.0],["PCN",1322.0],["SPM",1298.0],["STP",811.0],["IOT",721.0],["TLS",696.0],["HMD",512.0],["BVT",415.0],["ATF",409.0],["CIV",244.0],["SGS",5.0]],"arguments":{},"schema":[{"type":"string","name":"countryCode"},{"type":"bigint","name":"articleCount"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.416891210298E12,"submitTime":1.416887010457E12,"finishTime":1.416891210961E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"157e34c4-a243-4535-9870-fbd43d41a600"},{"version":"CommandV1","origId":3398,"guid":"bb6bf447-da6f-4d4a-bef6-da3e69e0a791","subtype":"command","commandType":"auto","position":15.375,"command":"%sql\n-- Display the results in a world map.\n-- Since the results are so skewed and the world map breaks out evenly space intervals,\n-- a function is applied to smooth the results for better viewing.\nselect countryCode, IF(articleCount > 100000, articleCount/10 + 100000, articleCount) as smoothedArticleCount from wikipedia_country_counts order by countryCode","commandVersion":0,"state":"finished","results":{"type":"table","data":[["ABW",5005.0],["AGO",19296.0],["AIA",3243.0],["ALA",3581.0],["ALB",34732.0],["AND",7639.0],["ARE",19514.0],["ARG",84163.0],["ARM",40614.0],["ASM",4506.0],["ATA",5355.0],["ATF",409.0],["ATG",5202.0],["AUS",145876.7],["AUT",114374.0],["AZE",43878.0],["BDI",7551.0],["BEL",99233.0],["BEN",11612.0],["BFA",10682.0],["BGD",36329.0],["BGR",61161.0],["BHR",14557.0],["BHS",13711.0],["BIH",25267.0],["BLR",28802.0],["BLZ",9919.0],["BMU",14435.0],["BOL",26606.0],["BRA",115207.3],["BRB",12327.0],["BRN",9995.0],["BTN",9795.0],["BVT",415.0],["BWA",10037.0],["CAF",7447.0],["CAN",139393.2],["CCK",1865.0],["CHE",111112.1],["CHL",61569.0],["CHN",124988.1],["CIV",244.0],["CMR",20424.0],["COG",34903.0],["COK",4819.0],["COL",54874.0],["COM",4721.0],["CPV",8709.0],["CRI",23748.0],["CUB",55608.0],["CXR",1885.0],["CYM",4693.0],["CYP",33345.0],["CZE",56029.0],["DEU",138304.6],["DJI",5463.0],["DMA",33111.0],["DNK",89744.0],["DOM",19165.0],["DZA",31933.0],["ECU",31817.0],["EGY",95278.0],["ERI",7705.0],["ESP",119888.1],["EST",40294.0],["ETH",29271.0],["FIN",75968.0],["FJI",17309.0],["FLK",3564.0],["FRA",147108.1],["FRO",6464.0],["FSM",5979.0],["GAB",10122.0],["GBR",139138.2],["GEO",117043.1],["GGY",6172.0],["GHA",26527.0],["GIB",14755.0],["GIN",48035.0],["GLP",9150.0],["GMB",8257.0],["GNB",5204.0],["GNQ",5859.0],["GRC",110077.9],["GRD",7390.0],["GRL",12165.0],["GTM",22013.0],["GUF",4943.0],["GUM",11584.0],["GUY",12063.0],["HKG",74861.0],["HMD",512.0],["HND",16648.0],["HRV",62515.0],["HTI",21810.0],["HUN",81961.0],["IDN",71230.0],["IMN",9872.0],["IND",157891.8],["IOT",721.0],["IRL",121227.2],["IRN",115037.9],["IRQ",61016.0],["ISL",36367.0],["ISR",112166.4],["ITA",124666.3],["JAM",36572.0],["JEY",113347.5],["JOR",84363.0],["JPN",138292.3],["KAZ",22304.0],["KEN",39090.0],["KGZ",9707.0],["KHM",20200.0],["KIR",3600.0],["KNA",3941.0],["KOR",69107.0],["KWT",18321.0],["LAO",12958.0],["LBN",36898.0],["LBR",13095.0],["LBY",23152.0],["LCA",4915.0],["LIE",9037.0],["LKA",46608.0],["LSO",6088.0],["LTU",42929.0],["LUX",30020.0],["LVA",30714.0],["MAC",15583.0],["MAR",33177.0],["MCO",19010.0],["MDA",18339.0],["MDG",20915.0],["MDV",7648.0],["MEX",117814.8],["MHL",5043.0],["MKD",33297.0],["MLI",67861.0],["MLT",26639.0],["MMR",5930.0],["MNE",21183.0],["MNG",21221.0],["MNP",3008.0],["MOZ",14035.0],["MRT",7708.0],["MSR",5039.0],["MTQ",5423.0],["MUS",12149.0],["MWI",10956.0],["MYS",65490.0],["MYT",2020.0],["NAM",15284.0],["NCL",7460.0],["NER",51373.0],["NFK",2299.0],["NGA",43542.0],["NIC",16754.0],["NIU",2504.0],["NLD",114456.0],["NOR",111045.8],["NPL",32016.0],["NRU",3966.0],["NZL",116093.4],["OMN",15395.0],["PAK",87173.0],["PAN",33963.0],["PCN",1322.0],["PER",64426.0],["PHL",83751.0],["PLW",7790.0],["PNG",16674.0],["POL",117606.7],["PRI",35646.0],["PRK",18647.0],["PRT",81869.0],["PRY",20051.0],["PYF",4273.0],["QAT",19092.0],["REU",13882.0],["ROU",92303.0],["RUS",129381.9],["RWA",12398.0],["SAU",27552.0],["SDN",25419.0],["SEN",16435.0],["SGP",65819.0],["SGS",5.0],["SHN",3021.0],["SJM",2867.0],["SLB",9266.0],["SLE",12774.0],["SLV",14563.0],["SMR",9266.0],["SOM",17627.0],["SPM",1298.0],["SRB",69581.0],["STP",811.0],["SUR",8201.0],["SVK",36414.0],["SVN",43765.0],["SWE",113355.1],["SWZ",6203.0],["SYC",7031.0],["SYR",46401.0],["TCA",2466.0],["TCD",44206.0],["TGO",10444.0],["THA",55854.0],["TJK",8793.0],["TKL",1467.0],["TKM",7895.0],["TLS",696.0],["TON",11908.0],["TTO",13964.0],["TUN",23108.0],["TUR",110074.6],["TUV",3635.0],["TWN",52235.0],["TZA",23945.0],["UGA",22799.0],["UKR",61298.0],["UMI",4064.0],["URY",30104.0],["USA",232984.2],["UZB",13576.0],["VAT",5405.0],["VCT",3973.0],["VEN",44388.0],["VGB",3556.0],["VIR",3424.0],["VNM",73558.0],["VUT",6062.0],["WLF",1564.0],["WSM",15618.0],["YEM",18105.0],["ZAF",112165.0],["ZMB",14330.0],["ZWE",23023.0]],"arguments":{},"schema":[{"type":"string","name":"countryCode"},{"type":"double","name":"smoothedArticleCount"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.416891210968E12,"submitTime":1.416887011391E12,"finishTime":1.416891211706E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"mapPlot","width":"1417","height":"712.0","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"c45a7e28-c3bc-4b6a-8278-a2085476491f"},{"version":"CommandV1","origId":3399,"guid":"693460f2-a82d-4109-ba6a-75d0212296e6","subtype":"command","commandType":"auto","position":16.375,"command":"%md\n\n### **Step 4:** Keep going...\nThere's a lot more interesting things to explore with the wikipedia dataset!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.42653069185E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"c07c02dd-2ee0-4975-a899-499403effd53"}],"guid":"55abc510-05e4-4440-b276-d359e8773fda","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"397b7528-3179-471e-97f8-8d5ff222f3a8","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>