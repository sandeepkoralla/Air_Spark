<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Spark MLlib / Example ML Workflow - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-U094163cf51-S47b89c350f-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-U094163cf51-S2f95f6c227-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6 Branch Preview","packageLabel":"spark-1.6-jenkins-ip-10-2-0-138-U094163cf51-S3436f2ea50-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.8.1","local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-U094163cf51-S336f76a5be-2015-12-03-00:16:18.916275","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"d3dde7ae-fd45-4989-86b8-e91415a5ebcf","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"094163cf51fcd4717c3ea96799d1008723ae8985","userFullname":"Suresh Jayaram","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100017,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"surjayaram@paypal.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2233,"name":"Spark MLlib / Example ML Workflow","language":"python","commands":[{"version":"CommandV1","origId":2234,"guid":"6b8472b1-9669-4c84-a632-beee0b492ea9","subtype":"command","commandType":"auto","position":1.0,"command":"%md # Example Machine Learning (ML) Workflow - ML Pipelines\n\nThis is an end-to-end example of a Machine Learning workflow.  For this example, we analyze the Diamonds dataset from the R Datasets hosted on DBC.  We will use the [DecisionTree algorithm](http://spark.apache.org/docs/latest/ml-decision-tree.html) to predict the price of a diamond from its characteristics.\n\nHere is an outline of our pipeline:\n* *Load data*: Load data as DataFrame\n* *Understand the data*: Compute statistics and create visualizations to get a better understanding of the data.\n* *Hold out data*: Split the data randomly into training and test sets.  We will not look at the test data until *after* learning.\n* On the training dataset:\n  * *Extract features*: We will index categorical (String-valued) features so that DecisionTree can handle them.\n  * *Learn a model*: Run DecisionTree to learn how to predict a diamond's price from a description of the diamond.\n  * *Tune the model*: Tune the tree depth (complexity) using the training data.  (This process is also called *model selection*.)\n* *Evaluate the model*: Now look at the test dataset.  Compare the initial model with the tuned model to see the benefit of tuning parameters.\n* *Understand the model*: We will examine the learned model and results to gain further insight.\n\nThis guide provides a high-level view of creating an ML workflow.  It does not delve into details.  Other guides cover details of components of the workflow, as well as the various ML algorithms available.\n\nRelated links:\n* [ML Algorithm Guide](../07 Spark MLlib/2 Algorithms/0 MLlib Algorithms Guide.html): Refer to this for info on various algorithms used in this workflow.\n* Decision trees: [ML Programming Guide](https://spark.apache.org/docs/latest/ml-decision-tree.html) and [Wikipedia](http://en.wikipedia.org/wiki/Decision_tree)\n* Wikipedia on [model selection](http://en.wikipedia.org/wiki/Model_selection) and [parameter tuning](http://en.wikipedia.org/wiki/Hyperparameter_optimization)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.43399539164E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"c1b6fcb8-4efa-45ec-bef5-fc3e8b31fd6c"},{"version":"CommandV1","origId":2235,"guid":"56f4f7d3-21a0-4ded-8e33-2cc4acd8acf3","subtype":"command","commandType":"auto","position":2.0,"command":"%md ## Load data\n\nThis section loads a dataset as a DataFrame and examines a few rows of it to understand the schema.\n\nFor more info, see the DB guide on [Accessing data](../03 Accessing Data/0 Accessing Data.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.433995398624E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"c0337593-cff1-42d4-a13c-270ae20d70bd"},{"version":"CommandV1","origId":2236,"guid":"a8cad3b6-5290-4437-8dbf-48b8181730a3","subtype":"command","commandType":"auto","position":3.25,"command":"# We'll use the Diamonds dataset from the R datasets hosted on DBC.\ndataPath = \"dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv\"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.44563667762E12,"submitTime":1.445636676445E12,"finishTime":1.445636677658E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"ad13fea5-1f58-4d7c-975a-0eb3ace140f6"},{"version":"CommandV1","origId":2237,"guid":"19527c87-aec9-4de1-bccb-17f9f1f5a377","subtype":"command","commandType":"auto","position":3.625,"command":"# Load the csv file as a DataFrame with the spark-csv package\ndiamonds = sqlContext.read.format('com.databricks.spark.csv').options(header='true').load(dataPath)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 23 in stage 306.0 failed 4 times, most recent failure: Lost task 23.3 in stage 306.0 (TID 7566, 10.0.219.225): java.io.IOException: Could not read footer: java.lang.RuntimeException: dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [46, 54, 52, 10]","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-21-2f715aa08e10&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># Load the text file as a DataFrame</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>diamondsDF <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>dataPath<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;text&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    119</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    120</span>         <span class=\"ansigreen\">if</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 121</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    122</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    123</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     34</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     35</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 36</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    298</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    299</span>                     <span class=\"ansiblue\">&apos;An error occurred while calling {0}{1}{2}.\\n&apos;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 300</span><span class=\"ansiyellow\">                     format(target_id, &apos;.&apos;, name), value)\n</span><span class=\"ansigreen\">    301</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    302</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o482.load.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 23 in stage 306.0 failed 4 times, most recent failure: Lost task 23.3 in stage 306.0 (TID 7566, 10.0.219.225): java.io.IOException: Could not read footer: java.lang.RuntimeException: dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [46, 54, 52, 10]\n\tat org.apache.parquet.hadoop.ParquetFileReader.readAllFootersInParallel(ParquetFileReader.java:247)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$28.apply(ParquetRelation.scala:750)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$28.apply(ParquetRelation.scala:739)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:706)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:706)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:297)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:66)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [46, 54, 52, 10]\n\tat org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:422)\n\tat org.apache.parquet.hadoop.ParquetFileReader$2.call(ParquetFileReader.java:237)\n\tat org.apache.parquet.hadoop.ParquetFileReader$2.call(ParquetFileReader.java:233)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\t... 3 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1283)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1271)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1270)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1270)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1496)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1458)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1447)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:567)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1825)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1838)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1851)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1922)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:905)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:108)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:904)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$.mergeSchemasInParallel(ParquetRelation.scala:763)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$MetadataCache$$readSchema(ParquetRelation.scala:483)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache$$anonfun$13.apply(ParquetRelation.scala:404)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache$$anonfun$13.apply(ParquetRelation.scala:404)\n\tat scala.Option.orElse(Option.scala:257)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache.refresh(ParquetRelation.scala:404)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$$metadataCache$lzycompute(ParquetRelation.scala:145)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$$metadataCache(ParquetRelation.scala:143)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$6.apply(ParquetRelation.scala:196)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$6.apply(ParquetRelation.scala:196)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.dataSchema(ParquetRelation.scala:196)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema$lzycompute(interfaces.scala:561)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema(interfaces.scala:560)\n\tat org.apache.spark.sql.execution.datasources.LogicalRelation.&lt;init&gt;(LogicalRelation.scala:37)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:120)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:104)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:379)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:207)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.IOException: Could not read footer: java.lang.RuntimeException: dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [46, 54, 52, 10]\n\tat org.apache.parquet.hadoop.ParquetFileReader.readAllFootersInParallel(ParquetFileReader.java:247)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$28.apply(ParquetRelation.scala:750)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$28.apply(ParquetRelation.scala:739)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:706)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:706)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:297)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:66)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\nCaused by: java.lang.RuntimeException: dbfs:/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [46, 54, 52, 10]\n\tat org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:422)\n\tat org.apache.parquet.hadoop.ParquetFileReader$2.call(ParquetFileReader.java:237)\n\tat org.apache.parquet.hadoop.ParquetFileReader$2.call(ParquetFileReader.java:233)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\t... 3 more\n\n</div>","startTime":1.445636677661E12,"submitTime":1.445636676839E12,"finishTime":1.445636678489E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"d5d26f0e-9543-4122-9c79-21b23b9cc1d6"},{"version":"CommandV1","origId":2238,"guid":"4ffc192a-7598-4a77-bd00-e80836f63b8b","subtype":"command","commandType":"auto","position":3.65625,"command":"# Convert relevant columns to type double\ndiamondsDF = diamonds.select(diamonds.carat.cast('double').alias('carat'),\n                         'cut',\n                         'color',\n                         'clarity',\n                         diamonds.depth.cast('double').alias('depth'),\n                         diamonds.table.cast('double').alias('table'),\n                         diamonds.price.cast('double').alias('price'),\n                         diamonds.x.cast('double').alias('x'),\n                         diamonds.y.cast('double').alias('y'),\n                         diamonds.z.cast('double').alias('z'))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445636678493E12,"submitTime":1.445636677325E12,"finishTime":1.445636678621E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"cf1a5e0c-8ed6-4919-bd42-ce9b358b7a43"},{"version":"CommandV1","origId":2239,"guid":"a4ff04e1-0958-4b62-8a89-bdca56d02c50","subtype":"command","commandType":"auto","position":3.6875,"command":"# View DataFrame\ndisplay(diamondsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.23,"Ideal","E","SI2",61.5,55.0,326.0,3.95,3.98,2.43],[0.21,"Premium","E","SI1",59.8,61.0,326.0,3.89,3.84,2.31],[0.23,"Good","E","VS1",56.9,65.0,327.0,4.05,4.07,2.31],[0.29,"Premium","I","VS2",62.4,58.0,334.0,4.2,4.23,2.63],[0.31,"Good","J","SI2",63.3,58.0,335.0,4.34,4.35,2.75],[0.24,"Very Good","J","VVS2",62.8,57.0,336.0,3.94,3.96,2.48],[0.24,"Very Good","I","VVS1",62.3,57.0,336.0,3.95,3.98,2.47],[0.26,"Very Good","H","SI1",61.9,55.0,337.0,4.07,4.11,2.53],[0.22,"Fair","E","VS2",65.1,61.0,337.0,3.87,3.78,2.49],[0.23,"Very Good","H","VS1",59.4,61.0,338.0,4.0,4.05,2.39],[0.3,"Good","J","SI1",64.0,55.0,339.0,4.25,4.28,2.73],[0.23,"Ideal","J","VS1",62.8,56.0,340.0,3.93,3.9,2.46],[0.22,"Premium","F","SI1",60.4,61.0,342.0,3.88,3.84,2.33],[0.31,"Ideal","J","SI2",62.2,54.0,344.0,4.35,4.37,2.71],[0.2,"Premium","E","SI2",60.2,62.0,345.0,3.79,3.75,2.27],[0.32,"Premium","E","I1",60.9,58.0,345.0,4.38,4.42,2.68],[0.3,"Ideal","I","SI2",62.0,54.0,348.0,4.31,4.34,2.68],[0.3,"Good","J","SI1",63.4,54.0,351.0,4.23,4.29,2.7],[0.3,"Good","J","SI1",63.8,56.0,351.0,4.23,4.26,2.71],[0.3,"Very Good","J","SI1",62.7,59.0,351.0,4.21,4.27,2.66],[0.3,"Good","I","SI2",63.3,56.0,351.0,4.26,4.3,2.71],[0.23,"Very Good","E","VS2",63.8,55.0,352.0,3.85,3.92,2.48],[0.23,"Very Good","H","VS1",61.0,57.0,353.0,3.94,3.96,2.41],[0.31,"Very Good","J","SI1",59.4,62.0,353.0,4.39,4.43,2.62],[0.31,"Very Good","J","SI1",58.1,62.0,353.0,4.44,4.47,2.59],[0.23,"Very Good","G","VVS2",60.4,58.0,354.0,3.97,4.01,2.41],[0.24,"Premium","I","VS1",62.5,57.0,355.0,3.97,3.94,2.47],[0.3,"Very Good","J","VS2",62.2,57.0,357.0,4.28,4.3,2.67],[0.23,"Very Good","D","VS2",60.5,61.0,357.0,3.96,3.97,2.4],[0.23,"Very Good","F","VS1",60.9,57.0,357.0,3.96,3.99,2.42],[0.23,"Very Good","F","VS1",60.0,57.0,402.0,4.0,4.03,2.41],[0.23,"Very Good","F","VS1",59.8,57.0,402.0,4.04,4.06,2.42],[0.23,"Very Good","E","VS1",60.7,59.0,402.0,3.97,4.01,2.42],[0.23,"Very Good","E","VS1",59.5,58.0,402.0,4.01,4.06,2.4],[0.23,"Very Good","D","VS1",61.9,58.0,402.0,3.92,3.96,2.44],[0.23,"Good","F","VS1",58.2,59.0,402.0,4.06,4.08,2.37],[0.23,"Good","E","VS1",64.1,59.0,402.0,3.83,3.85,2.46],[0.31,"Good","H","SI1",64.0,54.0,402.0,4.29,4.31,2.75],[0.26,"Very Good","D","VS2",60.8,59.0,403.0,4.13,4.16,2.52],[0.33,"Ideal","I","SI2",61.8,55.0,403.0,4.49,4.51,2.78],[0.33,"Ideal","I","SI2",61.2,56.0,403.0,4.49,4.5,2.75],[0.33,"Ideal","J","SI1",61.1,56.0,403.0,4.49,4.55,2.76],[0.26,"Good","D","VS2",65.2,56.0,403.0,3.99,4.02,2.61],[0.26,"Good","D","VS1",58.4,63.0,403.0,4.19,4.24,2.46],[0.32,"Good","H","SI2",63.1,56.0,403.0,4.34,4.37,2.75],[0.29,"Premium","F","SI1",62.4,58.0,403.0,4.24,4.26,2.65],[0.32,"Very Good","H","SI2",61.8,55.0,403.0,4.35,4.42,2.71],[0.32,"Good","H","SI2",63.8,56.0,403.0,4.36,4.38,2.79],[0.25,"Very Good","E","VS2",63.3,60.0,404.0,4.0,4.03,2.54],[0.29,"Very Good","H","SI2",60.7,60.0,404.0,4.33,4.37,2.64],[0.24,"Very Good","F","SI1",60.9,61.0,404.0,4.02,4.03,2.45],[0.23,"Ideal","G","VS1",61.9,54.0,404.0,3.93,3.95,2.44],[0.32,"Ideal","I","SI1",60.9,55.0,404.0,4.45,4.48,2.72],[0.22,"Premium","E","VS2",61.6,58.0,404.0,3.93,3.89,2.41],[0.22,"Premium","D","VS2",59.3,62.0,404.0,3.91,3.88,2.31],[0.3,"Ideal","I","SI2",61.0,59.0,405.0,4.3,4.33,2.63],[0.3,"Premium","J","SI2",59.3,61.0,405.0,4.43,4.38,2.61],[0.3,"Very Good","I","SI1",62.6,57.0,405.0,4.25,4.28,2.67],[0.3,"Very Good","I","SI1",63.0,57.0,405.0,4.28,4.32,2.71],[0.3,"Good","I","SI1",63.2,55.0,405.0,4.25,4.29,2.7],[0.35,"Ideal","I","VS1",60.9,57.0,552.0,4.54,4.59,2.78],[0.3,"Premium","D","SI1",62.6,59.0,552.0,4.23,4.27,2.66],[0.3,"Ideal","D","SI1",62.5,57.0,552.0,4.29,4.32,2.69],[0.3,"Ideal","D","SI1",62.1,56.0,552.0,4.3,4.33,2.68],[0.42,"Premium","I","SI2",61.5,59.0,552.0,4.78,4.84,2.96],[0.28,"Ideal","G","VVS2",61.4,56.0,553.0,4.19,4.22,2.58],[0.32,"Ideal","I","VVS1",62.0,55.3,553.0,4.39,4.42,2.73],[0.31,"Very Good","G","SI1",63.3,57.0,553.0,4.33,4.3,2.73],[0.31,"Premium","G","SI1",61.8,58.0,553.0,4.35,4.32,2.68],[0.24,"Premium","E","VVS1",60.7,58.0,553.0,4.01,4.03,2.44],[0.24,"Very Good","D","VVS1",61.5,60.0,553.0,3.97,4.0,2.45],[0.3,"Very Good","H","SI1",63.1,56.0,554.0,4.29,4.27,2.7],[0.3,"Premium","H","SI1",62.9,59.0,554.0,4.28,4.24,2.68],[0.3,"Premium","H","SI1",62.5,57.0,554.0,4.29,4.25,2.67],[0.3,"Good","H","SI1",63.7,57.0,554.0,4.28,4.26,2.72],[0.26,"Very Good","F","VVS2",59.2,60.0,554.0,4.19,4.22,2.49],[0.26,"Very Good","E","VVS2",59.9,58.0,554.0,4.15,4.23,2.51],[0.26,"Very Good","D","VVS2",62.4,54.0,554.0,4.08,4.13,2.56],[0.26,"Very Good","D","VVS2",62.8,60.0,554.0,4.01,4.05,2.53],[0.26,"Very Good","E","VVS1",62.6,59.0,554.0,4.06,4.09,2.55],[0.26,"Very Good","E","VVS1",63.4,59.0,554.0,4.0,4.04,2.55],[0.26,"Very Good","D","VVS1",62.1,60.0,554.0,4.03,4.12,2.53],[0.26,"Ideal","E","VVS2",62.9,58.0,554.0,4.02,4.06,2.54],[0.38,"Ideal","I","SI2",61.6,56.0,554.0,4.65,4.67,2.87],[0.26,"Good","E","VVS1",57.9,60.0,554.0,4.22,4.25,2.45],[0.24,"Premium","G","VVS1",62.3,59.0,554.0,3.95,3.92,2.45],[0.24,"Premium","H","VVS1",61.2,58.0,554.0,4.01,3.96,2.44],[0.24,"Premium","H","VVS1",60.8,59.0,554.0,4.02,4.0,2.44],[0.24,"Premium","H","VVS2",60.7,58.0,554.0,4.07,4.04,2.46],[0.32,"Premium","I","SI1",62.9,58.0,554.0,4.35,4.33,2.73],[0.7,"Ideal","E","SI1",62.5,57.0,2757.0,5.7,5.72,3.57],[0.86,"Fair","E","SI2",55.1,69.0,2757.0,6.45,6.33,3.52],[0.7,"Ideal","G","VS2",61.6,56.0,2757.0,5.7,5.67,3.5],[0.71,"Very Good","E","VS2",62.4,57.0,2759.0,5.68,5.73,3.56],[0.78,"Very Good","G","SI2",63.8,56.0,2759.0,5.81,5.85,3.72],[0.7,"Good","E","VS2",57.5,58.0,2759.0,5.85,5.9,3.38],[0.7,"Good","F","VS1",59.4,62.0,2759.0,5.71,5.76,3.4],[0.96,"Fair","F","SI2",66.3,62.0,2759.0,6.27,5.95,4.07],[0.73,"Very Good","E","SI1",61.6,59.0,2760.0,5.77,5.78,3.56],[0.8,"Premium","H","SI1",61.5,58.0,2760.0,5.97,5.93,3.66],[0.75,"Very Good","D","SI1",63.2,56.0,2760.0,5.8,5.75,3.65],[0.75,"Premium","E","SI1",59.9,54.0,2760.0,6.0,5.96,3.58],[0.74,"Ideal","G","SI1",61.6,55.0,2760.0,5.8,5.85,3.59],[0.75,"Premium","G","VS2",61.7,58.0,2760.0,5.85,5.79,3.59],[0.8,"Ideal","I","VS1",62.9,56.0,2760.0,5.94,5.87,3.72],[0.75,"Ideal","G","SI1",62.2,55.0,2760.0,5.87,5.8,3.63],[0.8,"Premium","G","SI1",63.0,59.0,2760.0,5.9,5.81,3.69],[0.74,"Ideal","I","VVS2",62.3,55.0,2761.0,5.77,5.81,3.61],[0.81,"Ideal","F","SI2",58.8,57.0,2761.0,6.14,6.11,3.6],[0.59,"Ideal","E","VVS2",62.0,55.0,2761.0,5.38,5.43,3.35],[0.8,"Ideal","F","SI2",61.4,57.0,2761.0,5.96,6.0,3.67],[0.74,"Ideal","E","SI2",62.2,56.0,2761.0,5.8,5.84,3.62],[0.9,"Premium","I","VS2",63.0,58.0,2761.0,6.16,6.12,3.87],[0.74,"Very Good","G","SI1",62.2,59.0,2762.0,5.73,5.82,3.59],[0.73,"Ideal","F","VS2",62.6,56.0,2762.0,5.77,5.74,3.6],[0.73,"Ideal","F","VS2",62.7,53.0,2762.0,5.8,5.75,3.62],[0.8,"Premium","F","SI2",61.7,58.0,2762.0,5.98,5.94,3.68],[0.71,"Ideal","G","VS2",62.4,54.0,2762.0,5.72,5.76,3.58],[0.7,"Ideal","E","VS2",60.7,58.0,2762.0,5.73,5.76,3.49],[0.8,"Ideal","F","SI2",59.9,59.0,2762.0,6.01,6.07,3.62],[0.71,"Ideal","D","SI2",62.3,56.0,2762.0,5.73,5.69,3.56],[0.74,"Ideal","E","SI1",62.3,54.0,2762.0,5.8,5.83,3.62],[0.7,"Very Good","F","VS2",61.7,63.0,2762.0,5.64,5.61,3.47],[0.7,"Fair","F","VS2",64.5,57.0,2762.0,5.57,5.53,3.58],[0.7,"Fair","F","VS2",65.3,55.0,2762.0,5.63,5.58,3.66],[0.7,"Premium","F","VS2",61.6,60.0,2762.0,5.65,5.59,3.46],[0.91,"Premium","H","SI1",61.4,56.0,2763.0,6.09,5.97,3.7],[0.61,"Very Good","D","VVS2",59.6,57.0,2763.0,5.56,5.58,3.32],[0.91,"Fair","H","SI2",64.4,57.0,2763.0,6.11,6.09,3.93],[0.91,"Fair","H","SI2",65.7,60.0,2763.0,6.03,5.99,3.95],[0.77,"Ideal","H","VS2",62.0,56.0,2763.0,5.89,5.86,3.64],[0.71,"Very Good","D","SI1",63.6,58.0,2764.0,5.64,5.68,3.6],[0.71,"Ideal","D","SI1",61.9,59.0,2764.0,5.69,5.72,3.53],[0.7,"Very Good","E","VS2",62.6,60.0,2765.0,5.62,5.65,3.53],[0.77,"Very Good","H","VS1",61.3,60.0,2765.0,5.88,5.9,3.61],[0.63,"Premium","E","VVS1",60.9,60.0,2765.0,5.52,5.55,3.37],[0.71,"Very Good","F","VS1",60.1,62.0,2765.0,5.74,5.77,3.46],[0.71,"Premium","F","VS1",61.8,59.0,2765.0,5.69,5.73,3.53],[0.76,"Ideal","H","SI1",61.2,57.0,2765.0,5.88,5.91,3.61],[0.64,"Ideal","G","VVS1",61.9,56.0,2766.0,5.53,5.56,3.43],[0.71,"Premium","G","VS2",60.9,57.0,2766.0,5.78,5.75,3.51],[0.71,"Premium","G","VS2",59.8,56.0,2766.0,5.89,5.81,3.5],[0.7,"Very Good","D","VS2",61.8,55.0,2767.0,5.68,5.72,3.52],[0.7,"Very Good","F","VS1",60.0,57.0,2767.0,5.8,5.87,3.5],[0.71,"Ideal","D","SI2",61.6,55.0,2767.0,5.74,5.76,3.54],[0.7,"Good","H","VVS2",62.1,64.0,2767.0,5.62,5.65,3.5],[0.71,"Very Good","G","VS1",63.3,59.0,2768.0,5.52,5.61,3.52],[0.73,"Very Good","D","SI1",60.2,56.0,2768.0,5.83,5.87,3.52],[0.7,"Very Good","D","SI1",61.1,58.0,2768.0,5.66,5.73,3.48],[0.7,"Ideal","E","SI1",60.9,57.0,2768.0,5.73,5.76,3.5],[0.71,"Premium","D","SI2",61.7,59.0,2768.0,5.71,5.67,3.51],[0.74,"Ideal","I","SI1",61.3,56.0,2769.0,5.82,5.86,3.57],[0.71,"Premium","D","VS2",62.5,60.0,2770.0,5.65,5.61,3.52],[0.73,"Premium","G","VS2",61.4,59.0,2770.0,5.83,5.76,3.56],[0.76,"Very Good","F","SI1",62.9,57.0,2770.0,5.79,5.81,3.65],[0.76,"Ideal","D","SI2",62.4,57.0,2770.0,5.78,5.83,3.62],[0.71,"Ideal","F","SI1",60.7,56.0,2770.0,5.77,5.8,3.51],[0.73,"Premium","G","VS2",60.7,58.0,2770.0,5.87,5.82,3.55],[0.73,"Premium","G","VS1",61.5,58.0,2770.0,5.79,5.75,3.55],[0.73,"Ideal","D","SI2",59.9,57.0,2770.0,5.92,5.89,3.54],[0.73,"Premium","G","VS2",59.2,59.0,2770.0,5.92,5.87,3.49],[0.72,"Very Good","H","VVS2",60.3,56.0,2771.0,5.81,5.83,3.51],[0.73,"Very Good","F","SI1",61.7,60.0,2771.0,5.79,5.82,3.58],[0.71,"Ideal","G","VS2",61.9,57.0,2771.0,5.73,5.77,3.56],[0.79,"Ideal","F","SI2",61.9,55.0,2771.0,5.97,5.92,3.68],[0.73,"Very Good","H","VVS1",60.4,59.0,2772.0,5.83,5.89,3.54],[0.8,"Very Good","F","SI2",61.0,57.0,2772.0,6.01,6.03,3.67],[0.58,"Ideal","G","VVS1",61.5,55.0,2772.0,5.39,5.44,3.33],[0.58,"Ideal","F","VVS1",61.7,56.0,2772.0,5.33,5.37,3.3],[0.71,"Good","E","VS2",59.2,61.0,2772.0,5.8,5.88,3.46],[0.75,"Ideal","D","SI2",61.3,56.0,2773.0,5.85,5.89,3.6],[0.7,"Premium","D","VS2",58.0,62.0,2773.0,5.87,5.78,3.38],[1.17,"Very Good","J","I1",60.2,61.0,2774.0,6.83,6.9,4.13],[0.6,"Ideal","E","VS1",61.7,55.0,2774.0,5.41,5.44,3.35],[0.7,"Ideal","E","SI1",62.7,55.0,2774.0,5.68,5.74,3.58],[0.83,"Good","I","VS2",64.6,54.0,2774.0,5.85,5.88,3.79],[0.74,"Very Good","F","VS2",61.3,61.0,2775.0,5.8,5.84,3.57],[0.72,"Very Good","G","VS2",63.7,56.4,2776.0,5.62,5.69,3.61],[0.71,"Premium","E","VS2",62.7,58.0,2776.0,5.74,5.68,3.58],[0.71,"Ideal","E","VS2",62.2,57.0,2776.0,5.79,5.62,3.55],[0.54,"Ideal","E","VVS2",61.6,56.0,2776.0,5.25,5.27,3.24],[0.54,"Ideal","E","VVS2",61.5,57.0,2776.0,5.24,5.26,3.23],[0.72,"Ideal","G","SI1",61.8,56.0,2776.0,5.72,5.75,3.55],[0.72,"Ideal","G","SI1",60.7,56.0,2776.0,5.79,5.82,3.53],[0.72,"Good","G","VS2",59.7,60.5,2776.0,5.8,5.84,3.47],[0.71,"Ideal","G","SI1",60.5,56.0,2776.0,5.8,5.76,3.5],[0.7,"Very Good","D","VS1",62.7,58.0,2777.0,5.66,5.73,3.57],[0.71,"Premium","F","VS2",62.1,58.0,2777.0,5.67,5.7,3.53],[0.71,"Very Good","F","VS2",62.8,57.0,2777.0,5.64,5.69,3.56],[0.71,"Good","F","VS2",63.8,58.0,2777.0,5.61,5.64,3.59],[0.71,"Good","F","VS2",57.8,60.0,2777.0,5.87,5.9,3.4],[0.7,"Ideal","E","VS2",62.1,55.0,2777.0,5.7,5.67,3.53],[0.7,"Premium","E","VS2",61.1,60.0,2777.0,5.71,5.64,3.47],[0.7,"Premium","E","SI1",60.0,59.0,2777.0,5.79,5.75,3.46],[0.7,"Premium","E","SI1",61.2,57.0,2777.0,5.73,5.68,3.49],[0.7,"Premium","E","SI1",62.7,59.0,2777.0,5.67,5.63,3.54],[0.7,"Premium","E","SI1",61.0,57.0,2777.0,5.73,5.68,3.48],[0.7,"Premium","E","SI1",61.0,58.0,2777.0,5.78,5.72,3.51],[0.7,"Ideal","E","SI1",61.4,57.0,2777.0,5.76,5.7,3.52],[0.72,"Premium","F","SI1",61.8,61.0,2777.0,5.82,5.71,3.56],[0.7,"Very Good","E","SI1",59.9,63.0,2777.0,5.76,5.7,3.43],[0.7,"Premium","E","SI1",61.3,58.0,2777.0,5.71,5.68,3.49],[0.7,"Premium","E","SI1",60.5,58.0,2777.0,5.77,5.74,3.48],[0.7,"Good","E","VS2",64.1,59.0,2777.0,5.64,5.59,3.6],[0.98,"Fair","H","SI2",67.9,60.0,2777.0,6.05,5.97,4.08],[0.78,"Premium","F","SI1",62.4,58.0,2777.0,5.83,5.8,3.63],[0.7,"Very Good","E","SI1",63.2,60.0,2777.0,5.6,5.51,3.51],[0.52,"Ideal","F","VVS1",61.3,55.0,2778.0,5.19,5.22,3.19],[0.73,"Very Good","H","VS2",60.8,56.0,2779.0,5.82,5.84,3.55],[0.74,"Ideal","E","SI1",61.7,56.0,2779.0,5.84,5.8,3.59],[0.7,"Very Good","F","VS2",63.6,57.0,2780.0,5.61,5.65,3.58],[0.77,"Premium","G","VS2",61.2,58.0,2780.0,5.9,5.93,3.62],[0.71,"Ideal","F","VS2",62.1,54.0,2780.0,5.68,5.72,3.54],[0.74,"Ideal","G","VS1",61.5,55.0,2780.0,5.81,5.86,3.59],[0.7,"Ideal","G","VS1",61.4,59.0,2780.0,5.64,5.73,3.49],[1.01,"Premium","F","I1",61.8,60.0,2781.0,6.39,6.36,3.94],[0.77,"Ideal","H","SI1",62.2,56.0,2781.0,5.83,5.88,3.64],[0.78,"Ideal","H","SI1",61.2,56.0,2781.0,5.92,5.99,3.64],[0.72,"Very Good","H","VS1",60.6,63.0,2782.0,5.83,5.76,3.51],[0.53,"Very Good","D","VVS2",57.5,64.0,2782.0,5.34,5.37,3.08],[0.76,"Ideal","G","VS2",61.3,56.0,2782.0,5.9,5.94,3.63],[0.7,"Good","E","VS1",57.2,62.0,2782.0,5.81,5.77,3.31],[0.7,"Premium","E","VS1",62.9,60.0,2782.0,5.62,5.54,3.51],[0.75,"Very Good","D","SI2",63.1,58.0,2782.0,5.78,5.73,3.63],[0.72,"Ideal","D","SI1",60.8,57.0,2782.0,5.76,5.75,3.5],[0.72,"Premium","D","SI1",62.7,59.0,2782.0,5.73,5.69,3.58],[0.7,"Premium","D","SI1",62.8,60.0,2782.0,5.68,5.66,3.56],[0.84,"Fair","G","SI1",55.1,67.0,2782.0,6.39,6.2,3.47],[0.75,"Premium","F","SI1",61.4,59.0,2782.0,5.88,5.85,3.6],[0.52,"Ideal","F","IF",62.2,55.0,2783.0,5.14,5.18,3.21],[0.72,"Very Good","F","VS2",63.0,54.0,2784.0,5.69,5.73,3.6],[0.79,"Very Good","H","VS1",63.7,56.0,2784.0,5.85,5.92,3.75],[0.72,"Very Good","F","VS2",63.6,58.0,2787.0,5.66,5.69,3.61],[0.51,"Ideal","F","VVS1",62.0,57.0,2787.0,5.11,5.15,3.18],[0.64,"Ideal","D","VS1",61.5,56.0,2787.0,5.54,5.55,3.41],[0.7,"Very Good","H","VVS1",60.5,60.0,2788.0,5.74,5.77,3.48],[0.83,"Very Good","I","VS1",61.1,60.0,2788.0,6.07,6.1,3.72],[0.76,"Ideal","I","VVS2",61.8,56.0,2788.0,5.85,5.87,3.62],[0.71,"Good","D","VS2",63.3,56.0,2788.0,5.64,5.68,3.58],[0.77,"Good","G","VS1",59.4,64.0,2788.0,5.97,5.92,3.53],[0.71,"Ideal","F","SI1",62.5,55.0,2788.0,5.71,5.65,3.55],[1.01,"Fair","E","I1",64.5,58.0,2788.0,6.29,6.21,4.03],[1.01,"Premium","H","SI2",62.7,59.0,2788.0,6.31,6.22,3.93],[0.77,"Good","F","SI1",64.2,52.0,2789.0,5.81,5.77,3.72],[0.76,"Good","E","SI1",63.7,54.0,2789.0,5.76,5.85,3.7],[0.76,"Premium","E","SI1",60.4,58.0,2789.0,5.92,5.94,3.58],[0.76,"Premium","E","SI1",61.8,58.0,2789.0,5.82,5.86,3.61],[1.05,"Very Good","J","SI2",63.2,56.0,2789.0,6.49,6.45,4.09],[0.81,"Ideal","G","SI2",61.6,56.0,2789.0,5.97,6.01,3.69],[0.7,"Ideal","E","SI1",61.6,56.0,2789.0,5.72,5.75,3.53],[0.55,"Ideal","G","IF",60.9,57.0,2789.0,5.28,5.3,3.22],[0.81,"Good","G","SI2",61.0,61.0,2789.0,5.94,5.99,3.64],[0.63,"Premium","E","VVS2",62.1,57.0,2789.0,5.48,5.41,3.38],[0.63,"Premium","E","VVS1",60.9,60.0,2789.0,5.55,5.52,3.37],[0.77,"Premium","H","VS1",61.3,60.0,2789.0,5.9,5.88,3.61],[1.05,"Fair","J","SI2",65.8,59.0,2789.0,6.41,6.27,4.18],[0.64,"Ideal","G","IF",61.3,56.0,2790.0,5.54,5.58,3.41],[0.76,"Premium","I","VVS1",58.8,59.0,2790.0,6.0,5.94,3.51],[0.83,"Ideal","F","SI2",62.3,55.0,2790.0,6.02,6.05,3.76],[0.71,"Premium","F","VS1",60.1,62.0,2790.0,5.77,5.74,3.46],[0.71,"Premium","F","VS1",61.8,59.0,2790.0,5.73,5.69,3.53],[0.87,"Very Good","I","SI1",63.6,55.8,2791.0,6.07,6.1,3.87],[0.73,"Ideal","E","SI1",62.2,56.0,2791.0,5.74,5.78,3.58],[0.71,"Premium","E","SI1",59.2,59.0,2792.0,5.83,5.86,3.46],[0.71,"Premium","E","SI1",61.8,59.0,2792.0,5.7,5.75,3.54],[0.71,"Ideal","E","SI1",61.3,55.0,2792.0,5.72,5.77,3.52],[0.7,"Premium","F","VS1",62.1,60.0,2792.0,5.71,5.65,3.53],[0.7,"Premium","F","VS1",60.7,60.0,2792.0,5.78,5.75,3.5],[0.76,"Premium","H","VVS2",59.6,57.0,2792.0,5.91,5.86,3.51],[0.7,"Ideal","F","VS1",62.2,56.0,2792.0,5.73,5.68,3.55],[0.79,"Very Good","G","SI1",60.6,57.0,2793.0,5.98,6.06,3.65],[0.7,"Very Good","E","VS2",62.9,57.0,2793.0,5.66,5.69,3.57],[0.7,"Good","E","VS2",64.1,55.0,2793.0,5.6,5.66,3.61],[0.76,"Ideal","I","VS2",61.3,56.0,2793.0,5.87,5.91,3.61],[0.73,"Ideal","H","VS2",62.7,55.0,2793.0,5.72,5.76,3.6],[0.79,"Very Good","E","SI1",63.2,56.0,2794.0,5.91,5.86,3.72],[0.71,"Very Good","E","VS2",60.7,56.0,2795.0,5.81,5.82,3.53],[0.81,"Premium","I","VVS2",61.9,60.0,2795.0,5.91,5.86,3.64],[0.81,"Ideal","F","SI2",62.6,55.0,2795.0,5.92,5.96,3.72],[0.72,"Good","F","VS1",60.7,60.0,2795.0,5.74,5.72,3.48],[0.72,"Premium","D","SI2",62.0,60.0,2795.0,5.73,5.69,3.54],[0.72,"Premium","I","IF",63.0,57.0,2795.0,5.72,5.7,3.6],[0.81,"Premium","H","VS2",58.0,59.0,2795.0,6.17,6.13,3.57],[0.72,"Premium","G","VS2",62.9,57.0,2795.0,5.73,5.65,3.58],[1.0,"Premium","I","SI2",58.2,60.0,2795.0,6.61,6.55,3.83],[0.73,"Good","E","SI1",63.2,58.0,2796.0,5.7,5.76,3.62],[0.81,"Very Good","H","SI2",61.3,59.0,2797.0,5.94,6.01,3.66],[0.81,"Very Good","E","SI1",60.3,60.0,2797.0,6.07,6.1,3.67],[0.71,"Premium","D","SI1",62.7,60.0,2797.0,5.67,5.71,3.57],[0.71,"Premium","D","SI1",61.3,58.0,2797.0,5.73,5.75,3.52],[0.71,"Premium","D","SI1",61.6,60.0,2797.0,5.74,5.69,3.52],[0.57,"Ideal","F","VVS2",61.9,55.0,2797.0,5.34,5.35,3.31],[0.51,"Ideal","D","VVS1",61.7,56.0,2797.0,5.12,5.16,3.17],[0.72,"Ideal","G","VS2",61.9,58.0,2797.0,5.72,5.75,3.55],[0.74,"Ideal","H","VS1",61.8,58.0,2797.0,5.77,5.81,3.58],[0.74,"Ideal","H","VS1",61.6,56.0,2797.0,5.81,5.82,3.58],[0.7,"Fair","G","VVS1",58.8,66.0,2797.0,5.81,5.9,3.44],[0.8,"Premium","F","SI2",61.0,57.0,2797.0,6.03,6.01,3.67],[1.01,"Fair","E","SI2",67.4,60.0,2797.0,6.19,6.05,4.13],[0.8,"Very Good","H","VS2",63.4,60.0,2797.0,5.92,5.82,3.72],[0.77,"Ideal","I","VS1",61.5,59.0,2798.0,5.87,5.91,3.62],[0.83,"Very Good","E","SI2",58.0,62.0,2799.0,6.19,6.25,3.61],[0.82,"Ideal","F","SI2",62.4,54.0,2799.0,5.97,6.02,3.74],[0.78,"Ideal","D","SI1",61.9,57.0,2799.0,5.91,5.86,3.64],[0.6,"Very Good","G","IF",61.6,56.0,2800.0,5.43,5.46,3.35],[0.9,"Good","I","SI2",62.2,59.0,2800.0,6.07,6.11,3.79],[0.7,"Premium","E","VS1",62.2,58.0,2800.0,5.6,5.66,3.5],[0.9,"Very Good","I","SI2",61.3,56.0,2800.0,6.17,6.23,3.8],[0.83,"Ideal","G","SI1",62.3,57.0,2800.0,5.99,6.08,3.76],[0.83,"Ideal","G","SI1",61.8,57.0,2800.0,6.03,6.07,3.74],[0.83,"Very Good","H","SI1",62.5,59.0,2800.0,5.95,6.02,3.74],[0.74,"Premium","G","VS1",62.9,60.0,2800.0,5.74,5.68,3.59],[0.79,"Ideal","I","VS1",61.8,59.0,2800.0,5.92,5.95,3.67],[0.61,"Ideal","G","IF",62.3,56.0,2800.0,5.43,5.45,3.39],[0.76,"Fair","G","VS1",59.0,70.0,2800.0,5.89,5.8,3.46],[0.96,"Ideal","F","I1",60.7,55.0,2801.0,6.37,6.41,3.88],[0.73,"Ideal","F","VS2",62.5,55.0,2801.0,5.8,5.76,3.61],[0.73,"Premium","F","VS2",62.7,58.0,2801.0,5.76,5.7,3.59],[0.75,"Ideal","H","SI1",60.4,57.0,2801.0,5.93,5.96,3.59],[0.71,"Premium","F","VS2",62.1,58.0,2801.0,5.7,5.67,3.53],[0.71,"Good","F","VS2",57.8,60.0,2801.0,5.9,5.87,3.4],[0.71,"Good","F","VS2",63.8,58.0,2801.0,5.64,5.61,3.59],[0.71,"Premium","F","VS2",62.8,57.0,2801.0,5.69,5.64,3.56],[1.04,"Premium","G","I1",62.2,58.0,2801.0,6.46,6.41,4.0],[1.0,"Premium","J","SI2",62.3,58.0,2801.0,6.45,6.34,3.98],[0.87,"Very Good","G","SI2",59.9,58.0,2802.0,6.19,6.23,3.72],[0.53,"Ideal","F","IF",61.9,54.0,2802.0,5.22,5.25,3.24],[0.72,"Premium","E","VS2",63.0,55.0,2802.0,5.79,5.61,3.59],[0.72,"Premium","F","VS1",62.4,58.0,2802.0,5.83,5.7,3.6],[0.7,"Very Good","F","VS2",62.9,58.0,2803.0,5.63,5.65,3.55],[0.74,"Very Good","E","SI1",63.5,56.0,2803.0,5.74,5.79,3.66],[0.71,"Ideal","G","VS2",61.3,56.0,2803.0,5.75,5.71,3.51],[0.73,"Ideal","E","SI1",60.6,54.0,2803.0,5.84,5.89,3.55],[0.7,"Good","G","VS1",65.1,58.0,2803.0,5.56,5.59,3.63],[0.71,"Premium","F","VS2",62.6,58.0,2803.0,5.7,5.67,3.56],[0.71,"Premium","F","VS2",58.0,62.0,2803.0,5.85,5.81,3.38],[0.71,"Premium","G","VS1",62.4,61.0,2803.0,5.7,5.65,3.54],[0.77,"Premium","G","VS2",61.3,57.0,2803.0,5.93,5.88,3.62],[0.71,"Premium","G","VS2",59.9,60.0,2803.0,5.81,5.77,3.47],[0.78,"Premium","G","VS2",60.8,58.0,2803.0,6.03,5.95,3.64],[0.71,"Very Good","G","VS1",63.5,55.0,2803.0,5.66,5.64,3.59],[0.91,"Ideal","D","SI2",62.2,57.0,2803.0,6.21,6.15,3.85],[0.71,"Very Good","E","VS2",63.8,58.0,2804.0,5.62,5.66,3.6],[0.71,"Very Good","E","VS2",64.0,57.0,2804.0,5.66,5.68,3.63],[0.8,"Very Good","E","SI2",62.5,56.0,2804.0,5.88,5.96,3.7],[0.7,"Very Good","D","SI1",62.3,58.0,2804.0,5.69,5.73,3.56],[0.72,"Ideal","F","VS1",61.7,57.0,2804.0,5.74,5.77,3.55],[0.72,"Very Good","F","VS1",62.2,58.0,2804.0,5.75,5.7,3.56],[0.82,"Ideal","H","VS2",61.5,56.0,2804.0,6.01,6.08,3.72],[0.7,"Ideal","D","SI1",61.0,59.0,2804.0,5.68,5.7,3.47],[0.72,"Ideal","D","SI1",62.2,56.0,2804.0,5.74,5.77,3.58],[0.72,"Ideal","D","SI1",61.5,54.0,2804.0,5.77,5.8,3.56],[0.9,"Fair","I","SI1",67.3,59.0,2804.0,5.93,5.84,3.96],[0.74,"Premium","F","VS2",61.7,58.0,2805.0,5.85,5.78,3.59],[0.74,"Premium","F","VS2",61.9,56.0,2805.0,5.8,5.77,3.58],[0.73,"Ideal","E","SI2",61.8,58.0,2805.0,5.77,5.81,3.58],[0.57,"Fair","E","VVS1",58.7,66.0,2805.0,5.34,5.43,3.16],[0.73,"Premium","F","VS2",62.5,57.0,2805.0,5.75,5.7,3.58],[0.72,"Ideal","G","VS2",62.8,56.0,2805.0,5.74,5.7,3.59],[0.74,"Fair","F","VS2",61.1,68.0,2805.0,5.82,5.75,3.53],[0.82,"Good","G","VS2",64.0,57.0,2805.0,5.92,5.89,3.78],[0.81,"Very Good","G","SI1",62.5,60.0,2806.0,5.89,5.94,3.69],[0.75,"Very Good","H","VVS1",60.6,58.0,2806.0,5.85,5.9,3.56],[0.7,"Ideal","F","SI1",61.6,55.0,2806.0,5.72,5.74,3.53],[0.71,"Very Good","F","VS1",62.2,58.0,2807.0,5.66,5.72,3.54],[0.71,"Very Good","F","VS1",60.0,57.0,2807.0,5.84,5.9,3.52],[0.93,"Premium","J","SI2",61.9,57.0,2807.0,6.21,6.19,3.84],[0.8,"Very Good","H","VS2",62.8,57.0,2808.0,5.87,5.91,3.7],[0.7,"Very Good","F","VS1",62.0,57.0,2808.0,5.64,5.71,3.52],[1.0,"Fair","G","I1",66.4,59.0,2808.0,6.16,6.09,4.07],[0.75,"Very Good","G","VS2",63.4,56.0,2808.0,5.78,5.74,3.65],[0.58,"Ideal","E","VVS2",60.9,56.0,2808.0,5.41,5.43,3.3],[0.73,"Very Good","D","SI1",63.1,57.0,2808.0,5.74,5.7,3.61],[0.81,"Very Good","F","SI1",63.1,59.0,2809.0,5.85,5.79,3.67],[0.81,"Premium","D","SI2",59.2,57.0,2809.0,6.15,6.05,3.61],[0.71,"Premium","F","SI1",60.7,54.0,2809.0,5.84,5.8,3.53],[1.2,"Fair","F","I1",64.6,56.0,2809.0,6.73,6.66,4.33],[0.7,"Very Good","F","VS1",61.8,56.0,2810.0,5.63,5.7,3.5],[0.7,"Very Good","F","VS1",59.9,60.0,2810.0,5.77,5.84,3.48],[0.74,"Ideal","D","SI2",61.7,55.0,2810.0,5.81,5.85,3.6],[0.7,"Good","F","VS1",62.8,61.0,2810.0,5.57,5.61,3.51],[0.8,"Good","G","SI1",62.7,57.0,2810.0,5.84,5.93,3.69],[0.75,"Very Good","F","SI1",63.4,58.0,2811.0,5.72,5.76,3.64],[0.83,"Very Good","D","SI1",63.5,54.0,2811.0,5.98,5.95,3.79],[1.0,"Fair","J","VS2",65.7,59.0,2811.0,6.14,6.07,4.01],[0.99,"Fair","I","SI2",68.1,56.0,2811.0,6.21,6.06,4.18],[0.7,"Very Good","G","VS1",63.0,60.0,2812.0,5.57,5.64,3.53],[0.7,"Very Good","F","VS2",59.5,58.0,2812.0,5.75,5.85,3.45],[0.7,"Good","E","SI1",63.5,59.0,2812.0,5.49,5.53,3.5],[0.7,"Very Good","F","VS2",61.7,58.0,2812.0,5.63,5.69,3.49],[0.32,"Premium","I","SI1",62.7,58.0,554.0,4.37,4.34,2.73],[0.32,"Premium","I","SI1",62.8,58.0,554.0,4.39,4.34,2.74],[0.32,"Ideal","I","SI1",62.4,57.0,554.0,4.37,4.35,2.72],[0.32,"Premium","I","SI1",61.0,59.0,554.0,4.39,4.36,2.67],[0.32,"Very Good","I","SI1",63.1,56.0,554.0,4.39,4.36,2.76],[0.32,"Ideal","I","SI1",60.7,57.0,554.0,4.47,4.42,2.7],[0.3,"Premium","H","SI1",60.9,59.0,554.0,4.31,4.29,2.62],[0.3,"Premium","H","SI1",60.1,55.0,554.0,4.41,4.38,2.64],[0.3,"Premium","H","SI1",62.9,58.0,554.0,4.28,4.24,2.68],[0.3,"Very Good","H","SI1",63.3,56.0,554.0,4.29,4.27,2.71],[0.3,"Good","H","SI1",63.8,55.0,554.0,4.26,4.2,2.7],[0.3,"Ideal","H","SI1",62.9,57.0,554.0,4.27,4.22,2.67],[0.3,"Very Good","H","SI1",63.4,60.0,554.0,4.25,4.23,2.69],[0.32,"Good","I","SI1",63.9,55.0,554.0,4.36,4.34,2.78],[0.33,"Ideal","H","SI2",61.4,56.0,554.0,4.85,4.79,2.95],[0.29,"Very Good","E","VS1",61.9,55.0,555.0,4.28,4.33,2.66],[0.29,"Very Good","E","VS1",62.4,55.0,555.0,4.2,4.25,2.63],[0.31,"Very Good","F","SI1",61.8,58.0,555.0,4.32,4.35,2.68],[0.34,"Ideal","H","VS2",61.5,56.0,555.0,4.47,4.5,2.76],[0.34,"Ideal","H","VS2",60.4,57.0,555.0,4.54,4.57,2.75],[0.34,"Ideal","I","VS1",61.8,55.0,555.0,4.48,4.52,2.78],[0.34,"Ideal","I","VS1",62.0,56.0,555.0,4.5,4.53,2.8],[0.3,"Ideal","G","VS1",62.3,56.0,555.0,4.29,4.31,2.68],[0.29,"Ideal","F","VS1",61.6,56.0,555.0,4.26,4.31,2.64],[0.35,"Ideal","G","SI1",60.6,56.0,555.0,4.56,4.58,2.77],[0.43,"Very Good","E","I1",58.4,62.0,555.0,4.94,5.0,2.9],[0.32,"Very Good","F","VS2",61.4,58.0,556.0,4.37,4.42,2.7],[0.36,"Ideal","I","VS2",61.9,56.0,556.0,4.54,4.57,2.82],[0.3,"Ideal","G","VS2",62.0,56.0,556.0,4.28,4.3,2.66],[0.26,"Ideal","E","VS1",61.5,57.0,556.0,4.09,4.12,2.52],[0.7,"Very Good","F","VS2",62.3,58.0,2812.0,5.64,5.72,3.54],[0.7,"Very Good","F","VS2",60.9,61.0,2812.0,5.66,5.71,3.46],[0.71,"Ideal","D","SI1",62.4,57.0,2812.0,5.69,5.72,3.56],[0.99,"Fair","J","SI1",55.0,61.0,2812.0,6.72,6.67,3.68],[0.73,"Premium","E","VS2",58.6,60.0,2812.0,5.92,5.89,3.46],[0.51,"Ideal","F","VVS1",62.0,57.0,2812.0,5.15,5.11,3.18],[0.91,"Premium","G","SI2",59.8,58.0,2813.0,6.3,6.29,3.77],[0.84,"Very Good","E","SI1",63.4,55.0,2813.0,6.0,5.95,3.79],[0.91,"Good","I","VS2",64.3,58.0,2813.0,6.09,6.05,3.9],[0.76,"Premium","E","SI1",62.2,59.0,2814.0,5.86,5.81,3.63],[0.76,"Ideal","E","SI1",61.7,57.0,2814.0,5.88,5.85,3.62],[0.75,"Premium","E","SI1",61.1,59.0,2814.0,5.86,5.83,3.57],[0.55,"Very Good","D","VVS1",61.5,56.0,2815.0,5.23,5.27,3.23],[0.76,"Very Good","F","SI2",58.5,62.0,2815.0,5.93,6.01,3.49],[0.74,"Premium","G","VS1",61.7,58.0,2815.0,5.79,5.81,3.58],[0.7,"Ideal","H","SI1",60.4,56.0,2815.0,5.75,5.81,3.49],[0.7,"Ideal","H","SI1",61.4,56.0,2815.0,5.7,5.76,3.52],[0.7,"Ideal","H","SI1",61.5,55.0,2815.0,5.73,5.79,3.54],[0.7,"Ideal","H","SI1",61.4,56.0,2815.0,5.72,5.77,3.53],[0.9,"Fair","J","VS2",65.0,56.0,2815.0,6.08,6.04,3.94],[0.95,"Fair","F","SI2",56.0,60.0,2815.0,6.62,6.53,3.68],[0.89,"Premium","H","SI2",60.2,59.0,2815.0,6.26,6.23,3.76],[0.72,"Premium","E","VS2",58.3,58.0,2815.0,5.99,5.92,3.47],[0.96,"Fair","E","SI2",53.1,63.0,2815.0,6.73,6.65,3.55],[1.02,"Premium","G","I1",60.3,58.0,2815.0,6.55,6.5,3.94],[0.78,"Very Good","I","VVS2",61.4,56.0,2816.0,5.91,5.95,3.64],[0.61,"Ideal","G","VVS2",60.1,57.0,2816.0,5.52,5.54,3.32],[0.71,"Good","D","VS1",63.4,55.0,2816.0,5.61,5.69,3.58],[0.78,"Premium","F","SI1",61.5,59.0,2816.0,5.96,5.88,3.64],[0.87,"Ideal","H","SI2",62.7,56.0,2816.0,6.16,6.13,3.85],[0.83,"Ideal","H","SI1",62.5,55.0,2816.0,6.04,6.0,3.76],[0.71,"Premium","E","SI1",61.3,56.0,2817.0,5.78,5.73,3.53],[0.71,"Ideal","I","VVS2",60.2,56.0,2817.0,5.84,5.89,3.53],[0.71,"Ideal","E","VS2",62.7,57.0,2817.0,5.66,5.64,3.54],[0.71,"Premium","E","VS2",62.3,58.0,2817.0,5.69,5.65,3.53],[0.63,"Ideal","F","VVS2",61.5,56.0,2817.0,5.48,5.52,3.38],[0.71,"Premium","E","SI1",59.2,59.0,2817.0,5.86,5.83,3.46],[0.71,"Premium","E","SI1",61.8,59.0,2817.0,5.75,5.7,3.54],[0.71,"Ideal","E","SI1",61.3,55.0,2817.0,5.77,5.72,3.52],[0.71,"Premium","E","SI1",61.4,58.0,2817.0,5.77,5.73,3.53],[0.9,"Ideal","J","VS2",62.8,55.0,2817.0,6.2,6.16,3.88],[0.71,"Good","E","SI1",62.8,64.0,2817.0,5.6,5.54,3.5],[0.7,"Premium","E","VS2",62.4,61.0,2818.0,5.66,5.63,3.52],[0.7,"Premium","E","VS2",59.3,60.0,2818.0,5.78,5.73,3.41],[0.7,"Premium","E","VS2",63.0,60.0,2818.0,5.64,5.6,3.54],[1.0,"Premium","H","I1",61.3,60.0,2818.0,6.43,6.39,3.93],[0.86,"Premium","F","SI2",59.3,62.0,2818.0,6.36,6.22,3.73],[0.8,"Ideal","H","SI1",61.0,57.0,2818.0,6.07,6.0,3.68],[0.7,"Ideal","E","VS1",62.9,57.0,2818.0,5.66,5.61,3.54],[0.7,"Premium","E","VS1",59.6,57.0,2818.0,5.91,5.83,3.5],[0.7,"Premium","F","VS2",61.8,60.0,2818.0,5.69,5.64,3.5],[0.7,"Premium","E","VS1",62.7,57.0,2818.0,5.68,5.64,3.55],[1.0,"Fair","H","SI2",65.3,62.0,2818.0,6.34,6.12,4.08],[0.72,"Very Good","G","VS1",63.8,58.0,2819.0,5.64,5.68,3.61],[0.72,"Ideal","H","VS1",62.3,56.0,2819.0,5.73,5.77,3.58],[0.7,"Good","F","VS1",59.7,63.0,2819.0,5.76,5.79,3.45],[0.86,"Good","F","SI2",64.3,60.0,2819.0,5.97,5.95,3.83],[0.71,"Ideal","G","VS1",62.9,58.0,2820.0,5.66,5.69,3.57],[0.75,"Ideal","E","SI1",62.0,57.0,2821.0,5.8,5.78,3.59],[0.73,"Premium","E","VS2",61.6,59.0,2821.0,5.77,5.73,3.54],[0.53,"Ideal","E","VVS1",61.9,55.0,2821.0,5.2,5.21,3.22],[0.73,"Premium","E","SI1",61.3,58.0,2821.0,5.83,5.76,3.55],[0.73,"Good","E","SI1",63.6,57.0,2821.0,5.72,5.7,3.63],[0.73,"Premium","E","SI1",59.6,61.0,2821.0,5.92,5.85,3.51],[0.73,"Premium","E","SI1",62.2,59.0,2821.0,5.77,5.68,3.56],[0.73,"Premium","D","SI1",61.7,55.0,2821.0,5.84,5.82,3.6],[0.73,"Very Good","E","SI1",63.2,58.0,2821.0,5.76,5.7,3.62],[0.7,"Premium","E","VS1",60.8,60.0,2822.0,5.74,5.71,3.48],[0.72,"Premium","E","VS2",60.3,59.0,2822.0,5.84,5.8,3.51],[0.72,"Premium","E","VS2",60.9,60.0,2822.0,5.8,5.76,3.52],[0.72,"Premium","E","VS2",62.4,59.0,2822.0,5.77,5.7,3.58],[0.7,"Premium","E","VS2",60.2,60.0,2822.0,5.73,5.7,3.44],[0.6,"Ideal","F","VVS2",62.0,55.0,2822.0,5.37,5.4,3.34],[0.74,"Ideal","I","VVS1",60.8,57.0,2822.0,5.85,5.89,3.57],[0.73,"Ideal","F","SI1",62.1,55.0,2822.0,5.75,5.78,3.58],[0.71,"Premium","D","SI1",62.7,60.0,2822.0,5.71,5.67,3.57],[0.71,"Premium","D","SI1",61.3,58.0,2822.0,5.75,5.73,3.52],[0.7,"Premium","D","SI1",60.2,60.0,2822.0,5.82,5.75,3.48],[0.7,"Ideal","D","SI1",60.7,56.0,2822.0,5.75,5.72,3.48],[0.9,"Good","J","VS2",64.0,61.0,2822.0,6.04,6.03,3.86],[0.71,"Ideal","D","SI1",60.2,56.0,2822.0,5.86,5.83,3.52],[0.7,"Premium","E","VS2",61.5,59.0,2822.0,5.73,5.68,3.51],[0.7,"Premium","E","VS2",62.6,56.0,2822.0,5.71,5.66,3.56],[0.7,"Ideal","D","SI1",59.7,58.0,2822.0,5.82,5.77,3.46],[0.7,"Good","E","SI1",61.4,64.0,2822.0,5.71,5.66,3.49],[0.7,"Ideal","D","SI1",62.5,57.0,2822.0,5.62,5.59,3.51],[0.7,"Ideal","D","SI1",61.8,56.0,2822.0,5.73,5.63,3.51],[0.7,"Premium","E","VS2",60.7,62.0,2822.0,5.72,5.68,3.46],[0.7,"Premium","F","VS2",60.6,58.0,2822.0,5.8,5.72,3.49],[0.7,"Ideal","D","SI1",61.4,54.0,2822.0,5.75,5.71,3.52],[0.79,"Very Good","D","SI2",62.8,59.0,2823.0,5.86,5.9,3.69],[0.9,"Good","I","SI1",63.8,57.0,2823.0,6.06,6.13,3.89],[0.71,"Premium","E","VS2",62.3,58.0,2823.0,5.71,5.66,3.54],[0.61,"Ideal","E","VVS2",61.3,54.0,2823.0,5.51,5.59,3.4],[0.9,"Fair","H","SI2",65.8,54.0,2823.0,6.05,5.98,3.96],[0.71,"Ideal","E","SI1",60.5,56.0,2823.0,5.77,5.73,3.47],[0.71,"Premium","D","VS2",61.2,59.0,2824.0,5.74,5.69,3.5],[0.77,"Ideal","I","VVS2",62.1,57.0,2824.0,5.84,5.86,3.63],[0.74,"Good","E","VS1",63.1,58.0,2824.0,5.73,5.75,3.62],[0.82,"Ideal","F","SI2",62.4,54.0,2824.0,6.02,5.97,3.74],[0.82,"Premium","E","SI2",60.8,60.0,2824.0,6.05,6.03,3.67],[0.71,"Premium","G","VS1",62.2,59.0,2825.0,5.73,5.66,3.54],[0.83,"Premium","H","SI1",60.0,59.0,2825.0,6.08,6.05,3.64],[0.73,"Very Good","G","VS1",62.0,57.0,2825.0,5.75,5.8,3.58],[0.83,"Premium","H","SI1",62.5,59.0,2825.0,6.02,5.95,3.74],[1.17,"Premium","J","I1",60.2,61.0,2825.0,6.9,6.83,4.13],[0.91,"Fair","H","SI2",61.3,67.0,2825.0,6.24,6.19,3.81],[0.73,"Premium","E","VS1",62.6,60.0,2826.0,5.75,5.68,3.58],[0.7,"Good","E","VS1",57.2,59.0,2826.0,5.94,5.88,3.38],[0.9,"Premium","I","SI2",62.2,59.0,2826.0,6.11,6.07,3.79],[0.7,"Premium","E","VS1",62.2,58.0,2826.0,5.66,5.6,3.5],[0.7,"Very Good","D","VS2",63.3,56.0,2826.0,5.6,5.58,3.54],[0.7,"Premium","E","VS1",59.4,61.0,2826.0,5.78,5.74,3.42],[0.9,"Very Good","I","SI2",63.5,56.0,2826.0,6.17,6.07,3.88],[0.78,"Premium","F","SI1",60.8,60.0,2826.0,5.97,5.94,3.62],[0.96,"Ideal","F","I1",60.7,55.0,2826.0,6.41,6.37,3.88],[0.7,"Very Good","D","SI1",62.3,59.0,2827.0,5.67,5.7,3.54],[0.72,"Good","D","VS2",64.0,54.0,2827.0,5.68,5.7,3.64],[0.79,"Premium","H","VVS2",62.6,58.0,2827.0,5.96,5.9,3.71],[0.7,"Ideal","H","VVS1",61.6,57.0,2827.0,5.69,5.74,3.52],[0.7,"Ideal","H","VVS1",62.3,55.0,2827.0,5.66,5.7,3.54],[0.7,"Ideal","D","SI2",60.6,57.0,2828.0,5.74,5.77,3.49],[1.01,"Premium","H","SI2",61.6,61.0,2828.0,6.39,6.31,3.91],[0.72,"Premium","F","VS1",62.2,58.0,2829.0,5.75,5.7,3.56],[0.8,"Good","E","SI2",63.7,54.0,2829.0,5.91,5.87,3.75],[0.59,"Ideal","E","VVS1",62.0,56.0,2829.0,5.36,5.38,3.33],[0.72,"Ideal","F","VS1",61.7,57.0,2829.0,5.77,5.74,3.55],[0.75,"Premium","E","SI2",61.9,57.0,2829.0,5.88,5.82,3.62],[0.8,"Premium","E","SI2",60.2,57.0,2829.0,6.05,6.01,3.63],[0.71,"Very Good","E","VS2",62.7,59.0,2830.0,5.65,5.7,3.56],[0.77,"Very Good","H","SI1",61.7,56.0,2830.0,5.84,5.89,3.62],[0.97,"Ideal","F","I1",60.7,56.0,2830.0,6.41,6.43,3.9],[0.53,"Ideal","F","VVS1",60.9,57.0,2830.0,5.23,5.29,3.19],[0.53,"Ideal","F","VVS1",61.8,57.0,2830.0,5.16,5.19,3.2],[0.8,"Ideal","I","VS2",62.1,54.4,2830.0,5.94,5.99,3.7],[0.9,"Premium","G","SI1",60.6,62.0,2830.0,6.21,6.13,3.74],[0.76,"Very Good","E","SI2",60.8,60.0,2831.0,5.89,5.98,3.61],[0.72,"Ideal","E","SI1",62.3,57.0,2831.0,5.7,5.76,3.57],[0.75,"Ideal","E","SI1",61.4,57.0,2831.0,5.82,5.87,3.59],[0.72,"Premium","E","SI1",62.1,58.0,2831.0,5.73,5.76,3.57],[0.79,"Ideal","G","SI1",61.8,56.0,2831.0,5.93,5.91,3.66],[0.72,"Very Good","F","VS2",62.5,58.0,2832.0,5.71,5.75,3.58],[0.91,"Very Good","I","SI2",62.8,61.0,2832.0,6.15,6.18,3.87],[0.71,"Premium","G","VVS2",62.1,57.0,2832.0,5.75,5.65,3.54],[0.81,"Premium","G","SI1",63.0,60.0,2832.0,5.87,5.81,3.68],[0.82,"Ideal","H","SI1",62.5,57.0,2832.0,5.91,5.97,3.71],[0.71,"Premium","F","VS1",62.2,58.0,2832.0,5.72,5.66,3.54],[0.9,"Good","J","SI1",64.3,63.0,2832.0,6.05,6.01,3.88],[0.8,"Very Good","I","VS2",62.0,58.0,2833.0,5.86,5.95,3.66],[0.56,"Very Good","E","IF",61.0,59.0,2833.0,5.28,5.34,3.24],[0.7,"Very Good","D","VS2",59.6,61.0,2833.0,5.77,5.8,3.45],[0.7,"Ideal","D","VS2",61.0,57.0,2833.0,5.74,5.76,3.51],[0.61,"Ideal","F","VVS2",61.7,55.0,2833.0,5.45,5.48,3.37],[0.85,"Ideal","H","SI2",62.5,57.0,2833.0,6.02,6.07,3.78],[0.7,"Ideal","F","SI1",60.7,57.0,2833.0,5.73,5.75,3.49],[0.8,"Ideal","G","VS2",62.2,56.0,2834.0,5.94,5.87,3.67],[0.8,"Ideal","H","VS2",62.8,57.0,2834.0,5.91,5.87,3.7],[0.51,"Very Good","D","VVS1",59.9,58.0,2834.0,5.16,5.19,3.1],[0.53,"Ideal","F","VVS1",61.4,57.0,2834.0,5.2,5.23,3.2],[0.78,"Ideal","I","VS2",61.8,55.0,2834.0,5.92,5.95,3.67],[0.9,"Very Good","J","SI1",63.4,54.0,2834.0,6.17,6.14,3.9],[0.9,"Fair","G","SI2",65.3,59.0,2834.0,6.07,6.0,3.94],[0.77,"Ideal","E","SI2",60.7,55.0,2834.0,6.01,5.95,3.63],[0.73,"Ideal","F","VS1",61.2,56.0,2835.0,5.89,5.81,3.58],[0.63,"Ideal","F","VVS2",61.9,57.0,2835.0,5.47,5.51,3.4],[0.7,"Ideal","E","VS2",61.5,54.0,2835.0,5.7,5.75,3.52],[0.72,"Ideal","E","VS2",62.8,57.0,2835.0,5.71,5.73,3.59],[0.72,"Ideal","E","SI1",61.0,57.0,2835.0,5.78,5.8,3.53],[0.75,"Premium","F","VS2",59.6,59.0,2835.0,6.04,5.94,3.57],[0.82,"Very Good","H","SI1",60.7,56.0,2836.0,6.04,6.06,3.67],[0.71,"Good","E","VS2",62.8,60.0,2836.0,5.6,5.65,3.53],[0.7,"Premium","E","VS1",62.6,59.0,2837.0,5.69,5.66,3.55],[0.7,"Ideal","E","VS1",61.8,56.0,2837.0,5.74,5.69,3.53],[0.71,"Ideal","F","SI1",59.8,53.0,2838.0,5.86,5.82,3.49],[0.76,"Very Good","H","SI1",60.9,55.0,2838.0,5.92,5.94,3.61],[0.82,"Fair","F","SI1",64.9,58.0,2838.0,5.83,5.79,3.77],[0.72,"Premium","F","VS1",58.8,60.0,2838.0,5.91,5.89,3.47],[0.7,"Premium","F","VS2",62.3,58.0,2838.0,5.72,5.64,3.54],[0.7,"Premium","F","VS2",61.7,58.0,2838.0,5.69,5.63,3.49],[0.7,"Premium","G","VS1",62.6,55.0,2838.0,5.73,5.64,3.56],[0.7,"Premium","F","VS2",59.4,61.0,2838.0,5.83,5.79,3.45],[0.7,"Very Good","E","SI1",63.5,59.0,2838.0,5.53,5.49,3.5],[0.7,"Premium","F","VS2",60.9,61.0,2838.0,5.71,5.66,3.46],[0.7,"Premium","F","VS2",59.5,58.0,2838.0,5.85,5.75,3.45],[0.7,"Premium","G","VS1",63.0,60.0,2838.0,5.64,5.57,3.53],[0.74,"Very Good","E","SI1",60.0,57.0,2839.0,5.85,5.89,3.52],[0.71,"Ideal","F","VS1",61.5,57.0,2839.0,5.74,5.71,3.52],[0.7,"Ideal","F","VS1",61.6,54.0,2839.0,5.75,5.72,3.53],[0.71,"Ideal","F","VS1",62.1,55.0,2839.0,5.82,5.68,3.57],[0.71,"Premium","F","VS1",59.1,61.0,2839.0,5.84,5.81,3.44],[0.71,"Premium","F","VS1",59.0,60.0,2839.0,5.82,5.8,3.43],[0.71,"Premium","F","VS1",60.5,58.0,2839.0,5.75,5.72,3.47],[0.7,"Ideal","F","VS1",62.4,53.0,2839.0,5.73,5.71,3.57],[0.73,"Ideal","G","VS2",61.8,54.0,2839.0,5.8,5.82,3.59],[0.7,"Ideal","E","VS2",62.1,54.0,2839.0,5.69,5.72,3.54],[0.7,"Ideal","G","VS1",61.3,57.0,2839.0,5.71,5.74,3.51],[0.71,"Premium","G","VVS2",60.3,58.0,2839.0,5.82,5.78,3.5],[0.71,"Premium","F","VS1",59.2,58.0,2839.0,5.87,5.82,3.46],[0.79,"Premium","G","VS2",59.3,62.0,2839.0,6.09,6.01,3.59],[0.71,"Premium","F","VS1",62.7,59.0,2839.0,5.7,5.62,3.55],[0.77,"Very Good","H","VS1",61.0,60.0,2840.0,5.9,5.87,3.59],[0.75,"Very Good","F","SI2",59.8,56.0,2840.0,5.85,5.92,3.52],[0.7,"Ideal","F","SI1",61.0,56.0,2840.0,5.75,5.8,3.52],[0.71,"Premium","F","VS2",59.3,56.0,2840.0,5.88,5.82,3.47],[0.92,"Ideal","D","SI2",61.9,56.0,2840.0,6.27,6.2,3.86],[0.83,"Premium","F","SI2",61.4,59.0,2840.0,6.08,6.04,3.72],[0.7,"Premium","H","VVS1",59.2,60.0,2840.0,5.87,5.78,3.45],[0.73,"Premium","F","VS2",60.3,59.0,2841.0,5.9,5.87,3.55],[0.71,"Very Good","D","VS1",63.4,55.0,2841.0,5.69,5.61,3.58],[0.73,"Very Good","D","SI1",63.9,57.0,2841.0,5.66,5.71,3.63],[0.82,"Ideal","F","SI2",61.7,53.0,2841.0,6.0,6.12,3.74],[0.82,"Ideal","F","SI2",62.3,56.0,2841.0,5.96,6.02,3.73],[0.82,"Very Good","F","SI2",59.7,57.0,2841.0,6.12,6.14,3.66],[0.52,"Ideal","F","VVS1",61.2,56.0,2841.0,5.19,5.21,3.18],[1.0,"Premium","F","I1",58.9,60.0,2841.0,6.6,6.55,3.87],[0.95,"Fair","G","SI1",66.7,56.0,2841.0,6.16,6.03,4.06],[0.73,"Ideal","D","SI1",61.4,57.0,2841.0,5.76,5.8,3.55],[0.73,"Premium","F","VS2",59.9,59.0,2841.0,5.87,5.77,3.5],[0.73,"Premium","G","VS1",61.4,58.0,2841.0,5.82,5.77,3.56],[0.8,"Ideal","I","VS1",62.6,54.0,2842.0,5.92,5.96,3.72],[0.7,"Premium","F","VS2",58.7,61.0,2842.0,5.8,5.72,3.38],[0.7,"Very Good","E","VS2",60.2,62.0,2843.0,5.71,5.75,3.45],[0.7,"Very Good","E","VS2",62.7,58.0,2843.0,5.65,5.67,3.55],[0.71,"Very Good","E","VS2",59.4,58.0,2843.0,5.76,5.82,3.44],[0.81,"Very Good","F","SI2",63.2,58.0,2843.0,5.91,5.92,3.74],[0.71,"Very Good","D","SI1",61.5,58.0,2843.0,5.73,5.79,3.54],[0.73,"Ideal","G","VVS2",61.3,57.0,2843.0,5.81,5.84,3.57],[0.73,"Very Good","F","VS1",61.8,59.0,2843.0,5.73,5.79,3.56],[0.72,"Ideal","E","VS2",62.0,57.0,2843.0,5.71,5.74,3.55],[0.81,"Ideal","F","SI2",62.1,57.0,2843.0,5.91,5.95,3.68],[0.71,"Ideal","G","VVS2",60.7,57.0,2843.0,5.81,5.78,3.52],[0.73,"Very Good","E","SI1",57.7,61.0,2844.0,5.92,5.96,3.43],[0.7,"Very Good","E","VS1",62.0,59.0,2844.0,5.65,5.68,3.51],[1.01,"Ideal","I","I1",61.5,57.0,2844.0,6.45,6.46,3.97],[1.01,"Good","I","I1",63.1,57.0,2844.0,6.35,6.39,4.02],[0.79,"Ideal","H","VS2",62.5,57.0,2844.0,5.91,5.93,3.7],[0.7,"Very Good","E","VS2",61.8,59.0,2845.0,5.65,5.68,3.5],[0.7,"Very Good","E","VS2",58.9,60.0,2845.0,5.83,5.85,3.44],[0.8,"Good","H","VS2",63.4,60.0,2845.0,5.92,5.82,3.72],[1.27,"Premium","H","SI2",59.3,61.0,2845.0,7.12,7.05,4.2],[0.79,"Ideal","D","SI1",61.5,56.0,2846.0,5.96,5.91,3.65],[0.72,"Very Good","F","VS1",60.2,59.0,2846.0,5.79,5.84,3.5],[0.73,"Ideal","H","VVS2",61.6,56.0,2846.0,5.79,5.84,3.58],[1.01,"Fair","H","SI2",65.4,59.0,2846.0,6.3,6.26,4.11],[1.01,"Good","H","I1",64.2,61.0,2846.0,6.25,6.18,3.99],[0.73,"Ideal","E","SI1",59.1,59.0,2846.0,5.92,5.95,3.51],[0.7,"Ideal","E","SI1",61.6,57.0,2846.0,5.71,5.76,3.53],[0.7,"Good","F","VS2",59.1,61.0,2846.0,5.76,5.84,3.43],[0.77,"Premium","E","SI1",62.9,59.0,2846.0,5.84,5.79,3.66],[0.77,"Premium","G","VS2",61.3,60.0,2846.0,5.91,5.81,3.59],[0.77,"Premium","G","VS1",61.4,58.0,2846.0,5.94,5.89,3.63],[0.84,"Very Good","H","SI1",61.2,57.0,2847.0,6.1,6.12,3.74],[0.72,"Ideal","E","SI1",60.3,57.0,2847.0,5.83,5.85,3.52],[0.76,"Premium","D","SI1",61.1,59.0,2847.0,5.93,5.88,3.61],[0.7,"Very Good","G","VVS2",62.9,59.0,2848.0,5.61,5.68,3.55],[0.54,"Ideal","D","VVS2",61.5,55.0,2848.0,5.25,5.29,3.24],[0.75,"Fair","D","SI2",64.6,57.0,2848.0,5.74,5.72,3.7],[0.79,"Good","E","SI1",64.1,54.0,2849.0,5.86,5.84,3.75],[0.74,"Very Good","E","VS1",63.1,58.0,2849.0,5.75,5.73,3.62],[0.7,"Very Good","E","VS2",61.0,60.0,2850.0,5.74,5.77,3.51],[0.7,"Ideal","F","VS2",60.8,59.0,2850.0,5.69,5.79,3.49],[0.75,"Ideal","J","SI1",61.5,56.0,2850.0,5.83,5.87,3.6],[1.2,"Very Good","H","I1",63.1,60.0,2850.0,6.75,6.67,4.23],[0.8,"Very Good","F","SI1",63.4,57.0,2851.0,5.89,5.82,3.71],[0.66,"Ideal","D","VS1",62.1,56.0,2851.0,5.54,5.57,3.45],[0.87,"Very Good","F","SI2",61.0,63.0,2851.0,6.22,6.07,3.75],[0.86,"Premium","H","SI1",62.7,59.0,2851.0,6.04,5.98,3.77],[0.74,"Ideal","F","SI1",61.0,57.0,2851.0,5.85,5.81,3.56],[0.58,"Very Good","E","IF",60.6,59.0,2852.0,5.37,5.43,3.27],[0.78,"Ideal","I","VS1",61.5,57.0,2852.0,5.88,5.92,3.63],[0.74,"Ideal","G","SI1",61.3,55.0,2852.0,5.85,5.86,3.59],[0.73,"Ideal","E","SI1",62.7,55.0,2852.0,5.7,5.79,3.6],[0.91,"Very Good","I","SI1",63.5,57.0,2852.0,6.12,6.07,3.87],[0.71,"Premium","F","VS2",62.6,58.0,2853.0,5.67,5.7,3.56],[0.71,"Good","G","VS1",63.5,55.0,2853.0,5.64,5.66,3.59],[0.79,"Ideal","D","SI2",62.8,57.0,2853.0,5.9,5.85,3.69],[0.79,"Premium","D","SI2",60.0,60.0,2853.0,6.07,6.03,3.63],[0.71,"Premium","E","SI1",62.7,58.0,2853.0,5.73,5.66,3.57],[0.82,"Premium","I","VS1",61.9,58.0,2853.0,5.99,5.97,3.7],[0.78,"Very Good","H","VS1",61.9,57.1,2854.0,5.87,5.95,3.66],[0.7,"Very Good","E","VS1",62.4,56.0,2854.0,5.64,5.7,3.54],[1.12,"Premium","H","I1",59.1,61.0,2854.0,6.78,6.75,4.0],[0.73,"Premium","E","VS2",62.0,57.0,2854.0,5.86,5.76,3.6],[0.91,"Fair","J","VS2",64.4,62.0,2854.0,6.06,6.03,3.89],[0.91,"Fair","J","VS2",65.4,60.0,2854.0,6.04,6.0,3.94],[0.91,"Good","J","VS2",64.2,58.0,2854.0,6.12,6.09,3.92],[0.91,"Fair","H","SI1",65.8,58.0,2854.0,6.04,6.01,3.96],[0.7,"Premium","E","VS1",58.4,59.0,2854.0,5.91,5.83,3.43],[0.68,"Premium","F","VVS2",61.7,57.0,2854.0,5.67,5.64,3.49],[0.73,"Very Good","F","VS2",62.5,57.0,2855.0,5.7,5.75,3.58],[1.03,"Good","J","SI1",63.6,57.0,2855.0,6.38,6.29,4.03],[0.74,"Premium","D","VS2",62.4,57.0,2855.0,5.8,5.74,3.6],[0.98,"Fair","E","SI2",53.3,67.0,2855.0,6.82,6.74,3.61],[1.02,"Fair","I","SI1",53.0,63.0,2856.0,6.84,6.77,3.66],[1.0,"Fair","G","SI2",67.8,61.0,2856.0,5.96,5.9,4.02],[1.02,"Ideal","H","SI2",61.6,55.0,2856.0,6.49,6.43,3.98],[0.6,"Ideal","F","VVS2",60.8,57.0,2856.0,5.44,5.49,3.32],[0.8,"Ideal","G","SI2",61.6,56.0,2856.0,5.97,6.01,3.69],[0.97,"Ideal","F","I1",60.7,56.0,2856.0,6.43,6.41,3.9],[1.0,"Fair","I","SI1",67.9,62.0,2856.0,6.19,6.03,4.15],[0.26,"Ideal","E","VS1",62.3,57.0,556.0,4.05,4.08,2.53],[0.26,"Ideal","E","VS1",62.1,56.0,556.0,4.09,4.12,2.55],[0.36,"Ideal","H","SI1",61.9,55.0,556.0,4.57,4.59,2.83],[0.34,"Good","G","VS2",57.5,61.0,556.0,4.6,4.66,2.66],[0.34,"Good","E","SI1",63.3,57.0,556.0,4.44,4.47,2.82],[0.34,"Good","E","SI1",63.5,55.0,556.0,4.44,4.47,2.83],[0.34,"Good","E","SI1",63.4,55.0,556.0,4.44,4.46,2.82],[0.34,"Very Good","G","VS2",59.6,62.0,556.0,4.54,4.56,2.71],[0.34,"Ideal","E","SI1",62.2,54.0,556.0,4.47,4.5,2.79],[0.32,"Good","E","VS2",64.1,54.0,556.0,4.34,4.37,2.79],[0.31,"Ideal","I","VVS1",61.6,55.0,557.0,4.36,4.41,2.7],[0.31,"Ideal","I","VVS1",61.3,56.0,557.0,4.36,4.38,2.68],[0.31,"Ideal","I","VVS1",62.3,54.0,557.0,4.37,4.4,2.73],[0.31,"Ideal","I","VVS1",62.0,54.0,557.0,4.37,4.4,2.72],[0.31,"Ideal","I","VVS1",62.7,53.0,557.0,4.33,4.35,2.72],[0.31,"Ideal","I","VVS1",62.2,53.0,557.0,4.36,4.38,2.72],[0.31,"Ideal","G","VS2",62.2,53.6,557.0,4.32,4.35,2.7],[0.31,"Ideal","H","VS1",61.6,54.8,557.0,4.35,4.37,2.69],[0.31,"Ideal","H","VS1",61.8,54.2,557.0,4.33,4.37,2.69],[0.33,"Premium","G","SI2",59.4,59.0,557.0,4.52,4.5,2.68],[0.33,"Premium","F","SI2",62.3,58.0,557.0,4.43,4.4,2.75],[0.33,"Premium","G","SI2",62.6,58.0,557.0,4.42,4.4,2.76],[0.33,"Ideal","G","SI2",61.9,56.0,557.0,4.45,4.41,2.74],[0.33,"Premium","F","SI2",63.0,58.0,557.0,4.42,4.4,2.78],[0.33,"Premium","J","VS1",62.8,58.0,557.0,4.41,4.38,2.76],[0.33,"Premium","J","VS1",61.5,61.0,557.0,4.46,4.39,2.72],[0.33,"Ideal","J","VS1",62.1,55.0,557.0,4.44,4.41,2.75],[0.33,"Ideal","I","SI1",63.0,57.0,557.0,4.39,4.37,2.76],[0.33,"Good","I","SI1",63.6,53.0,557.0,4.43,4.4,2.81],[0.33,"Premium","I","SI1",60.4,59.0,557.0,4.54,4.5,2.73],[1.0,"Fair","H","SI2",66.1,56.0,2856.0,6.21,5.97,4.04],[0.77,"Premium","F","SI1",60.8,59.0,2856.0,5.92,5.86,3.58],[0.77,"Premium","F","SI1",61.0,58.0,2856.0,5.94,5.9,3.61],[0.7,"Good","E","VVS2",60.1,63.0,2857.0,5.68,5.71,3.42],[0.9,"Very Good","G","SI2",63.1,58.0,2857.0,6.08,6.02,3.82],[0.72,"Ideal","E","SI1",62.3,57.0,2857.0,5.76,5.7,3.57],[0.9,"Premium","I","VS2",61.9,59.0,2857.0,6.2,6.14,3.82],[0.72,"Premium","E","SI1",62.1,58.0,2857.0,5.76,5.73,3.57],[0.7,"Ideal","G","VVS2",62.1,56.0,2858.0,5.63,5.71,3.52],[0.81,"Very Good","F","SI1",61.3,57.0,2858.0,6.02,6.05,3.7],[0.81,"Very Good","F","SI1",61.7,57.0,2858.0,6.0,6.05,3.72],[0.71,"Premium","E","VS2",61.0,60.0,2858.0,5.76,5.69,3.49],[0.7,"Premium","E","VS2",61.4,59.0,2858.0,5.73,5.7,3.51],[0.71,"Premium","E","VS2",61.5,60.0,2858.0,5.76,5.68,3.52],[0.71,"Very Good","E","VS2",63.5,59.0,2858.0,5.68,5.59,3.58],[0.92,"Premium","J","SI1",62.9,58.0,2858.0,6.22,6.18,3.9],[0.76,"Ideal","E","SI1",62.7,54.0,2858.0,5.88,5.83,3.67],[0.73,"Ideal","D","SI1",61.5,56.0,2858.0,5.84,5.8,3.58],[0.71,"Premium","D","VS2",60.4,62.0,2858.0,5.74,5.72,3.46],[0.7,"Good","E","VVS2",63.6,62.0,2858.0,5.61,5.58,3.56],[0.9,"Fair","G","SI2",64.5,56.0,2858.0,6.06,6.0,3.89],[0.71,"Fair","D","VS2",56.9,65.0,2858.0,5.89,5.84,3.34],[0.7,"Ideal","D","VS2",61.0,57.0,2859.0,5.76,5.74,3.51],[0.7,"Premium","D","VS2",62.4,56.0,2859.0,5.72,5.66,3.55],[0.77,"Premium","F","VS1",60.9,60.0,2859.0,5.91,5.88,3.59],[0.71,"Ideal","G","VS1",61.5,56.0,2859.0,5.74,5.78,3.54],[0.7,"Premium","D","VS2",59.6,61.0,2859.0,5.8,5.77,3.45],[0.75,"Fair","F","VS1",55.8,70.0,2859.0,6.09,5.98,3.37],[0.83,"Premium","E","SI2",59.2,60.0,2859.0,6.17,6.12,3.64],[0.71,"Very Good","F","VS2",61.3,61.0,2860.0,5.68,5.73,3.5],[0.9,"Very Good","J","SI2",63.6,58.0,2860.0,6.07,6.1,3.87],[0.6,"Ideal","E","VVS2",61.9,54.9,2860.0,5.41,5.44,3.35],[0.71,"Premium","D","VS1",62.9,57.0,2860.0,5.66,5.6,3.54],[0.53,"Ideal","F","VVS1",61.4,57.0,2860.0,5.23,5.2,3.2],[0.71,"Premium","D","SI1",60.7,58.0,2861.0,5.95,5.78,3.56],[0.62,"Ideal","G","VVS2",61.6,56.0,2861.0,5.45,5.48,3.37],[0.62,"Ideal","G","VVS2",61.6,56.0,2861.0,5.48,5.51,3.38],[0.9,"Premium","I","SI1",63.0,58.0,2861.0,6.09,6.01,3.81],[0.62,"Fair","F","IF",60.1,61.0,2861.0,5.53,5.56,3.33],[0.82,"Premium","E","SI2",61.7,59.0,2861.0,6.01,5.98,3.7],[0.66,"Premium","D","VS1",61.0,58.0,2861.0,5.67,5.57,3.43],[0.7,"Very Good","D","SI1",62.5,55.0,2862.0,5.67,5.72,3.56],[0.8,"Very Good","F","SI1",62.6,58.0,2862.0,5.9,5.92,3.7],[0.8,"Very Good","D","SI2",62.5,59.0,2862.0,5.88,5.92,3.69],[0.79,"Premium","F","SI1",62.3,54.0,2862.0,5.97,5.91,3.7],[0.71,"Very Good","F","VVS1",63.2,60.0,2862.0,5.65,5.61,3.56],[0.7,"Ideal","H","VS2",61.1,57.0,2862.0,5.71,5.74,3.5],[0.7,"Very Good","E","VS2",58.7,63.0,2862.0,5.73,5.69,3.35],[0.79,"Premium","H","VS1",60.0,60.0,2862.0,6.07,5.99,3.64],[0.7,"Premium","E","VS2",59.5,59.0,2862.0,5.82,5.77,3.45],[1.22,"Premium","E","I1",60.9,57.0,2862.0,6.93,6.88,4.21],[1.01,"Fair","E","SI2",67.6,57.0,2862.0,6.21,6.11,4.18],[0.73,"Premium","E","VS2",62.5,61.0,2862.0,5.78,5.64,3.59],[0.91,"Good","I","VS2",64.3,58.0,2863.0,6.05,6.09,3.9],[0.71,"Ideal","D","SI1",60.8,56.0,2863.0,5.8,5.77,3.52],[0.83,"Premium","G","SI1",62.3,58.0,2863.0,6.01,5.97,3.73],[0.84,"Premium","F","SI2",62.3,59.0,2863.0,6.06,6.01,3.76],[0.71,"Premium","D","SI1",61.0,61.0,2863.0,5.82,5.75,3.53],[0.71,"Premium","D","SI1",59.7,59.0,2863.0,5.82,5.8,3.47],[0.71,"Premium","D","SI1",61.7,56.0,2863.0,5.8,5.68,3.54],[0.71,"Ideal","D","SI1",61.7,57.0,2863.0,5.75,5.7,3.53],[0.71,"Premium","D","SI1",61.4,58.0,2863.0,5.79,5.75,3.54],[0.71,"Premium","D","SI1",60.6,58.0,2863.0,5.79,5.77,3.5],[0.91,"Premium","J","SI1",59.5,62.0,2863.0,6.4,6.18,3.74],[0.9,"Premium","J","VS2",59.8,62.0,2863.0,6.24,6.21,3.72],[0.71,"Premium","H","VVS2",61.5,62.0,2863.0,5.74,5.68,3.51],[0.71,"Premium","E","SI1",59.1,61.0,2863.0,5.84,5.8,3.44],[0.72,"Ideal","F","VS2",59.5,57.0,2863.0,5.91,5.86,3.5],[0.72,"Premium","E","SI1",60.9,60.0,2863.0,5.78,5.74,3.51],[0.71,"Ideal","E","VS2",61.0,55.0,2863.0,5.79,5.75,3.52],[0.81,"Ideal","E","SI2",60.3,57.0,2864.0,6.07,6.04,3.65],[0.83,"Very Good","I","VS2",61.6,58.0,2865.0,6.05,6.07,3.73],[0.73,"Premium","D","SI1",60.8,55.0,2865.0,5.87,5.81,3.55],[0.56,"Very Good","D","VVS1",62.0,56.0,2866.0,5.25,5.3,3.27],[0.56,"Very Good","D","VVS1",61.8,55.0,2866.0,5.27,5.31,3.27],[0.71,"Ideal","E","VS1",62.2,55.0,2866.0,5.74,5.7,3.56],[0.7,"Ideal","H","VVS1",62.3,58.0,2866.0,5.66,5.7,3.54],[0.96,"Premium","I","SI1",61.3,58.0,2866.0,6.39,6.3,3.89],[0.71,"Very Good","H","VVS1",62.9,57.0,2867.0,5.67,5.69,3.57],[0.7,"Ideal","D","VS2",62.4,57.0,2867.0,5.68,5.61,3.52],[0.71,"Ideal","H","VVS1",60.4,57.0,2867.0,5.78,5.81,3.5],[0.8,"Premium","H","VS2",61.2,53.0,2867.0,6.05,5.98,3.68],[0.95,"Premium","F","SI2",58.4,57.0,2867.0,6.49,6.41,3.77],[0.82,"Ideal","F","SI2",62.3,56.0,2867.0,5.99,5.95,3.72],[0.52,"Ideal","F","VVS1",61.2,56.0,2867.0,5.21,5.19,3.18],[0.82,"Ideal","F","SI2",61.7,53.0,2867.0,6.12,6.0,3.74],[0.82,"Ideal","F","SI2",62.3,56.0,2867.0,6.02,5.96,3.73],[0.82,"Premium","F","SI2",59.7,57.0,2867.0,6.14,6.12,3.66],[0.8,"Ideal","G","SI1",61.3,57.0,2867.0,5.96,5.91,3.64],[0.96,"Fair","F","SI2",68.2,61.0,2867.0,6.07,5.88,4.1],[0.72,"Ideal","I","VS1",62.4,55.0,2868.0,5.72,5.75,3.58],[0.62,"Ideal","G","IF",60.5,57.0,2868.0,5.52,5.56,3.35],[0.79,"Premium","E","SI2",61.0,58.0,2868.0,5.96,5.9,3.62],[0.75,"Very Good","E","SI1",63.1,56.0,2868.0,5.78,5.7,3.62],[1.08,"Premium","D","I1",61.9,60.0,2869.0,6.55,6.48,4.03],[0.72,"Ideal","E","SI1",60.8,55.0,2869.0,5.77,5.84,3.53],[0.62,"Ideal","G","IF",61.8,56.0,2869.0,5.43,5.47,3.37],[0.73,"Ideal","G","VVS2",61.3,57.0,2869.0,5.84,5.81,3.57],[0.72,"Ideal","H","VVS2",60.9,57.0,2869.0,5.79,5.77,3.52],[0.52,"Premium","F","VVS2",61.8,60.0,2870.0,5.16,5.13,3.18],[0.83,"Ideal","E","SI2",62.2,57.0,2870.0,6.0,6.05,3.75],[0.64,"Premium","E","VVS2",62.1,58.0,2870.0,5.56,5.51,3.44],[0.8,"Ideal","G","SI1",62.5,57.0,2870.0,5.94,5.9,3.7],[0.74,"Ideal","H","SI1",62.1,56.0,2870.0,5.77,5.83,3.6],[0.72,"Ideal","F","SI1",61.5,56.0,2870.0,5.72,5.79,3.54],[0.82,"Ideal","H","VS2",59.5,57.0,2870.0,6.12,6.09,3.63],[0.73,"Premium","E","VS1",61.3,59.0,2870.0,5.81,5.78,3.55],[1.04,"Premium","I","I1",61.6,61.0,2870.0,6.47,6.45,3.98],[0.73,"Very Good","E","SI1",61.3,58.0,2871.0,5.76,5.83,3.55],[0.73,"Good","E","SI1",63.6,57.0,2871.0,5.7,5.72,3.63],[0.9,"Premium","J","SI1",62.8,59.0,2871.0,6.13,6.03,3.82],[0.75,"Ideal","I","SI1",61.8,55.0,2871.0,5.83,5.85,3.61],[0.79,"Ideal","G","SI1",62.6,55.0,2871.0,5.91,5.95,3.71],[0.7,"Good","D","SI1",62.5,56.7,2872.0,5.59,5.62,3.51],[0.75,"Very Good","D","SI1",60.7,55.0,2872.0,5.87,5.92,3.58],[1.02,"Ideal","I","I1",61.7,56.0,2872.0,6.44,6.49,3.99],[0.7,"Very Good","G","SI2",59.0,62.0,2872.0,5.79,5.81,3.42],[0.7,"Ideal","D","SI1",61.8,56.0,2872.0,5.63,5.73,3.51],[0.7,"Good","E","SI1",61.4,64.0,2872.0,5.66,5.71,3.49],[0.7,"Ideal","D","SI1",61.4,54.0,2872.0,5.71,5.75,3.52],[0.7,"Ideal","D","SI1",60.7,56.0,2872.0,5.72,5.75,3.48],[0.7,"Very Good","D","SI1",60.2,60.0,2872.0,5.75,5.82,3.48],[0.72,"Very Good","E","VS2",58.3,57.0,2872.0,5.89,5.94,3.45],[0.74,"Ideal","E","SI1",62.3,58.0,2872.0,5.74,5.78,3.59],[0.84,"Good","G","SI1",65.1,55.0,2872.0,5.88,5.97,3.86],[0.76,"Very Good","F","VS2",62.0,58.0,2873.0,5.8,5.86,3.62],[0.77,"Very Good","E","SI1",63.2,58.0,2873.0,5.8,5.84,3.68],[0.76,"Ideal","E","SI2",62.8,56.0,2873.0,5.78,5.82,3.64],[1.0,"Ideal","I","SI2",61.7,56.0,2873.0,6.45,6.41,3.97],[1.0,"Fair","H","SI1",65.5,62.0,2873.0,6.14,6.07,4.0],[0.9,"Fair","I","SI1",65.7,58.0,2873.0,6.03,6.0,3.95],[0.9,"Premium","J","SI1",61.8,58.0,2873.0,6.16,6.13,3.8],[0.9,"Good","J","SI1",64.0,61.0,2873.0,6.0,5.96,3.83],[0.9,"Fair","I","SI1",65.3,61.0,2873.0,5.98,5.94,3.89],[0.9,"Fair","I","SI1",65.8,56.0,2873.0,6.01,5.96,3.94],[0.9,"Premium","J","SI1",60.9,61.0,2873.0,6.26,6.22,3.8],[0.78,"Premium","F","VS2",62.6,58.0,2874.0,5.91,5.82,3.67],[0.71,"Premium","D","VS2",61.2,59.0,2874.0,5.69,5.74,3.5],[0.7,"Premium","F","VS1",59.0,59.0,2874.0,5.79,5.77,3.41],[0.7,"Premium","F","VS1",60.8,62.0,2874.0,5.71,5.67,3.46],[0.7,"Premium","G","VVS2",61.8,58.0,2874.0,5.67,5.63,3.49],[0.7,"Ideal","F","VS1",61.0,55.0,2874.0,5.77,5.73,3.51],[0.7,"Ideal","F","VS1",61.6,55.0,2874.0,5.75,5.71,3.53],[0.7,"Ideal","F","VS1",62.4,56.0,2874.0,5.69,5.65,3.54],[0.7,"Premium","G","VVS2",62.9,59.0,2874.0,5.68,5.61,3.55],[1.0,"Fair","H","SI2",67.7,60.0,2875.0,6.11,5.98,4.09],[0.77,"Ideal","H","SI1",62.4,56.0,2875.0,5.84,5.9,3.66],[1.0,"Fair","J","VS1",65.5,55.0,2875.0,6.3,6.25,4.11],[1.0,"Fair","I","SI1",66.3,61.0,2875.0,6.08,6.03,4.01],[1.0,"Fair","H","SI2",69.5,55.0,2875.0,6.17,6.1,4.26],[0.73,"Premium","E","VS1",62.6,60.0,2876.0,5.68,5.75,3.58],[0.79,"Premium","E","VS2",60.6,53.0,2876.0,6.04,5.98,3.64],[0.72,"Very Good","H","VS1",62.2,54.0,2877.0,5.74,5.76,3.57],[0.71,"Ideal","E","VS1",62.4,56.0,2877.0,5.75,5.7,3.57],[0.74,"Ideal","G","VS2",62.3,55.0,2877.0,5.8,5.83,3.62],[0.7,"Good","H","VVS1",62.7,56.0,2877.0,5.6,5.66,3.53],[0.7,"Good","F","VS1",59.1,62.0,2877.0,5.82,5.86,3.44],[0.79,"Very Good","F","SI1",62.8,59.0,2878.0,5.86,5.89,3.69],[0.79,"Very Good","F","SI1",62.7,60.0,2878.0,5.82,5.89,3.67],[0.79,"Very Good","D","SI2",59.7,58.0,2878.0,6.0,6.07,3.6],[0.71,"Ideal","I","VS2",61.5,55.0,2878.0,5.76,5.78,3.55],[0.79,"Ideal","F","SI1",62.8,56.0,2878.0,5.88,5.9,3.7],[0.73,"Very Good","F","SI1",61.4,56.0,2879.0,5.81,5.86,3.58],[0.63,"Premium","E","IF",60.3,62.0,2879.0,5.55,5.53,3.34],[0.7,"Premium","F","VS1",60.4,60.0,2879.0,5.73,5.7,3.45],[0.71,"Premium","F","VS1",62.7,58.0,2879.0,5.71,5.67,3.57],[0.84,"Ideal","G","SI2",61.0,56.0,2879.0,6.13,6.1,3.73],[0.84,"Ideal","G","SI2",62.3,55.0,2879.0,6.08,6.03,3.77],[1.02,"Ideal","J","SI2",60.3,54.0,2879.0,6.53,6.5,3.93],[0.72,"Fair","F","VS1",56.9,69.0,2879.0,5.93,5.77,3.33],[0.72,"Ideal","F","VS1",62.0,56.0,2879.0,5.76,5.73,3.56],[0.92,"Very Good","J","SI2",58.7,61.0,2880.0,6.34,6.43,3.75],[0.74,"Very Good","D","SI1",63.9,57.0,2880.0,5.72,5.74,3.66],[0.7,"Ideal","H","VVS1",62.0,55.0,2881.0,5.74,5.71,3.55],[0.71,"Very Good","E","VS2",60.0,59.0,2881.0,5.84,5.83,3.5],[1.05,"Premium","H","I1",62.0,59.0,2881.0,6.5,6.47,4.02],[0.7,"Very Good","H","IF",62.8,56.0,2882.0,5.62,5.65,3.54],[0.54,"Ideal","F","VVS1",61.8,56.0,2882.0,5.23,5.26,3.24],[0.73,"Premium","F","VS2",59.9,58.0,2882.0,5.87,5.84,3.51],[0.88,"Fair","F","SI1",56.6,65.0,2882.0,6.39,6.32,3.6],[0.73,"Premium","F","VS2",58.7,57.0,2882.0,5.97,5.92,3.49],[0.72,"Ideal","D","SI1",61.8,56.0,2883.0,5.75,5.81,3.57],[0.9,"Good","H","SI2",62.7,64.0,2883.0,6.09,6.0,3.79],[0.9,"Fair","H","SI2",65.0,61.0,2883.0,6.01,5.96,3.89],[1.03,"Fair","I","SI2",65.3,55.0,2884.0,6.32,6.27,4.11],[0.84,"Very Good","F","SI1",63.8,57.0,2885.0,5.95,6.0,3.81],[1.01,"Premium","I","SI1",62.7,60.0,2885.0,6.36,6.27,3.96],[0.77,"Ideal","D","SI2",61.5,55.0,2885.0,5.9,5.93,3.64],[0.8,"Fair","E","SI1",56.3,63.0,2885.0,6.22,6.14,3.48],[0.9,"Fair","D","SI2",66.9,57.0,2885.0,6.02,5.9,3.99],[0.73,"Ideal","E","SI1",61.4,56.0,2886.0,5.79,5.81,3.56],[0.72,"Ideal","E","SI1",62.7,55.0,2886.0,5.64,5.69,3.55],[0.71,"Very Good","D","SI1",62.4,54.0,2887.0,5.71,5.79,3.59],[0.7,"Premium","E","VS1",62.6,59.0,2887.0,5.66,5.69,3.55],[0.79,"Ideal","I","VS1",61.7,59.0,2888.0,5.93,5.96,3.67],[0.72,"Very Good","G","VVS2",62.5,58.0,2889.0,5.68,5.72,3.56],[0.7,"Very Good","E","VS2",63.5,54.0,2889.0,5.62,5.66,3.58],[0.7,"Very Good","F","VS1",62.2,58.0,2889.0,5.64,5.75,3.54],[0.9,"Good","H","SI2",63.5,58.0,2889.0,6.09,6.14,3.88],[0.71,"Very Good","F","VS1",62.8,56.0,2889.0,5.69,5.72,3.58],[0.5,"Ideal","E","VVS2",62.2,54.0,2889.0,5.08,5.12,3.17],[0.5,"Ideal","E","VVS2",62.2,54.0,2889.0,5.09,5.11,3.17],[0.74,"Ideal","F","SI1",61.2,56.0,2889.0,5.83,5.87,3.58],[0.77,"Premium","F","VS2",61.8,56.0,2889.0,5.94,5.9,3.66],[0.77,"Premium","E","SI1",59.8,61.0,2889.0,5.99,5.95,3.57],[0.8,"Ideal","F","SI1",61.5,54.0,2890.0,6.07,6.0,3.71],[0.8,"Ideal","F","SI1",62.4,57.0,2890.0,5.9,5.87,3.67],[0.8,"Premium","F","SI1",61.5,60.0,2890.0,5.97,5.94,3.66],[0.8,"Good","F","SI1",63.8,59.0,2890.0,5.87,5.83,3.73],[0.66,"Ideal","G","VVS1",61.5,56.0,2890.0,5.61,5.58,3.44],[0.71,"Very Good","E","VS2",61.2,58.0,2891.0,5.71,5.79,3.52],[0.71,"Ideal","F","VS2",61.2,56.0,2891.0,5.73,5.77,3.52],[0.71,"Ideal","E","VS2",61.6,56.0,2891.0,5.74,5.76,3.54],[0.71,"Ideal","E","VS2",62.7,56.0,2891.0,5.71,5.75,3.59],[0.72,"Ideal","D","SI1",61.1,56.0,2891.0,5.78,5.81,3.54],[0.71,"Good","D","VS2",62.3,61.0,2891.0,5.7,5.73,3.56],[0.86,"Ideal","H","SI2",61.8,55.0,2892.0,6.12,6.14,3.79],[1.19,"Fair","H","I1",65.1,59.0,2892.0,6.62,6.55,4.29],[0.71,"Very Good","F","VS1",62.6,55.0,2893.0,5.66,5.71,3.56],[0.82,"Very Good","G","SI2",62.5,56.0,2893.0,5.99,6.04,3.76],[0.71,"Ideal","G","VVS2",61.5,57.0,2893.0,5.73,5.75,3.53],[0.75,"Ideal","F","VS2",62.5,57.0,2893.0,5.78,5.83,3.63],[0.7,"Very Good","H","VVS1",59.2,60.0,2893.0,5.87,5.78,3.45],[0.8,"Ideal","G","SI2",62.5,55.0,2893.0,5.89,5.92,3.69],[0.82,"Good","G","SI2",59.9,62.0,2893.0,6.02,6.04,3.61],[0.82,"Very Good","G","SI1",63.4,55.0,2893.0,6.0,5.93,3.78],[0.82,"Premium","G","SI1",59.9,59.0,2893.0,6.09,6.06,3.64],[0.81,"Very Good","E","SI2",62.4,57.0,2894.0,5.91,5.99,3.71],[0.81,"Ideal","G","SI2",62.2,57.0,2894.0,5.96,6.0,3.72],[0.76,"Ideal","F","SI1",61.4,56.0,2894.0,5.88,5.92,3.62],[0.71,"Very Good","G","VS2",60.9,56.0,2895.0,5.75,5.78,3.51],[0.7,"Very Good","F","VS1",61.8,59.0,2895.0,5.66,5.76,3.53],[0.7,"Ideal","G","VVS2",62.1,53.0,2895.0,5.71,5.75,3.56],[0.74,"Very Good","G","VS1",59.8,58.0,2896.0,5.85,5.89,3.51],[0.77,"Very Good","G","VS2",61.3,60.0,2896.0,5.81,5.91,3.59],[0.77,"Very Good","G","VS2",58.3,63.0,2896.0,6.0,6.05,3.51],[0.53,"Ideal","F","VVS1",61.6,56.0,2896.0,5.18,5.24,3.21],[0.79,"Ideal","D","SI1",61.5,56.0,2896.0,5.91,5.96,3.65],[0.73,"Ideal","E","SI2",61.5,55.0,2896.0,5.82,5.86,3.59],[0.77,"Ideal","D","SI2",62.1,56.0,2896.0,5.83,5.89,3.64],[0.77,"Premium","E","SI1",60.9,58.0,2896.0,5.94,5.88,3.6],[1.01,"Very Good","I","I1",63.1,57.0,2896.0,6.39,6.35,4.02],[1.01,"Ideal","I","I1",61.5,57.0,2896.0,6.46,6.45,3.97],[0.6,"Very Good","D","VVS2",60.6,57.0,2897.0,5.48,5.51,3.33],[0.76,"Premium","E","SI1",61.1,58.0,2897.0,5.91,5.85,3.59],[0.54,"Ideal","D","VVS2",61.4,52.0,2897.0,5.3,5.34,3.26],[0.72,"Ideal","E","SI1",62.5,55.0,2897.0,5.69,5.74,3.57],[0.72,"Good","F","VS1",59.4,61.0,2897.0,5.82,5.89,3.48],[0.74,"Premium","D","VS2",61.8,58.0,2897.0,5.81,5.77,3.58],[1.12,"Premium","J","SI2",60.6,59.0,2898.0,6.68,6.61,4.03]],"arguments":{},"schema":[{"type":"double","name":"carat"},{"type":"string","name":"cut"},{"type":"string","name":"color"},{"type":"string","name":"clarity"},{"type":"double","name":"depth"},{"type":"double","name":"table"},{"type":"double","name":"price"},{"type":"double","name":"x"},{"type":"double","name":"y"},{"type":"double","name":"z"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-128-99284b6a7557&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    display(diamondsDF)}</span>\n<span class=\"ansigrey\">                       ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","startTime":1.445636678624E12,"submitTime":1.445636678193E12,"finishTime":1.445636680329E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1346","height":"302","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"3e3a325e-f909-45c2-a534-dea9370d5a42"},{"version":"CommandV1","origId":2240,"guid":"3d01276f-9a16-4854-b915-f6e7606f13f7","subtype":"command","commandType":"auto","position":3.7890625,"command":"%md ## Understand the data\n\nLet's examine the data to get a better understanding of what is there.  We only examine a couple of features (columns), but it gives an idea of the type of exploration you might do to understand a new dataset.\n\nFor more examples of using Databricks's visualization to explore a dataset, see the [Visualizations Notebook](../04 Visualizations/0 Visualizations Overview.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.43399542935E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"d8a782cc-17fc-4153-842e-7fb056577702"},{"version":"CommandV1","origId":2241,"guid":"70ce669d-7422-49a5-968f-713f67e29d73","subtype":"command","commandType":"auto","position":3.796875,"command":"# There are 10 columns.  We will try to predict the price of diamonds, treating the other 9 columns as features.\ndiamondsDF.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- carat: double (nullable = true)\n |-- cut: string (nullable = true)\n |-- color: string (nullable = true)\n |-- clarity: string (nullable = true)\n |-- depth: double (nullable = true)\n |-- table: double (nullable = true)\n |-- price: double (nullable = true)\n |-- x: double (nullable = true)\n |-- y: double (nullable = true)\n |-- z: double (nullable = true)\n\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;diamonds&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-5-aa85ccae171a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># There are 10 columns.  We will try to predict the price of diamonds, treating the other 9 columns as features.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>diamonds<span class=\"ansiyellow\">.</span>printSchema<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;diamonds&apos; is not defined\n</div>","startTime":1.445292496185E12,"submitTime":1.445292496134E12,"finishTime":1.445292496206E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"86cf8a8a-7f06-49a1-aea7-67dbf66c38a1"},{"version":"CommandV1","origId":2242,"guid":"909cecee-e911-459a-b46e-db3689d0e859","subtype":"command","commandType":"auto","position":4.3046875,"command":"%md  We can see we have a mix of categorical features (cut, color, clarity) and continuous features.  Let's first look at the categorical features.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427838066402E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"b6441e59-3fd8-45ee-8fbf-8355cc6d8687"},{"version":"CommandV1","origId":2243,"guid":"ff603233-d36c-4817-a6e6-28dac13bf570","subtype":"command","commandType":"auto","position":4.4296875,"command":"# View distinct diamond cuts in dataset\ncuts = diamondsDF.select(\"cut\").distinct().collect()\ndisplay(cuts)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Ideal"],["Fair"],["Very Good"],["Good"],["Premium"]],"arguments":{},"schema":[{"type":"string","name":"cut"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445292519167E12,"submitTime":1.445292519121E12,"finishTime":1.445292520603E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"168","height":"211","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"4a1a9ce4-6aee-4cc3-95d4-9107069d15ee"},{"version":"CommandV1","origId":2244,"guid":"4fbdc520-7a50-4204-85a5-b60af760d0d8","subtype":"command","commandType":"auto","position":4.4921875,"command":"# View distinct diamond colors in dataset\ncolors = diamondsDF.select(\"color\").distinct().collect()\ndisplay(colors)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["D"],["E"],["F"],["G"],["H"],["I"],["J"]],"arguments":{},"schema":[{"type":"string","name":"color"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445292521365E12,"submitTime":1.445292521304E12,"finishTime":1.445292522329E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"164","height":"243","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"631481a2-20a2-450d-a54e-c06d2050e6e6"},{"version":"CommandV1","origId":2245,"guid":"eb90a570-0c0a-4e39-b396-cd77faddfff1","subtype":"command","commandType":"auto","position":4.5234375,"command":"# View distinct diamond clarities in dataset\nclarities = diamondsDF.select(\"clarity\").distinct().collect()\ndisplay(clarities)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["VS1"],["VS2"],["SI1"],["SI2"],["I1"],["IF"],["VVS1"],["VVS2"]],"arguments":{},"schema":[{"type":"string","name":"clarity"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445292523882E12,"submitTime":1.445292523841E12,"finishTime":1.44529252484E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"163","height":"278","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"d1f1373e-33f1-4b4f-a210-d6a54efc6f14"},{"version":"CommandV1","origId":2246,"guid":"c876ee76-fb8a-4c09-bda3-bb9f3451be51","subtype":"command","commandType":"auto","position":4.5703125,"command":"# We can examine the distribution of a particular feature by using display(), clicking on the chart icon and Plot Options, and setting Value=<id> and Aggregation=COUNT.\ndisplay(diamondsDF.select(\"cut\"))\n# You can also try this using columns \"color\" and \"clarity\"","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Ideal"],["Premium"],["Good"],["Premium"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Fair"],["Very Good"],["Good"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Good"],["Good"],["Very Good"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Premium"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Good"],["Good"],["Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Good"],["Good"],["Good"],["Premium"],["Very Good"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Very Good"],["Good"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Fair"],["Ideal"],["Very Good"],["Very Good"],["Good"],["Good"],["Fair"],["Very Good"],["Premium"],["Very Good"],["Premium"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Fair"],["Fair"],["Premium"],["Premium"],["Very Good"],["Fair"],["Fair"],["Ideal"],["Very Good"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Good"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Good"],["Very Good"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Good"],["Ideal"],["Very Good"],["Premium"],["Very Good"],["Good"],["Good"],["Ideal"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Premium"],["Premium"],["Good"],["Fair"],["Premium"],["Very Good"],["Ideal"],["Very Good"],["Ideal"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Premium"],["Fair"],["Premium"],["Ideal"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Good"],["Ideal"],["Fair"],["Premium"],["Good"],["Good"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Fair"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Premium"],["Premium"],["Ideal"],["Very Good"],["Very Good"],["Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Good"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Fair"],["Premium"],["Fair"],["Very Good"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Good"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Fair"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Good"],["Good"],["Premium"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Fair"],["Premium"],["Premium"],["Ideal"],["Fair"],["Premium"],["Ideal"],["Fair"],["Good"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Very Good"],["Very Good"],["Fair"],["Very Good"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Fair"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Good"],["Very Good"],["Very Good"],["Fair"],["Fair"],["Very Good"],["Very Good"],["Good"],["Very Good"],["Premium"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Premium"],["Premium"],["Very Good"],["Good"],["Ideal"],["Very Good"],["Good"],["Ideal"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Fair"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Good"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Fair"],["Fair"],["Premium"],["Premium"],["Fair"],["Premium"],["Very Good"],["Ideal"],["Good"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Premium"],["Fair"],["Very Good"],["Ideal"],["Good"],["Good"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Good"],["Premium"],["Premium"],["Premium"],["Very Good"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Premium"],["Ideal"],["Good"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Good"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Very Good"],["Good"],["Premium"],["Ideal"],["Fair"],["Ideal"],["Premium"],["Ideal"],["Good"],["Ideal"],["Premium"],["Premium"],["Premium"],["Very Good"],["Premium"],["Premium"],["Fair"],["Premium"],["Good"],["Premium"],["Premium"],["Very Good"],["Premium"],["Very Good"],["Premium"],["Ideal"],["Very Good"],["Good"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Good"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Ideal"],["Premium"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Fair"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Good"],["Premium"],["Ideal"],["Ideal"],["Very Good"],["Fair"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Very Good"],["Premium"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Ideal"],["Premium"],["Fair"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Ideal"],["Very Good"],["Very Good"],["Good"],["Premium"],["Ideal"],["Very Good"],["Ideal"],["Fair"],["Good"],["Ideal"],["Ideal"],["Good"],["Premium"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Fair"],["Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Premium"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Good"],["Ideal"],["Premium"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Fair"],["Fair"],["Good"],["Fair"],["Premium"],["Premium"],["Very Good"],["Good"],["Premium"],["Fair"],["Fair"],["Fair"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Fair"],["Ideal"],["Ideal"],["Ideal"],["Good"],["Good"],["Good"],["Good"],["Very Good"],["Ideal"],["Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Premium"],["Ideal"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Good"],["Premium"],["Fair"],["Premium"],["Premium"],["Good"],["Very Good"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Very Good"],["Very Good"],["Premium"],["Premium"],["Premium"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Good"],["Fair"],["Fair"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Premium"],["Fair"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Fair"],["Premium"],["Premium"],["Very Good"],["Very Good"],["Very Good"],["Premium"],["Very Good"],["Ideal"],["Very Good"],["Premium"],["Premium"],["Premium"],["Fair"],["Premium"],["Good"],["Ideal"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Fair"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Ideal"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Very Good"],["Good"],["Premium"],["Ideal"],["Ideal"],["Good"],["Very Good"],["Ideal"],["Very Good"],["Ideal"],["Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Fair"],["Fair"],["Premium"],["Good"],["Fair"],["Fair"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Fair"],["Ideal"],["Fair"],["Fair"],["Fair"],["Premium"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Good"],["Good"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Ideal"],["Fair"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Premium"],["Very Good"],["Ideal"],["Premium"],["Fair"],["Premium"],["Ideal"],["Good"],["Fair"],["Fair"],["Very Good"],["Premium"],["Ideal"],["Fair"],["Fair"],["Ideal"],["Ideal"],["Very Good"],["Premium"],["Ideal"],["Very Good"],["Very Good"],["Very Good"],["Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Premium"],["Ideal"],["Ideal"],["Premium"],["Good"],["Ideal"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Good"],["Ideal"],["Fair"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Ideal"],["Good"],["Very Good"],["Premium"],["Very Good"],["Ideal"],["Ideal"],["Very Good"],["Very Good"],["Ideal"],["Very Good"],["Very Good"],["Very Good"],["Ideal"],["Ideal"],["Ideal"],["Ideal"],["Premium"],["Very Good"],["Ideal"],["Very Good"],["Premium"],["Ideal"],["Ideal"],["Good"],["Premium"],["Premium"]],"arguments":{},"schema":[{"type":"string","name":"cut"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445292526566E12,"submitTime":1.445292526489E12,"finishTime":1.445292526759E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["cut"],"yColumns":["<id>"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"barChart":[],"histogram":[{"key":null,"value":"20"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"2d5b9d44-ad36-45f8-add9-c31ed7dcf16e"},{"version":"CommandV1","origId":2247,"guid":"393396c1-eeca-4a7f-9a4c-7b14194dc419","subtype":"command","commandType":"auto","position":4.59375,"command":"%md Now let's examine one of the continuous features as an example.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.4278380779E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"55d6ae8c-5922-4d03-a329-c61269beee63"},{"version":"CommandV1","origId":2248,"guid":"7a31fce0-a409-4d45-96ca-8428bed7d968","subtype":"command","commandType":"auto","position":4.60986328125,"command":"# Select: \"Plot Options...\" --> \"Display type\" --> \"histogram plot\"\ndisplay(diamondsDF.select(\"carat\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.23],[0.21],[0.23],[0.29],[0.31],[0.24],[0.24],[0.26],[0.22],[0.23],[0.3],[0.23],[0.22],[0.31],[0.2],[0.32],[0.3],[0.3],[0.3],[0.3],[0.3],[0.23],[0.23],[0.31],[0.31],[0.23],[0.24],[0.3],[0.23],[0.23],[0.23],[0.23],[0.23],[0.23],[0.23],[0.23],[0.23],[0.31],[0.26],[0.33],[0.33],[0.33],[0.26],[0.26],[0.32],[0.29],[0.32],[0.32],[0.25],[0.29],[0.24],[0.23],[0.32],[0.22],[0.22],[0.3],[0.3],[0.3],[0.3],[0.3],[0.35],[0.3],[0.3],[0.3],[0.42],[0.28],[0.32],[0.31],[0.31],[0.24],[0.24],[0.3],[0.3],[0.3],[0.3],[0.26],[0.26],[0.26],[0.26],[0.26],[0.26],[0.26],[0.26],[0.38],[0.26],[0.24],[0.24],[0.24],[0.24],[0.32],[0.7],[0.86],[0.7],[0.71],[0.78],[0.7],[0.7],[0.96],[0.73],[0.8],[0.75],[0.75],[0.74],[0.75],[0.8],[0.75],[0.8],[0.74],[0.81],[0.59],[0.8],[0.74],[0.9],[0.74],[0.73],[0.73],[0.8],[0.71],[0.7],[0.8],[0.71],[0.74],[0.7],[0.7],[0.7],[0.7],[0.91],[0.61],[0.91],[0.91],[0.77],[0.71],[0.71],[0.7],[0.77],[0.63],[0.71],[0.71],[0.76],[0.64],[0.71],[0.71],[0.7],[0.7],[0.71],[0.7],[0.71],[0.73],[0.7],[0.7],[0.71],[0.74],[0.71],[0.73],[0.76],[0.76],[0.71],[0.73],[0.73],[0.73],[0.73],[0.72],[0.73],[0.71],[0.79],[0.73],[0.8],[0.58],[0.58],[0.71],[0.75],[0.7],[1.17],[0.6],[0.7],[0.83],[0.74],[0.72],[0.71],[0.71],[0.54],[0.54],[0.72],[0.72],[0.72],[0.71],[0.7],[0.71],[0.71],[0.71],[0.71],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.72],[0.7],[0.7],[0.7],[0.7],[0.98],[0.78],[0.7],[0.52],[0.73],[0.74],[0.7],[0.77],[0.71],[0.74],[0.7],[1.01],[0.77],[0.78],[0.72],[0.53],[0.76],[0.7],[0.7],[0.75],[0.72],[0.72],[0.7],[0.84],[0.75],[0.52],[0.72],[0.79],[0.72],[0.51],[0.64],[0.7],[0.83],[0.76],[0.71],[0.77],[0.71],[1.01],[1.01],[0.77],[0.76],[0.76],[0.76],[1.05],[0.81],[0.7],[0.55],[0.81],[0.63],[0.63],[0.77],[1.05],[0.64],[0.76],[0.83],[0.71],[0.71],[0.87],[0.73],[0.71],[0.71],[0.71],[0.7],[0.7],[0.76],[0.7],[0.79],[0.7],[0.7],[0.76],[0.73],[0.79],[0.71],[0.81],[0.81],[0.72],[0.72],[0.72],[0.81],[0.72],[1.0],[0.73],[0.81],[0.81],[0.71],[0.71],[0.71],[0.57],[0.51],[0.72],[0.74],[0.74],[0.7],[0.8],[1.01],[0.8],[0.77],[0.83],[0.82],[0.78],[0.6],[0.9],[0.7],[0.9],[0.83],[0.83],[0.83],[0.74],[0.79],[0.61],[0.76],[0.96],[0.73],[0.73],[0.75],[0.71],[0.71],[0.71],[0.71],[1.04],[1.0],[0.87],[0.53],[0.72],[0.72],[0.7],[0.74],[0.71],[0.73],[0.7],[0.71],[0.71],[0.71],[0.77],[0.71],[0.78],[0.71],[0.91],[0.71],[0.71],[0.8],[0.7],[0.72],[0.72],[0.82],[0.7],[0.72],[0.72],[0.9],[0.74],[0.74],[0.73],[0.57],[0.73],[0.72],[0.74],[0.82],[0.81],[0.75],[0.7],[0.71],[0.71],[0.93],[0.8],[0.7],[1.0],[0.75],[0.58],[0.73],[0.81],[0.81],[0.71],[1.2],[0.7],[0.7],[0.74],[0.7],[0.8],[0.75],[0.83],[1.0],[0.99],[0.7],[0.7],[0.7],[0.7],[0.32],[0.32],[0.32],[0.32],[0.32],[0.32],[0.3],[0.3],[0.3],[0.3],[0.3],[0.3],[0.3],[0.32],[0.33],[0.29],[0.29],[0.31],[0.34],[0.34],[0.34],[0.34],[0.3],[0.29],[0.35],[0.43],[0.32],[0.36],[0.3],[0.26],[0.7],[0.7],[0.71],[0.99],[0.73],[0.51],[0.91],[0.84],[0.91],[0.76],[0.76],[0.75],[0.55],[0.76],[0.74],[0.7],[0.7],[0.7],[0.7],[0.9],[0.95],[0.89],[0.72],[0.96],[1.02],[0.78],[0.61],[0.71],[0.78],[0.87],[0.83],[0.71],[0.71],[0.71],[0.71],[0.63],[0.71],[0.71],[0.71],[0.71],[0.9],[0.71],[0.7],[0.7],[0.7],[1.0],[0.86],[0.8],[0.7],[0.7],[0.7],[0.7],[1.0],[0.72],[0.72],[0.7],[0.86],[0.71],[0.75],[0.73],[0.53],[0.73],[0.73],[0.73],[0.73],[0.73],[0.73],[0.7],[0.72],[0.72],[0.72],[0.7],[0.6],[0.74],[0.73],[0.71],[0.71],[0.7],[0.7],[0.9],[0.71],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.79],[0.9],[0.71],[0.61],[0.9],[0.71],[0.71],[0.77],[0.74],[0.82],[0.82],[0.71],[0.83],[0.73],[0.83],[1.17],[0.91],[0.73],[0.7],[0.9],[0.7],[0.7],[0.7],[0.9],[0.78],[0.96],[0.7],[0.72],[0.79],[0.7],[0.7],[0.7],[1.01],[0.72],[0.8],[0.59],[0.72],[0.75],[0.8],[0.71],[0.77],[0.97],[0.53],[0.53],[0.8],[0.9],[0.76],[0.72],[0.75],[0.72],[0.79],[0.72],[0.91],[0.71],[0.81],[0.82],[0.71],[0.9],[0.8],[0.56],[0.7],[0.7],[0.61],[0.85],[0.7],[0.8],[0.8],[0.51],[0.53],[0.78],[0.9],[0.9],[0.77],[0.73],[0.63],[0.7],[0.72],[0.72],[0.75],[0.82],[0.71],[0.7],[0.7],[0.71],[0.76],[0.82],[0.72],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.74],[0.71],[0.7],[0.71],[0.71],[0.71],[0.71],[0.7],[0.73],[0.7],[0.7],[0.71],[0.71],[0.79],[0.71],[0.77],[0.75],[0.7],[0.71],[0.92],[0.83],[0.7],[0.73],[0.71],[0.73],[0.82],[0.82],[0.82],[0.52],[1.0],[0.95],[0.73],[0.73],[0.73],[0.8],[0.7],[0.7],[0.7],[0.71],[0.81],[0.71],[0.73],[0.73],[0.72],[0.81],[0.71],[0.73],[0.7],[1.01],[1.01],[0.79],[0.7],[0.7],[0.8],[1.27],[0.79],[0.72],[0.73],[1.01],[1.01],[0.73],[0.7],[0.7],[0.77],[0.77],[0.77],[0.84],[0.72],[0.76],[0.7],[0.54],[0.75],[0.79],[0.74],[0.7],[0.7],[0.75],[1.2],[0.8],[0.66],[0.87],[0.86],[0.74],[0.58],[0.78],[0.74],[0.73],[0.91],[0.71],[0.71],[0.79],[0.79],[0.71],[0.82],[0.78],[0.7],[1.12],[0.73],[0.91],[0.91],[0.91],[0.91],[0.7],[0.68],[0.73],[1.03],[0.74],[0.98],[1.02],[1.0],[1.02],[0.6],[0.8],[0.97],[1.0],[0.26],[0.26],[0.36],[0.34],[0.34],[0.34],[0.34],[0.34],[0.34],[0.32],[0.31],[0.31],[0.31],[0.31],[0.31],[0.31],[0.31],[0.31],[0.31],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[0.33],[1.0],[0.77],[0.77],[0.7],[0.9],[0.72],[0.9],[0.72],[0.7],[0.81],[0.81],[0.71],[0.7],[0.71],[0.71],[0.92],[0.76],[0.73],[0.71],[0.7],[0.9],[0.71],[0.7],[0.7],[0.77],[0.71],[0.7],[0.75],[0.83],[0.71],[0.9],[0.6],[0.71],[0.53],[0.71],[0.62],[0.62],[0.9],[0.62],[0.82],[0.66],[0.7],[0.8],[0.8],[0.79],[0.71],[0.7],[0.7],[0.79],[0.7],[1.22],[1.01],[0.73],[0.91],[0.71],[0.83],[0.84],[0.71],[0.71],[0.71],[0.71],[0.71],[0.71],[0.91],[0.9],[0.71],[0.71],[0.72],[0.72],[0.71],[0.81],[0.83],[0.73],[0.56],[0.56],[0.71],[0.7],[0.96],[0.71],[0.7],[0.71],[0.8],[0.95],[0.82],[0.52],[0.82],[0.82],[0.82],[0.8],[0.96],[0.72],[0.62],[0.79],[0.75],[1.08],[0.72],[0.62],[0.73],[0.72],[0.52],[0.83],[0.64],[0.8],[0.74],[0.72],[0.82],[0.73],[1.04],[0.73],[0.73],[0.9],[0.75],[0.79],[0.7],[0.75],[1.02],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.72],[0.74],[0.84],[0.76],[0.77],[0.76],[1.0],[1.0],[0.9],[0.9],[0.9],[0.9],[0.9],[0.9],[0.78],[0.71],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[0.7],[1.0],[0.77],[1.0],[1.0],[1.0],[0.73],[0.79],[0.72],[0.71],[0.74],[0.7],[0.7],[0.79],[0.79],[0.79],[0.71],[0.79],[0.73],[0.63],[0.7],[0.71],[0.84],[0.84],[1.02],[0.72],[0.72],[0.92],[0.74],[0.7],[0.71],[1.05],[0.7],[0.54],[0.73],[0.88],[0.73],[0.72],[0.9],[0.9],[1.03],[0.84],[1.01],[0.77],[0.8],[0.9],[0.73],[0.72],[0.71],[0.7],[0.79],[0.72],[0.7],[0.7],[0.9],[0.71],[0.5],[0.5],[0.74],[0.77],[0.77],[0.8],[0.8],[0.8],[0.8],[0.66],[0.71],[0.71],[0.71],[0.71],[0.72],[0.71],[0.86],[1.19],[0.71],[0.82],[0.71],[0.75],[0.7],[0.8],[0.82],[0.82],[0.82],[0.81],[0.81],[0.76],[0.71],[0.7],[0.7],[0.74],[0.77],[0.77],[0.53],[0.79],[0.73],[0.77],[0.77],[1.01],[1.01],[0.6],[0.76],[0.54],[0.72],[0.72],[0.74],[1.12]],"arguments":{},"schema":[{"type":"double","name":"carat"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445636800376E12,"submitTime":1.445636800305E12,"finishTime":1.445636800791E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"669","height":"310","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"3f43b675-7513-42fc-a4e9-5579cd173d8f"},{"version":"CommandV1","origId":2249,"guid":"8bf23a1b-080b-45f6-b133-afcad783a33d","subtype":"command","commandType":"auto","position":4.611328125,"command":"%md The above histogram of the diamonds' carat ratings shows that carats have a skewed distribution: Many diamonds are small, but there are a number of diamonds in the dataset which are much larger.  Extremely skewed distributions can cause problems for some algorithms (e.g., Linear Regression).  However, Decision Trees handle skewed distributions very naturally.\n\nNote: When you call \"display\" to create a histogram like that above, it will plot using a subsample from the dataset (for efficiency), but you can plot using the full dataset by selecting \"Plot over all results\".  For our dataset, the two plots can actually look very different due to the long-tailed distribution.\n\nWe will not examine the label distribution for now.  It can be helpful to examine the label distribution, but it is best to do so only on the training set, not on the test set which we will hold out for evaluation.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.429998205459E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"joseph","iPythonMetadata":null,"nuid":"888bfa5f-144e-4bd1-a207-9da4a7ec3dcc"},{"version":"CommandV1","origId":2250,"guid":"4e7a64c5-cf22-42c5-abbf-fb02515621db","subtype":"command","commandType":"auto","position":4.6171875,"command":"%md ## Extract features (using training dataset)\n\nWe eventually want to use Decision Tree, which can handle both continuous features (e.g., \"carat\") and categorical features (e.g., \"color\").\n\nHowever, Decision Tree requires that categorical features be indexed as {0, 1, 2, ..., numberOfCategories - 1}.\n\nCreating features to use for ML is an art unto itself.  We only give a simple example in this section.  In general, [Feature Extraction](http://en.wikipedia.org/wiki/Feature_extraction) means creating simple, machine-understandable features to describe your data.  In this case, we convert String categories into integer indices using the [StringIndexer](https://spark.apache.org/docs/latest/ml-features.html#stringindexer).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427838340483E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"62dc5a03-486d-4377-8b24-3a5fe66a384e"},{"version":"CommandV1","origId":2251,"guid":"36e98b61-8fc8-4691-b34d-d714179700b6","subtype":"command","commandType":"auto","position":4.78143310546875,"command":"from pyspark.ml.feature import StringIndexer\n\n# Use StringIndexer to convert string categories into integer indices\n# We will pass these into our Pipeline later\ncutIndexer = StringIndexer(inputCol = \"cut\", outputCol = \"cutIndex\")\ncolorIndexer = StringIndexer(inputCol = \"color\", outputCol = \"colorIndex\")\nclarityIndexer = StringIndexer(inputCol = \"clarity\", outputCol = \"clarityIndex\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> non-keyword arg after keyword arg","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-40-2a59daffb7c5&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">3</span>\n<span class=\"ansiyellow\">    cutIndexer = StringIndexer(inputCol = &quot;cut&quot;, &quot;color&quot;, &quot;clarity&quot;, outputCol = &quot;cutIndex&quot;, &quot;colorIndex&quot;, &quot;clarityIndex&quot;)</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> non-keyword arg after keyword arg\n\n</div>","startTime":1.445297384259E12,"submitTime":1.445297384208E12,"finishTime":1.445297384304E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"b7de9ab7-fccb-4b10-9f4e-460475d34905"},{"version":"CommandV1","origId":2252,"guid":"df4a3d09-388e-44da-9f11-309e8b351f1b","subtype":"command","commandType":"auto","position":4.7816162109375,"command":"from pyspark.ml.feature import VectorAssembler\n\n# Use Vector Assembler to create Feature Vector\n# We wil pass these into our Pipeline later\nassembler = VectorAssembler(inputCols=[\"carat\", \"cutIndex\", \"colorIndex\", \"clarityIndex\", \"depth\", \"table\", \"x\", \"y\", \"z\"], outputCol=\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.44529738698E12,"submitTime":1.445297386938E12,"finishTime":1.445297387057E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"bfa9f130-b552-4fdf-b847-7221d7a28ed6"},{"version":"CommandV1","origId":2253,"guid":"b479deb7-a314-4935-b612-f95576d763ae","subtype":"command","commandType":"auto","position":4.8046875,"command":"%md ## Hold out data\n\nIn order to verify that Decision Tree actually learns something useful, we will hold out part of our dataset for testing.  We randomly split the dataset into 2 parts: trainingData and testData.  We will do all of our learning and tuning on the training set before evaluating on the held-out test set.\n\nThis separation between training and test datasets is critical to avoid [overfitting](http://en.wikipedia.org/wiki/Overfitting).  When a model's parameters are over-optimized to improve performance on a dataset, that model may actually perform badly when it is deployed on new data.  To avoid overfitting, it is important to train and validate on separate datasets.  We will demonstrate overfitting later on.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427838582743E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"1005b425-5a2b-466e-8275-56cb191ba63f"},{"version":"CommandV1","origId":2254,"guid":"c546ac8b-aa93-4f7f-8b9c-3b0db4a827b4","subtype":"command","commandType":"auto","position":5.3046875,"command":"# Hold out 30% of our data for testing.\n(trainingData, testData) = diamondsDF.randomSplit([0.7, 0.3])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.44529739008E12,"submitTime":1.44529739002E12,"finishTime":1.445297390108E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"4f35857c-735a-4ffd-ae62-f7dc34b1fc89"},{"version":"CommandV1","origId":2255,"guid":"31a1f8c8-24c2-47bf-bbcb-f2d8d83dd4cd","subtype":"command","commandType":"auto","position":5.5546875,"command":"# Cache our training and test datasets, which we will use several times.\ntrainingData.cache()\ntestData.cache()\nprint(\"We have %d training instances and %d test instances.\" % (trainingData.count(), testData.count()))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">We have 37796 training instances and 16144 test instances.\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445297391152E12,"submitTime":1.445297391113E12,"finishTime":1.445297394073E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"0cdfb3a7-540a-4159-838c-a3d94814ed3b"},{"version":"CommandV1","origId":2256,"guid":"1da0fbc8-7bb1-44be-835c-6fa27d91d721","subtype":"command","commandType":"auto","position":6.8046875,"command":"%md ## Learn a model (using training dataset)\n\nNow that we have our training data, we will train a Decision Tree.  We also compute its prediction error on the training dataset.\n\nThere are several other regression algorithms we could have used instead.  Refer to the [ML Algorithm Guide](../07 Spark MLlib/2 Algorithms/0 MLlib Algorithms Guide.html) for a list of regression algorithms.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.433995449027E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"vida","iPythonMetadata":null,"nuid":"bece5604-a36e-421a-b582-21f24341d13f"},{"version":"CommandV1","origId":2257,"guid":"2eb0f0a2-dce1-411b-a047-ef35281790dd","subtype":"command","commandType":"auto","position":7.3046875,"command":"from pyspark.ml.regression import DecisionTreeRegressor, DecisionTreeRegressionModel\n\ndt = DecisionTreeRegressor(labelCol=\"price\", featuresCol=\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445464231706E12,"submitTime":1.445464231656E12,"finishTime":1.445464231752E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"66f0a6bc-2e4d-42ab-a4d6-a4df043a1f26"},{"version":"CommandV1","origId":2258,"guid":"6dc6e2f6-9f2a-4f06-a8bd-a77d56eadbb2","subtype":"command","commandType":"auto","position":7.31494140625,"command":"from pyspark.ml import Pipeline\n\ndtPipeline = Pipeline(stages = [cutIndexer, colorIndexer, clarityIndexer, assembler, dt])\n\n#Create initial decision tree model\ninitialModel = dtPipeline.fit(trainingData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;cutIndexer&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-44-d0140ea409d8&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml <span class=\"ansigreen\">import</span> Pipeline<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>dtPipeline <span class=\"ansiyellow\">=</span> Pipeline<span class=\"ansiyellow\">(</span>stages <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>cutIndexer<span class=\"ansiyellow\">,</span> colorIndexer<span class=\"ansiyellow\">,</span> clarityIndexer<span class=\"ansiyellow\">,</span> assembler<span class=\"ansiyellow\">,</span> dt<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> dtModel <span class=\"ansiyellow\">=</span> dtPipeline<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>trainingData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;cutIndexer&apos; is not defined\n</div>","startTime":1.445464232205E12,"submitTime":1.44546423216E12,"finishTime":1.445464233419E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"662ece9c-a29d-4b73-a26c-d42007966454"},{"version":"CommandV1","origId":2259,"guid":"47998795-1f55-4bb5-9155-a4ed2d770aef","subtype":"command","commandType":"auto","position":7.3251953125,"command":"initialPredictions = initialModel.transform(testData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445464233424E12,"submitTime":1.445464232657E12,"finishTime":1.445464233501E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"7184f19e-3275-40d7-bca1-43b55d5dc844"},{"version":"CommandV1","origId":2260,"guid":"422ca7b1-ef76-4f7a-a193-e9e5bf18c63e","subtype":"command","commandType":"auto","position":7.345703125,"command":"initialPredictions.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- carat: double (nullable = true)\n |-- cut: string (nullable = true)\n |-- color: string (nullable = true)\n |-- clarity: string (nullable = true)\n |-- depth: double (nullable = true)\n |-- table: double (nullable = true)\n |-- price: double (nullable = true)\n |-- x: double (nullable = true)\n |-- y: double (nullable = true)\n |-- z: double (nullable = true)\n |-- cutIndex: double (nullable = true)\n |-- colorIndex: double (nullable = true)\n |-- clarityIndex: double (nullable = true)\n |-- features: vector (nullable = true)\n |-- prediction: double (nullable = true)\n\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;initialOredictions&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-109-0b8cd59d8531&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>initialOredictions<span class=\"ansiyellow\">.</span>printSchema<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;initialOredictions&apos; is not defined\n</div>","startTime":1.445464233602E12,"submitTime":1.445464233536E12,"finishTime":1.445464233647E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"fd91330a-d202-4a83-aee2-46fb8dc0c690"},{"version":"CommandV1","origId":2261,"guid":"f3b13667-6cad-44ad-a221-cf5ee310d4b4","subtype":"command","commandType":"auto","position":7.38671875,"command":"# Select the price and prediction columns to view\nselected = initialPredictions.select(\"price\", \"prediction\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445464234203E12,"submitTime":1.445464234164E12,"finishTime":1.445464234287E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"5773cdab-b763-4706-9482-099b9e43b2b2"},{"version":"CommandV1","origId":2262,"guid":"69e08425-ba83-4e47-9627-97e5880e373a","subtype":"command","commandType":"auto","position":7.46875,"command":"display(selected)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[326.0,657.5663161199184],[327.0,657.5663161199184],[336.0,657.5663161199184],[337.0,657.5663161199184],[338.0,657.5663161199184],[342.0,657.5663161199184],[351.0,657.5663161199184],[351.0,657.5663161199184],[352.0,657.5663161199184],[357.0,657.5663161199184],[402.0,657.5663161199184],[402.0,657.5663161199184],[403.0,657.5663161199184],[403.0,657.5663161199184],[403.0,657.5663161199184],[403.0,657.5663161199184],[404.0,657.5663161199184],[404.0,657.5663161199184],[405.0,657.5663161199184],[405.0,657.5663161199184],[552.0,657.5663161199184],[552.0,657.5663161199184],[552.0,657.5663161199184],[552.0,868.8946521913953],[553.0,657.5663161199184],[553.0,839.3107438016528],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,839.3107438016528],[554.0,868.8946521913953],[2759.0,3226.644753476612],[2760.0,2548.202290076336],[2762.0,2769.5319812792513],[2762.0,3226.644753476612],[2762.0,2349.8163875598084],[2762.0,3226.644753476612],[2762.0,3226.644753476612],[2763.0,3504.566225165563],[2764.0,2349.8163875598084],[2765.0,3226.644753476612],[2766.0,3226.644753476612],[2766.0,3226.644753476612],[2767.0,2548.202290076336],[2768.0,2769.5319812792513],[2771.0,2349.8163875598084],[2771.0,3226.644753476612],[2771.0,2769.5319812792513],[2772.0,2548.202290076336],[2772.0,2769.5319812792513],[2772.0,3226.644753476612],[2774.0,1708.3938569206844],[2775.0,3226.644753476612],[2776.0,2504.4583333333335],[2776.0,2349.8163875598084],[2777.0,3226.644753476612],[2777.0,3226.644753476612],[2777.0,3226.644753476612],[2777.0,2349.8163875598084],[2777.0,2349.8163875598084],[2777.0,2349.8163875598084],[2777.0,2349.8163875598084],[2780.0,3226.644753476612],[2781.0,4593.71956941761],[2782.0,1708.3938569206844],[2782.0,2349.8163875598084],[2782.0,4326.770202020202],[2782.0,2349.8163875598084],[2783.0,2504.4583333333335],[2788.0,3322.2290909090907],[2788.0,2548.202290076336],[2788.0,3226.644753476612],[2788.0,3226.644753476612],[2788.0,4593.71956941761],[2789.0,2349.8163875598084],[2789.0,2504.4583333333335],[2789.0,2548.202290076336],[2789.0,4593.71956941761],[2790.0,2548.202290076336],[2790.0,3226.644753476612],[2792.0,2349.8163875598084],[2792.0,2349.8163875598084],[2792.0,3226.644753476612],[2793.0,4326.770202020202],[2795.0,3226.644753476612],[2795.0,2769.5319812792513],[2795.0,2548.202290076336],[2795.0,3226.644753476612],[2796.0,2349.8163875598084],[2797.0,2349.8163875598084],[2797.0,3226.644753476612],[2797.0,4593.71956941761],[2800.0,4326.770202020202],[2800.0,4326.770202020202],[2800.0,3226.644753476612],[2800.0,2548.202290076336],[2800.0,1870.0494905385735],[2802.0,2504.4583333333335],[2803.0,2769.5319812792513],[2803.0,3226.644753476612],[2803.0,3226.644753476612],[2803.0,3226.644753476612],[2803.0,3226.644753476612],[2803.0,3226.644753476612],[2803.0,3226.644753476612],[2803.0,3504.566225165563],[2804.0,2349.8163875598084],[2804.0,3226.644753476612],[2804.0,2349.8163875598084],[2805.0,2349.8163875598084],[2805.0,2504.4583333333335],[2805.0,3226.644753476612],[2808.0,2548.202290076336],[2808.0,3226.644753476612],[2809.0,2349.8163875598084],[2809.0,5659.1858552631575],[2810.0,2769.5319812792513],[2811.0,5504.096463022508],[2812.0,3226.644753476612],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,657.5663161199184],[554.0,657.5663161199184],[555.0,657.5663161199184],[555.0,657.5663161199184],[555.0,657.5663161199184],[555.0,657.5663161199184],[2812.0,2349.8163875598084],[2813.0,3504.566225165563],[2813.0,2769.5319812792513],[2814.0,2349.8163875598084],[2814.0,2349.8163875598084],[2815.0,3226.644753476612],[2815.0,2349.8163875598084],[2815.0,3322.2290909090907],[2816.0,2548.202290076336],[2816.0,1870.0494905385735],[2816.0,2769.5319812792513],[2817.0,2349.8163875598084],[2817.0,2349.8163875598084],[2817.0,3322.2290909090907],[2818.0,3226.644753476612],[2818.0,3226.644753476612],[2818.0,3226.644753476612],[2818.0,4593.71956941761],[2819.0,2548.202290076336],[2821.0,2349.8163875598084],[2821.0,3226.644753476612],[2822.0,3226.644753476612],[2822.0,3226.644753476612],[2822.0,2548.202290076336],[2822.0,2349.8163875598084],[2822.0,2349.8163875598084],[2822.0,2548.202290076336],[2822.0,2349.8163875598084],[2822.0,2349.8163875598084],[2822.0,2349.8163875598084],[2822.0,3226.644753476612],[2823.0,2769.5319812792513],[2824.0,3226.644753476612],[2824.0,3226.644753476612],[2825.0,3226.644753476612],[2826.0,3226.644753476612],[2826.0,3504.566225165563],[2827.0,2548.202290076336],[2829.0,2769.5319812792513],[2829.0,2504.4583333333335],[2830.0,3226.644753476612],[2830.0,2504.4583333333335],[2831.0,2349.8163875598084],[2831.0,2769.5319812792513],[2832.0,2769.5319812792513],[2833.0,2504.4583333333335],[2833.0,3226.644753476612],[2833.0,3226.644753476612],[2833.0,2504.4583333333335],[2833.0,3504.566225165563],[2834.0,2504.4583333333335],[2834.0,2504.4583333333335],[2835.0,3226.644753476612],[2835.0,2349.8163875598084],[2838.0,2349.8163875598084],[2838.0,3226.644753476612],[2838.0,3226.644753476612],[2839.0,3226.644753476612],[2839.0,3226.644753476612],[2839.0,3226.644753476612],[2839.0,3226.644753476612],[2839.0,3226.644753476612],[2840.0,2548.202290076336],[2840.0,3504.566225165563],[2840.0,3504.566225165563],[2841.0,2349.8163875598084],[2843.0,3226.644753476612],[2843.0,3226.644753476612],[2843.0,3226.644753476612],[2843.0,2769.5319812792513],[2843.0,3226.644753476612],[2844.0,3226.644753476612],[2845.0,3226.644753476612],[2846.0,2548.202290076336],[2846.0,3226.644753476612],[2848.0,3226.644753476612],[2850.0,3226.644753476612],[2850.0,2769.5319812792513],[2851.0,2349.8163875598084],[2851.0,3504.566225165563],[2852.0,3322.2290909090907],[2853.0,2769.5319812792513],[2854.0,2548.202290076336],[2854.0,3322.2290909090907],[2855.0,4593.71956941761],[2856.0,4593.71956941761],[2856.0,4593.71956941761],[556.0,657.5663161199184],[556.0,657.5663161199184],[556.0,657.5663161199184],[557.0,839.3107438016528],[557.0,657.5663161199184],[557.0,657.5663161199184],[557.0,657.5663161199184],[557.0,657.5663161199184],[2857.0,2349.8163875598084],[2858.0,3226.644753476612],[2858.0,2349.8163875598084],[2860.0,3504.566225165563],[2861.0,1870.0494905385735],[2862.0,2769.5319812792513],[2862.0,2548.202290076336],[2862.0,3226.644753476612],[2862.0,3226.644753476612],[2863.0,2349.8163875598084],[2863.0,2769.5319812792513],[2863.0,2349.8163875598084],[2863.0,2349.8163875598084],[2863.0,2349.8163875598084],[2863.0,3226.644753476612],[2863.0,2349.8163875598084],[2863.0,3226.644753476612],[2865.0,2349.8163875598084],[2866.0,2504.4583333333335],[2867.0,2548.202290076336],[2867.0,2769.5319812792513],[2867.0,2769.5319812792513],[2867.0,2769.5319812792513],[2868.0,2769.5319812792513],[2869.0,2548.202290076336],[2870.0,2504.4583333333335],[2870.0,2349.8163875598084],[2872.0,2769.5319812792513],[2873.0,2769.5319812792513],[2873.0,3322.2290909090907],[2874.0,3226.644753476612],[2874.0,3226.644753476612],[2874.0,3226.644753476612],[2875.0,5248.582474226804],[2877.0,2548.202290076336],[2878.0,2769.5319812792513],[2878.0,2548.202290076336],[2878.0,2769.5319812792513],[2879.0,3226.644753476612],[2879.0,3504.566225165563],[2880.0,3504.566225165563],[2881.0,4593.71956941761],[2882.0,2548.202290076336],[2882.0,2504.4583333333335],[2883.0,2769.5319812792513],[2885.0,2769.5319812792513],[2886.0,2349.8163875598084],[2887.0,2349.8163875598084],[2888.0,2548.202290076336],[2889.0,3226.644753476612],[2889.0,3226.644753476612],[2889.0,3226.644753476612],[2893.0,3226.644753476612],[2893.0,3504.566225165563],[2893.0,3226.644753476612],[2893.0,2548.202290076336],[2893.0,2769.5319812792513],[2894.0,2769.5319812792513],[2896.0,3226.644753476612],[2896.0,4326.770202020202],[2896.0,2504.4583333333335],[2896.0,2769.5319812792513],[2897.0,2504.4583333333335],[2897.0,2349.8163875598084],[2898.0,2769.5319812792513],[2898.0,2349.8163875598084],[2899.0,3226.644753476612],[2900.0,3226.644753476612],[2901.0,2769.5319812792513],[2901.0,3226.644753476612],[2902.0,3226.644753476612],[2903.0,2349.8163875598084],[2904.0,2769.5319812792513],[2904.0,2769.5319812792513],[2904.0,3226.644753476612],[2905.0,3226.644753476612],[2905.0,3226.644753476612],[2905.0,3504.566225165563],[2906.0,3226.644753476612],[2906.0,2548.202290076336],[2906.0,2349.8163875598084],[2907.0,2504.4583333333335],[2907.0,2548.202290076336],[2907.0,3226.644753476612],[2907.0,3226.644753476612],[2907.0,2769.5319812792513],[558.0,657.5663161199184],[558.0,657.5663161199184],[558.0,657.5663161199184],[558.0,657.5663161199184],[558.0,657.5663161199184],[2909.0,2548.202290076336],[2911.0,2504.4583333333335],[2912.0,4593.71956941761],[2913.0,2349.8163875598084],[2914.0,2349.8163875598084],[2915.0,3226.644753476612],[2917.0,3322.2290909090907],[2917.0,3226.644753476612],[2917.0,3226.644753476612],[2918.0,3226.644753476612],[2918.0,4326.770202020202],[2919.0,3226.644753476612],[2919.0,2548.202290076336],[2922.0,3226.644753476612],[2922.0,3226.644753476612],[2922.0,3226.644753476612],[2922.0,2504.4583333333335],[2923.0,3226.644753476612],[2923.0,2769.5319812792513],[2923.0,2769.5319812792513],[2926.0,2349.8163875598084],[2926.0,2769.5319812792513],[2926.0,2769.5319812792513],[2927.0,2548.202290076336],[2928.0,3226.644753476612],[2929.0,3226.644753476612],[2929.0,2349.8163875598084],[2930.0,3504.566225165563],[2930.0,3504.566225165563],[2930.0,3226.644753476612],[2932.0,3226.644753476612],[2933.0,3226.644753476612],[2933.0,3226.644753476612],[2933.0,3504.566225165563],[2935.0,5659.1858552631575],[2937.0,2769.5319812792513],[2937.0,3226.644753476612],[2938.0,3504.566225165563],[2939.0,3226.644753476612],[2940.0,5659.1858552631575],[2940.0,3226.644753476612],[2941.0,3504.566225165563],[2942.0,4593.71956941761],[2944.0,2548.202290076336],[2945.0,2769.5319812792513],[2946.0,2548.202290076336],[2946.0,2769.5319812792513],[2947.0,2548.202290076336],[2947.0,4326.770202020202],[2947.0,3322.2290909090907],[2948.0,3504.566225165563],[2948.0,3504.566225165563],[2949.0,3226.644753476612],[2951.0,2504.4583333333335],[2951.0,2349.8163875598084],[2952.0,3226.644753476612],[2952.0,3226.644753476612],[2952.0,3226.644753476612],[2952.0,3226.644753476612],[2953.0,3226.644753476612],[2954.0,3226.644753476612],[2954.0,2349.8163875598084],[2956.0,3226.644753476612],[2956.0,3226.644753476612],[2958.0,2548.202290076336],[2958.0,3226.644753476612],[2958.0,3504.566225165563],[2959.0,2504.4583333333335],[2959.0,3226.644753476612],[2959.0,3226.644753476612],[2960.0,2548.202290076336],[2960.0,3226.644753476612],[2960.0,3226.644753476612],[2960.0,3226.644753476612],[2960.0,3226.644753476612],[2961.0,2548.202290076336],[2961.0,2769.5319812792513],[2961.0,2548.202290076336],[2962.0,3226.644753476612],[2962.0,2769.5319812792513],[2964.0,2349.8163875598084],[2964.0,2769.5319812792513],[2964.0,2769.5319812792513],[2964.0,4593.71956941761],[2964.0,4593.71956941761],[2965.0,2548.202290076336],[2965.0,2548.202290076336],[2967.0,3226.644753476612],[559.0,657.5663161199184],[559.0,839.3107438016528],[559.0,657.5663161199184],[559.0,657.5663161199184],[560.0,657.5663161199184],[2968.0,4593.71956941761],[2968.0,3504.566225165563],[2970.0,4593.71956941761],[2972.0,3226.644753476612],[2972.0,3504.566225165563],[2974.0,2504.4583333333335],[2974.0,2769.5319812792513],[2974.0,3226.644753476612],[2975.0,3226.644753476612],[2975.0,2769.5319812792513],[2976.0,2769.5319812792513],[2977.0,3226.644753476612],[2978.0,2769.5319812792513],[2979.0,3226.644753476612],[2982.0,3504.566225165563],[2982.0,3226.644753476612],[2982.0,3226.644753476612],[2982.0,3226.644753476612],[2984.0,3226.644753476612],[2985.0,2349.8163875598084],[2986.0,2548.202290076336],[2986.0,3322.2290909090907],[2987.0,3226.644753476612],[2987.0,2349.8163875598084],[2988.0,2504.4583333333335],[2989.0,3226.644753476612],[2990.0,2504.4583333333335],[2991.0,3226.644753476612],[2992.0,2548.202290076336],[2993.0,2349.8163875598084],[2993.0,3226.644753476612],[2994.0,3226.644753476612],[2994.0,3226.644753476612],[2996.0,2769.5319812792513],[2998.0,4326.770202020202],[2999.0,3226.644753476612],[2999.0,3226.644753476612],[2999.0,4593.71956941761],[3001.0,3504.566225165563],[3001.0,3504.566225165563],[3001.0,2349.8163875598084],[3001.0,1708.3938569206844],[3001.0,1870.0494905385735],[3002.0,2548.202290076336],[3002.0,3226.644753476612],[3002.0,3226.644753476612],[3002.0,3226.644753476612],[3004.0,2769.5319812792513],[3004.0,2769.5319812792513],[3004.0,2349.8163875598084],[3005.0,2504.4583333333335],[3006.0,3504.566225165563],[3006.0,3504.566225165563],[3006.0,3226.644753476612],[3006.0,3226.644753476612],[3007.0,2548.202290076336],[3007.0,2349.8163875598084],[3007.0,2349.8163875598084],[3007.0,2349.8163875598084],[3007.0,2769.5319812792513],[3007.0,4326.770202020202],[3008.0,3226.644753476612],[3009.0,3226.644753476612],[3009.0,2349.8163875598084],[3011.0,2349.8163875598084],[3011.0,5659.1858552631575],[3011.0,5659.1858552631575],[3011.0,3226.644753476612],[3011.0,3226.644753476612],[3011.0,2349.8163875598084],[3012.0,3226.644753476612],[3014.0,2349.8163875598084],[3014.0,2769.5319812792513],[3016.0,3226.644753476612],[3017.0,4593.71956941761],[3017.0,2504.4583333333335],[3018.0,3226.644753476612],[3018.0,3226.644753476612],[3023.0,3226.644753476612],[3024.0,3322.2290909090907],[3024.0,3226.644753476612],[3024.0,2349.8163875598084],[3025.0,3226.644753476612],[3027.0,2548.202290076336],[3030.0,2548.202290076336],[3030.0,2548.202290076336],[3032.0,4593.71956941761],[3033.0,2504.4583333333335],[3033.0,1708.3938569206844],[3035.0,3226.644753476612],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[3038.0,2548.202290076336],[3038.0,2349.8163875598084],[3039.0,3226.644753476612],[3041.0,3226.644753476612],[3042.0,3226.644753476612],[3043.0,3226.644753476612],[3043.0,2769.5319812792513],[3044.0,2769.5319812792513],[3045.0,3226.644753476612],[3046.0,3226.644753476612],[3047.0,2769.5319812792513],[3047.0,3504.566225165563],[3048.0,2769.5319812792513],[3048.0,3322.2290909090907],[3048.0,2349.8163875598084],[3049.0,2349.8163875598084],[3050.0,2769.5319812792513],[3050.0,2769.5319812792513],[3051.0,3226.644753476612],[3052.0,3226.644753476612],[3052.0,4593.71956941761],[3053.0,3226.644753476612],[3053.0,2769.5319812792513],[3053.0,2769.5319812792513],[3054.0,3226.644753476612],[3054.0,4593.71956941761],[3057.0,2504.4583333333335],[3059.0,2769.5319812792513],[3059.0,3226.644753476612],[3060.0,3504.566225165563],[3061.0,2548.202290076336],[3062.0,1870.0494905385735],[3062.0,3226.644753476612],[3062.0,2769.5319812792513],[3062.0,3226.644753476612],[3063.0,3226.644753476612],[3064.0,3226.644753476612],[3064.0,2769.5319812792513],[3065.0,3226.644753476612],[3065.0,3226.644753476612],[3066.0,3226.644753476612],[3067.0,2769.5319812792513],[3071.0,2548.202290076336],[3073.0,3226.644753476612],[3073.0,4326.770202020202],[3073.0,3226.644753476612],[3073.0,2504.4583333333335],[3074.0,2548.202290076336],[3075.0,3226.644753476612],[3075.0,2548.202290076336],[3077.0,3226.644753476612],[3078.0,2349.8163875598084],[3078.0,2769.5319812792513],[3080.0,2769.5319812792513],[3081.0,3226.644753476612],[3081.0,2769.5319812792513],[3082.0,2504.4583333333335],[3082.0,3226.644753476612],[3082.0,4326.770202020202],[3084.0,2504.4583333333335],[3084.0,2504.4583333333335],[3084.0,3226.644753476612],[3084.0,3504.566225165563],[3084.0,2769.5319812792513],[3084.0,4593.71956941761],[3085.0,2349.8163875598084],[3087.0,3226.644753476612],[3089.0,2349.8163875598084],[3090.0,2504.4583333333335],[3090.0,3226.644753476612],[3092.0,3226.644753476612],[3095.0,3226.644753476612],[3097.0,3322.2290909090907],[3099.0,3504.566225165563],[3099.0,3226.644753476612],[3101.0,3504.566225165563],[3102.0,3322.2290909090907],[3103.0,3504.566225165563],[3103.0,2769.5319812792513],[3104.0,2769.5319812792513],[3104.0,3504.566225165563],[3105.0,2548.202290076336],[3105.0,2769.5319812792513],[3105.0,9174.179752066115],[3105.0,3504.566225165563],[3105.0,3226.644753476612],[3107.0,2769.5319812792513],[3107.0,2769.5319812792513],[3107.0,3226.644753476612],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[3107.0,3504.566225165563],[3108.0,2769.5319812792513],[3108.0,3226.644753476612],[3110.0,4593.71956941761],[3112.0,3226.644753476612],[3112.0,2769.5319812792513],[3114.0,3226.644753476612],[3114.0,3226.644753476612],[3115.0,4326.770202020202],[3116.0,3226.644753476612],[3117.0,4326.770202020202],[3118.0,4326.770202020202],[3119.0,3322.2290909090907],[3119.0,2349.8163875598084],[3120.0,3322.2290909090907],[3121.0,3322.2290909090907],[3122.0,2349.8163875598084],[3122.0,3322.2290909090907],[3123.0,3504.566225165563],[3124.0,2548.202290076336],[3127.0,3226.644753476612],[3130.0,2349.8163875598084],[3131.0,2769.5319812792513],[3133.0,2548.202290076336],[3133.0,4326.770202020202],[3135.0,3226.644753476612],[3135.0,3226.644753476612],[3135.0,3226.644753476612],[3136.0,3226.644753476612],[3136.0,4593.71956941761],[3136.0,3226.644753476612],[3136.0,3226.644753476612],[3137.0,4326.770202020202],[3137.0,2548.202290076336],[3138.0,2349.8163875598084],[3139.0,3504.566225165563],[3139.0,3504.566225165563],[3139.0,2504.4583333333335],[3140.0,3226.644753476612],[3141.0,3322.2290909090907],[3142.0,4593.71956941761],[3142.0,4593.71956941761],[3145.0,3226.644753476612],[3145.0,3322.2290909090907],[3145.0,2548.202290076336],[3145.0,2548.202290076336],[3145.0,3226.644753476612],[3146.0,3226.644753476612],[3146.0,2548.202290076336],[3146.0,2769.5319812792513],[3146.0,4326.770202020202],[3146.0,2769.5319812792513],[3146.0,4593.71956941761],[3148.0,5504.096463022508],[3149.0,4593.71956941761],[3149.0,4593.71956941761],[3150.0,3226.644753476612],[3153.0,3504.566225165563],[3153.0,3504.566225165563],[3154.0,3226.644753476612],[3154.0,3226.644753476612],[3158.0,4593.71956941761],[3158.0,4326.770202020202],[3159.0,3226.644753476612],[3160.0,3504.566225165563],[3160.0,3504.566225165563],[3160.0,3504.566225165563],[3160.0,3504.566225165563],[3161.0,3226.644753476612],[3161.0,3226.644753476612],[3162.0,3226.644753476612],[3163.0,3226.644753476612],[3164.0,2548.202290076336],[3165.0,4326.770202020202],[3166.0,3226.644753476612],[3167.0,3226.644753476612],[3167.0,2548.202290076336],[3167.0,3226.644753476612],[3167.0,2769.5319812792513],[3167.0,4326.770202020202],[3167.0,3226.644753476612],[3168.0,5659.1858552631575],[3169.0,3504.566225165563],[3170.0,2769.5319812792513],[3170.0,3226.644753476612],[3171.0,4326.770202020202],[3171.0,2349.8163875598084],[3171.0,4326.770202020202],[3171.0,4326.770202020202],[3172.0,4593.71956941761],[3172.0,3226.644753476612],[3172.0,3504.566225165563],[3173.0,2769.5319812792513],[3173.0,4593.71956941761],[3174.0,3504.566225165563],[3175.0,2548.202290076336],[3175.0,3322.2290909090907],[3175.0,3504.566225165563],[3175.0,3226.644753476612],[3176.0,3226.644753476612],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,868.8946521913953],[561.0,657.5663161199184],[561.0,657.5663161199184],[561.0,657.5663161199184],[562.0,839.3107438016528],[3178.0,2548.202290076336],[3179.0,3226.644753476612],[3180.0,4326.770202020202],[3180.0,4326.770202020202],[3181.0,3504.566225165563],[3182.0,3226.644753476612],[3182.0,3226.644753476612],[3183.0,3226.644753476612],[3183.0,3226.644753476612],[3183.0,4593.71956941761],[3183.0,4326.770202020202],[3183.0,3226.644753476612],[3183.0,3226.644753476612],[3185.0,2548.202290076336],[3188.0,4593.71956941761],[3190.0,5504.096463022508],[3191.0,3226.644753476612],[3191.0,3226.644753476612],[3192.0,3226.644753476612],[3192.0,2548.202290076336],[3193.0,3226.644753476612],[3195.0,2349.8163875598084],[3195.0,2769.5319812792513],[3195.0,4326.770202020202],[3196.0,2504.4583333333335],[3196.0,3322.2290909090907],[3197.0,3226.644753476612],[3198.0,2769.5319812792513],[3198.0,3226.644753476612],[3199.0,3226.644753476612],[3199.0,4593.71956941761],[3199.0,3226.644753476612],[3199.0,2349.8163875598084],[3200.0,3226.644753476612],[3201.0,3226.644753476612],[3205.0,2769.5319812792513],[3205.0,2769.5319812792513],[3205.0,2769.5319812792513],[3205.0,3226.644753476612],[3206.0,3226.644753476612],[3207.0,2769.5319812792513],[3208.0,2548.202290076336],[3210.0,2769.5319812792513],[3210.0,3226.644753476612],[3210.0,4326.770202020202],[3210.0,3504.566225165563],[3210.0,3504.566225165563],[3211.0,3226.644753476612],[3212.0,3226.644753476612],[3214.0,2769.5319812792513],[3214.0,3226.644753476612],[3215.0,3504.566225165563],[3217.0,3226.644753476612],[3217.0,4593.71956941761],[3218.0,2504.4583333333335],[3218.0,3226.644753476612],[3218.0,3504.566225165563],[3219.0,3226.644753476612],[3219.0,3226.644753476612],[3220.0,4593.71956941761],[3222.0,3226.644753476612],[3223.0,3226.644753476612],[3225.0,3226.644753476612],[3226.0,3504.566225165563],[3226.0,3226.644753476612],[3226.0,2548.202290076336],[3228.0,4326.770202020202],[3228.0,3226.644753476612],[3229.0,3226.644753476612],[3229.0,2548.202290076336],[3234.0,4593.71956941761],[3234.0,2548.202290076336],[3234.0,4593.71956941761],[3235.0,3226.644753476612],[3235.0,2548.202290076336],[3235.0,3226.644753476612],[3237.0,3504.566225165563],[3238.0,3226.644753476612],[3238.0,3504.566225165563],[3242.0,2769.5319812792513],[3246.0,3504.566225165563],[3246.0,3226.644753476612],[3246.0,3504.566225165563],[3246.0,2548.202290076336],[562.0,657.5663161199184],[562.0,657.5663161199184],[562.0,657.5663161199184],[562.0,657.5663161199184],[563.0,839.3107438016528],[564.0,657.5663161199184],[564.0,657.5663161199184],[564.0,657.5663161199184],[565.0,657.5663161199184],[3247.0,3226.644753476612],[3247.0,3226.644753476612],[3247.0,2504.4583333333335],[3248.0,3226.644753476612],[3248.0,2504.4583333333335],[3249.0,2548.202290076336],[3249.0,2548.202290076336],[3250.0,3226.644753476612],[3250.0,3504.566225165563],[3250.0,3226.644753476612],[3250.0,3322.2290909090907],[3251.0,3226.644753476612],[3251.0,2769.5319812792513],[3253.0,3226.644753476612],[3253.0,2769.5319812792513],[3256.0,3504.566225165563],[3256.0,3322.2290909090907],[3257.0,3226.644753476612],[3257.0,4326.770202020202],[3258.0,3322.2290909090907],[3260.0,2769.5319812792513],[3261.0,2769.5319812792513],[3261.0,3226.644753476612],[3265.0,3226.644753476612],[3265.0,5504.096463022508],[3266.0,3504.566225165563],[3266.0,2769.5319812792513],[3266.0,4593.71956941761],[3266.0,3226.644753476612],[3267.0,3504.566225165563],[3267.0,3504.566225165563],[3267.0,2769.5319812792513],[3268.0,3226.644753476612],[3270.0,3226.644753476612],[3270.0,2504.4583333333335],[3270.0,3226.644753476612],[3272.0,3226.644753476612],[3274.0,4326.770202020202],[3275.0,3226.644753476612],[3276.0,4593.71956941761],[3278.0,5659.1858552631575],[3278.0,2769.5319812792513],[3279.0,2769.5319812792513],[3282.0,2769.5319812792513],[3282.0,3322.2290909090907],[3282.0,3504.566225165563],[3282.0,3504.566225165563],[3282.0,3504.566225165563],[3282.0,3504.566225165563],[3283.0,3322.2290909090907],[3283.0,3226.644753476612],[3284.0,3504.566225165563],[3285.0,3226.644753476612],[3285.0,3226.644753476612],[3287.0,3226.644753476612],[3288.0,3226.644753476612],[3290.0,3322.2290909090907],[3290.0,4593.71956941761],[3291.0,3226.644753476612],[3293.0,2769.5319812792513],[3293.0,4593.71956941761],[3293.0,3226.644753476612],[3294.0,3226.644753476612],[3294.0,3226.644753476612],[3296.0,5504.096463022508],[3296.0,4593.71956941761],[3296.0,3322.2290909090907],[3298.0,3226.644753476612],[3299.0,3322.2290909090907],[3299.0,3226.644753476612],[3300.0,4593.71956941761],[3300.0,3226.644753476612],[3300.0,3226.644753476612],[3302.0,4326.770202020202],[3303.0,3322.2290909090907],[3303.0,3322.2290909090907],[3303.0,3504.566225165563],[3303.0,3226.644753476612],[3303.0,2769.5319812792513],[3304.0,3226.644753476612],[3304.0,4593.71956941761],[3307.0,3226.644753476612],[3307.0,3226.644753476612],[3309.0,4593.71956941761],[565.0,657.5663161199184],[565.0,657.5663161199184],[565.0,657.5663161199184],[565.0,657.5663161199184],[566.0,839.3107438016528],[566.0,657.5663161199184],[566.0,657.5663161199184],[566.0,657.5663161199184],[566.0,657.5663161199184],[566.0,657.5663161199184],[3310.0,1870.0494905385735],[3311.0,2548.202290076336],[3311.0,3226.644753476612],[3312.0,2349.8163875598084],[3312.0,3504.566225165563],[3312.0,3226.644753476612],[3312.0,3504.566225165563],[3314.0,3226.644753476612],[3316.0,2349.8163875598084],[3319.0,3226.644753476612],[3319.0,3226.644753476612],[3321.0,4593.71956941761],[3322.0,2769.5319812792513],[3322.0,2349.8163875598084],[3323.0,2769.5319812792513],[3323.0,2504.4583333333335],[3323.0,2769.5319812792513],[3325.0,2548.202290076336],[3326.0,3504.566225165563],[3326.0,2769.5319812792513],[3328.0,2769.5319812792513],[3328.0,3226.644753476612],[3328.0,3504.566225165563],[3328.0,3322.2290909090907],[3329.0,3504.566225165563],[3334.0,3322.2290909090907],[3334.0,2548.202290076336],[3335.0,3504.566225165563],[3335.0,3504.566225165563],[3336.0,3226.644753476612],[3336.0,2769.5319812792513],[3336.0,2769.5319812792513],[3338.0,2548.202290076336],[3338.0,3322.2290909090907],[3340.0,3226.644753476612],[3342.0,4593.71956941761],[3342.0,3226.644753476612],[3342.0,3504.566225165563],[3342.0,3226.644753476612],[3343.0,3226.644753476612],[3344.0,4593.71956941761],[3346.0,2504.4583333333335],[3346.0,3226.644753476612],[3347.0,3226.644753476612],[3347.0,2769.5319812792513],[3349.0,4593.71956941761],[3349.0,2769.5319812792513],[3350.0,3226.644753476612],[3352.0,3226.644753476612],[3352.0,4593.71956941761],[3353.0,3504.566225165563],[3353.0,2769.5319812792513],[3354.0,3226.644753476612],[3356.0,3504.566225165563],[3358.0,3226.644753476612],[3360.0,2349.8163875598084],[3360.0,4593.71956941761],[3360.0,4593.71956941761],[3361.0,2769.5319812792513],[3362.0,2769.5319812792513],[3363.0,2548.202290076336],[3363.0,4326.770202020202],[3364.0,4326.770202020202],[3365.0,3226.644753476612],[3365.0,3226.644753476612],[3366.0,3226.644753476612],[3367.0,2548.202290076336],[3368.0,3504.566225165563],[3370.0,3226.644753476612],[3371.0,2548.202290076336],[3372.0,3226.644753476612],[3375.0,3226.644753476612],[3377.0,3504.566225165563],[3378.0,2548.202290076336],[3379.0,3504.566225165563],[3379.0,3504.566225165563],[3379.0,3504.566225165563],[3380.0,3226.644753476612],[3380.0,3226.644753476612],[3382.0,3322.2290909090907],[407.0,657.5663161199184],[407.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[408.0,657.5663161199184],[567.0,657.5663161199184],[567.0,657.5663161199184],[567.0,657.5663161199184],[567.0,868.8946521913953]],"arguments":{},"schema":[{"type":"double","name":"price"},{"type":"double","name":"prediction"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":false},"errorSummary":null,"error":null,"startTime":1.445464234663E12,"submitTime":1.445464234612E12,"finishTime":1.445464234756E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"bc6f1470-a230-4b6e-8d99-be37086312c3"},{"version":"CommandV1","origId":2263,"guid":"066e471c-c708-431f-b4df-862730372442","subtype":"command","commandType":"auto","position":7.47900390625,"command":"%md We now compute the error of the DecisionTreeModel on the test dataset.  We will use the RegressionEvaluator, which uses Root Mean Squared Error (RMSE) as our error metric by default.\n\nDenote (y_i, x_i) as the (label, feature vector) for instance i, and write model.predict(x_i) as our model's predicted label for instance i.  RMSE is defined as:\n\n%[ RMSE(dataset) = \\left[ \\mathbf{avg}_{(y_i, x_i) \\in dataset} \\left( y_i - model.predict(x_i) \\right)^2 \\right]^{1/2} ]%","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null,"nuid":"ac323647-bcb4-41d9-b7ab-6bdf48390058"},{"version":"CommandV1","origId":2264,"guid":"ed33fbc7-7383-4bed-8d84-5062b0a5615e","subtype":"command","commandType":"auto","position":7.4892578125,"command":"from pyspark.ml.evaluation import RegressionEvaluator\n\n# Evaluate model using the RegressionEvaluator\nevaluator = RegressionEvaluator(predictionCol=\"prediction\", labelCol=\"price\")\nevaluator.evaluate(initialPredictions)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">122</span><span class=\"ansired\">]: </span>1060.3779299144314\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: Field &quot;predictions&quot; does not exist.","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-69-f0cd039ee555&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> evaluator <span class=\"ansiyellow\">=</span> RegressionEvaluator<span class=\"ansiyellow\">(</span>predictionCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;predictions&quot;</span><span class=\"ansiyellow\">,</span> labelCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;price&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\"> </span>evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>predictions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     63</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 65</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     67</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     92</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     93</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 94</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     95</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     96</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     40</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     41</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 42</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     43</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: Field &quot;predictions&quot; does not exist.\n</div>","startTime":1.445464235343E12,"submitTime":1.445464235293E12,"finishTime":1.44546423552E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"5c08f661-9d88-4306-95fe-d4798ac9adb2"},{"version":"CommandV1","origId":2265,"guid":"767b7b02-6fa2-4add-af27-9b7650a17968","subtype":"command","commandType":"auto","position":7.509765625,"command":"# We can use getMetricName to see which error metric is being used\nevaluator.getMetricName()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">123</span><span class=\"ansired\">]: </span>&apos;rmse&apos;\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;Param&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-60-2f42167970d5&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>evaluator<span class=\"ansiyellow\">.</span>metricName<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;Param&apos; object is not callable\n</div>","startTime":1.445464235878E12,"submitTime":1.445464235821E12,"finishTime":1.445464235924E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"98b69e17-03c8-4638-92e3-d51aebbd19e7"},{"version":"CommandV1","origId":2266,"guid":"ce282de0-0b76-40e6-9c0e-1af3ae8feb97","subtype":"command","commandType":"auto","position":7.55078125,"command":"# View available param options for the RegressionEvaluator\nprint evaluator.explainParams()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelCol: label column name (default: label, current: price)\nmetricName: metric name in evaluation (mse|rmse|r2|mae) (default: rmse)\npredictionCol: prediction column name (default: prediction, current: prediction)\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445464237188E12,"submitTime":1.445464237145E12,"finishTime":1.445464237263E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"441c8755-0337-4a5a-98bb-4c6d980f7b96"},{"version":"CommandV1","origId":2267,"guid":"d86e176a-3b87-4331-b29f-1cfdeec9a7c8","subtype":"command","commandType":"auto","position":7.8046875,"command":"%md ## Tune the model (using training dataset)\n\nThe DecisionTree model above used the default parameters.  Examining the documentation (below), we can see there are a lot of parameters one could try tuning to improve the accuracy of the model.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427838757113E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"c195a480-fd01-473b-9a91-75a0760f7bd3"},{"version":"CommandV1","origId":2268,"guid":"7266266b-b71c-4cc4-ab31-e3c0f948c284","subtype":"command","commandType":"auto","position":8.3046875,"command":"# Expand this cell to see the help info for DecisionTree:\n\nhelp(DecisionTreeRegressor)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Help on class DecisionTreeRegressor in module pyspark.ml.regression:\n\nclass DecisionTreeRegressor(pyspark.ml.wrapper.JavaEstimator, pyspark.ml.param.shared.HasFeaturesCol, pyspark.ml.param.shared.HasLabelCol, pyspark.ml.param.shared.HasPredictionCol, pyspark.ml.param.shared.DecisionTreeParams, pyspark.ml.param.shared.HasCheckpointInterval)\n |  &#96;http://en.wikipedia.org/wiki/Decision_tree_learning Decision tree&#96;\n |  learning algorithm for regression.\n |  It supports both continuous and categorical features.\n |  \n |  &gt;&gt;&gt; from pyspark.mllib.linalg import Vectors\n |  &gt;&gt;&gt; df = sqlContext.createDataFrame([\n |  ...     (1.0, Vectors.dense(1.0)),\n |  ...     (0.0, Vectors.sparse(1, [], []))], [&quot;label&quot;, &quot;features&quot;])\n |  &gt;&gt;&gt; dt = DecisionTreeRegressor(maxDepth=2)\n |  &gt;&gt;&gt; model = dt.fit(df)\n |  &gt;&gt;&gt; model.depth\n |  1\n |  &gt;&gt;&gt; model.numNodes\n |  3\n |  &gt;&gt;&gt; test0 = sqlContext.createDataFrame([(Vectors.dense(-1.0),)], [&quot;features&quot;])\n |  &gt;&gt;&gt; model.transform(test0).head().prediction\n |  0.0\n |  &gt;&gt;&gt; test1 = sqlContext.createDataFrame([(Vectors.sparse(1, [0], [1.0]),)], [&quot;features&quot;])\n |  &gt;&gt;&gt; model.transform(test1).head().prediction\n |  1.0\n |  \n |  Method resolution order:\n |      DecisionTreeRegressor\n |      pyspark.ml.wrapper.JavaEstimator\n |      pyspark.ml.pipeline.Estimator\n |      pyspark.ml.wrapper.JavaWrapper\n |      pyspark.ml.param.shared.HasFeaturesCol\n |      pyspark.ml.param.shared.HasLabelCol\n |      pyspark.ml.param.shared.HasPredictionCol\n |      pyspark.ml.param.shared.DecisionTreeParams\n |      pyspark.ml.param.shared.HasCheckpointInterval\n |      pyspark.ml.param.Params\n |      pyspark.ml.util.Identifiable\n |      __builtin__.object\n |  \n |  Methods defined here:\n |  \n |  __init__(*args, **kwargs)\n |      __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;,                  maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0,                  maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, impurity=&quot;variance&quot;)\n |  \n |  getImpurity(self)\n |      Gets the value of impurity or its default value.\n |  \n |  setImpurity(self, value)\n |      Sets the value of :py:attr:&#96;impurity&#96;.\n |  \n |  setParams(*args, **kwargs)\n |      setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;,                   maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0,                   maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, impurity=&quot;variance&quot;)\n |      Sets params for the DecisionTreeRegressor.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes defined here:\n |  \n |  __abstractmethods__ = frozenset([])\n |  \n |  __slotnames__ = []\n |  \n |  impurity = Param(parent=&apos;undefined&apos;, name=&apos;impurity&apos;, doc=&apos;...(case-in...\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.wrapper.JavaEstimator:\n |  \n |  __metaclass__ = &lt;class &apos;abc.ABCMeta&apos;&gt;\n |      Metaclass for defining Abstract Base Classes (ABCs).\n |      \n |      Use this metaclass to create an ABC.  An ABC can be subclassed\n |      directly, and then acts as a mix-in class.  You can also register\n |      unrelated concrete classes (even built-in classes) and unrelated\n |      ABCs as &apos;virtual subclasses&apos; -- these and their descendants will\n |      be considered subclasses of the registering ABC by the built-in\n |      issubclass() function, but the registering ABC won&apos;t show up in\n |      their MRO (Method Resolution Order) nor will method\n |      implementations defined by the registering ABC be callable (not\n |      even via super()).\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.pipeline.Estimator:\n |  \n |  fit(self, dataset, params=None)\n |      Fits a model to the input dataset with optional parameters.\n |      \n |      :param dataset: input dataset, which is an instance of\n |                      :py:class:&#96;pyspark.sql.DataFrame&#96;\n |      :param params: an optional param map that overrides embedded\n |                     params. If a list/tuple of param maps is given,\n |                     this calls fit on each param map and returns a\n |                     list of models.\n |      :returns: fitted model(s)\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasFeaturesCol:\n |  \n |  getFeaturesCol(self)\n |      Gets the value of featuresCol or its default value.\n |  \n |  setFeaturesCol(self, value)\n |      Sets the value of :py:attr:&#96;featuresCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasFeaturesCol:\n |  \n |  featuresCol = Param(parent=&apos;undefined&apos;, name=&apos;featuresCol&apos;, doc=&apos;featu...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasLabelCol:\n |  \n |  getLabelCol(self)\n |      Gets the value of labelCol or its default value.\n |  \n |  setLabelCol(self, value)\n |      Sets the value of :py:attr:&#96;labelCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasLabelCol:\n |  \n |  labelCol = Param(parent=&apos;undefined&apos;, name=&apos;labelCol&apos;, doc=&apos;label colum...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasPredictionCol:\n |  \n |  getPredictionCol(self)\n |      Gets the value of predictionCol or its default value.\n |  \n |  setPredictionCol(self, value)\n |      Sets the value of :py:attr:&#96;predictionCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasPredictionCol:\n |  \n |  predictionCol = Param(parent=&apos;undefined&apos;, name=&apos;predictionCol&apos;, doc=&apos;p...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.DecisionTreeParams:\n |  \n |  getCacheNodeIds(self)\n |      Gets the value of cacheNodeIds or its default value.\n |  \n |  getMaxBins(self)\n |      Gets the value of maxBins or its default value.\n |  \n |  getMaxDepth(self)\n |      Gets the value of maxDepth or its default value.\n |  \n |  getMaxMemoryInMB(self)\n |      Gets the value of maxMemoryInMB or its default value.\n |  \n |  getMinInfoGain(self)\n |      Gets the value of minInfoGain or its default value.\n |  \n |  getMinInstancesPerNode(self)\n |      Gets the value of minInstancesPerNode or its default value.\n |  \n |  setCacheNodeIds(self, value)\n |      Sets the value of :py:attr:&#96;cacheNodeIds&#96;.\n |  \n |  setMaxBins(self, value)\n |      Sets the value of :py:attr:&#96;maxBins&#96;.\n |  \n |  setMaxDepth(self, value)\n |      Sets the value of :py:attr:&#96;maxDepth&#96;.\n |  \n |  setMaxMemoryInMB(self, value)\n |      Sets the value of :py:attr:&#96;maxMemoryInMB&#96;.\n |  \n |  setMinInfoGain(self, value)\n |      Sets the value of :py:attr:&#96;minInfoGain&#96;.\n |  \n |  setMinInstancesPerNode(self, value)\n |      Sets the value of :py:attr:&#96;minInstancesPerNode&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.DecisionTreeParams:\n |  \n |  cacheNodeIds = Param(parent=&apos;undefined&apos;, name=&apos;cacheNodeIds&apos;, d... Cac...\n |  \n |  maxBins = Param(parent=&apos;undefined&apos;, name=&apos;maxBins&apos;, doc=&apos;M...mber of c...\n |  \n |  maxDepth = Param(parent=&apos;undefined&apos;, name=&apos;maxDepth&apos;, doc=&apos;...; depth ...\n |  \n |  maxMemoryInMB = Param(parent=&apos;undefined&apos;, name=&apos;maxMemoryInMB&apos;, ...emo...\n |  \n |  minInfoGain = Param(parent=&apos;undefined&apos;, name=&apos;minInfoGain&apos;, do...in fo...\n |  \n |  minInstancesPerNode = Param(parent=&apos;undefined&apos;, name=&apos;minInstancesPerN...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasCheckpointInterval:\n |  \n |  getCheckpointInterval(self)\n |      Gets the value of checkpointInterval or its default value.\n |  \n |  setCheckpointInterval(self, value)\n |      Sets the value of :py:attr:&#96;checkpointInterval&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasCheckpointInterval:\n |  \n |  checkpointInterval = Param(parent=&apos;undefined&apos;, name=&apos;checkpointInterva...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.Params:\n |  \n |  copy(self, extra=None)\n |      Creates a copy of this instance with the same uid and some\n |      extra params. The default implementation creates a\n |      shallow copy using :py:func:&#96;copy.copy&#96;, and then copies the\n |      embedded and extra parameters over and returns the copy.\n |      Subclasses should override this method if the default approach\n |      is not sufficient.\n |      \n |      :param extra: Extra parameters to copy to the new instance\n |      :return: Copy of this instance\n |  \n |  explainParam(self, param)\n |      Explains a single param and returns its name, doc, and optional\n |      default value and user-supplied value in a string.\n |  \n |  explainParams(self)\n |      Returns the documentation of all params with their optionally\n |      default values and user-supplied values.\n |  \n |  extractParamMap(self, extra=None)\n |      Extracts the embedded default param values and user-supplied\n |      values, and then merges them with extra values from input into\n |      a flat param map, where the latter value is used if there exist\n |      conflicts, i.e., with ordering: default param values &lt;\n |      user-supplied values &lt; extra.\n |      \n |      :param extra: extra param values\n |      :return: merged param map\n |  \n |  getOrDefault(self, param)\n |      Gets the value of a param in the user-supplied param map or its\n |      default value. Raises an error if neither is set.\n |  \n |  getParam(self, paramName)\n |      Gets a param by its name.\n |  \n |  hasDefault(self, param)\n |      Checks whether a param has a default value.\n |  \n |  hasParam(self, paramName)\n |      Tests whether this instance contains a param with a given\n |      (string) name.\n |  \n |  isDefined(self, param)\n |      Checks whether a param is explicitly set by user or has\n |      a default value.\n |  \n |  isSet(self, param)\n |      Checks whether a param is explicitly set by user.\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from pyspark.ml.param.Params:\n |  \n |  params\n |      Returns all params ordered by name. The default implementation\n |      uses :py:func:&#96;dir&#96; to get all attributes of type\n |      :py:class:&#96;Param&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.util.Identifiable:\n |  \n |  __repr__(self)\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from pyspark.ml.util.Identifiable:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;DecisionTree&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-133-552da66a5e5f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># Expand this cell to see the help info for DecisionTree:</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>help<span class=\"ansiyellow\">(</span>DecisionTree<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;DecisionTree&apos; is not defined\n</div>","startTime":1.445468607978E12,"submitTime":1.445468607935E12,"finishTime":1.445468608055E12,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"2a3c8adf-9386-4141-a2af-673ec1f4af72"},{"version":"CommandV1","origId":2269,"guid":"d3344407-044a-466c-ab87-f121e1e43504","subtype":"command","commandType":"auto","position":8.5546875,"command":"%md  We will try tuning one of these parameters: maxDepth.  Deeper trees are more expressive and powerful, but they can also overfit on the training data.\n\nWe will split our training data into a smaller training set (partTrainingData) and a validation set (validationData).  For a range of maxDepth parameter settings, we will train on partTrainingSet.  For each tree we produce, we will evaluate on the held-out validationData.  At the end, we will choose the tree which did best on the validationData.  This will let us choose a good parameter setting but limit the risk of overfitting on the training data.\n\nParameter tuning (a.k.a. model selection) can also be done using [k-fold cross validation](http://en.wikipedia.org/wiki/Cross-validation_&#40;statistics&#41;), which can be more accurate than a simple (training, validation) split.  The [Pipelines API](http://spark.apache.org/docs/latest/ml-guide.html) provides a CrossValidator algorithm which handles this automatically.\n\nCurrently, the CrossValidator only returns the error metrics for the bestModel, and will only be able to return error metrics for all models created after Spark 1.6.\nIn this example, as we will be looking at how various tree depths affect error rates and overfitting, we will do our parameter tuning manually.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427838831439E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"306ae37d-eca7-419d-8926-eb4408ea6db3"},{"version":"CommandV1","origId":2270,"guid":"69eabeda-f6b5-4567-a9ef-439547c0ede4","subtype":"command","commandType":"auto","position":8.5703125,"command":"# Split the trainingData into 2 parts: partTrainingData, validationData\n(partTrainingData, validationData) = trainingData.randomSplit([0.7, 0.3])\npartTrainingData.cache()\nvalidationData.cache()\nprint 'Tuning model using %d training instances and %d validation instances' % (partTrainingData.count(), validationData.count())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tuning model using 26339 training instances and 11457 validation instances\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445460639565E12,"submitTime":1.445460639518E12,"finishTime":1.445460640096E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"b89ed374-ebdc-4794-b6e4-88c65838fdf8"},{"version":"CommandV1","origId":2271,"guid":"36e6e157-fb84-47e9-a372-8e7fd8d6249d","subtype":"command","commandType":"auto","position":8.616943359375,"command":"# We will try these settings for maxDepth\nmaxDepthSettings = [1, 2, 4, 6, 8, 10, 12, 14]\n\n# Function that creates models for every depth in maxDepthSettings\ndef createModel(depth, data):\n  dt = DecisionTreeRegressor(labelCol=\"price\", featuresCol=\"features\", maxDepth=depth)\n  dtPipeline = Pipeline(stages = [cutIndexer, colorIndexer, clarityIndexer, assembler, dt])\n  dtModel = dtPipeline.fit(data)\n  return dtModel\n\n# Create models\nmodels = map(lambda depth: createModel(depth, partTrainingData), maxDepthSettings)\n\n# Create predictions\ntrainPredictions = map(lambda model: model.transform(partTrainingData), models)\nvalPredictions = map(lambda model: model.transform(validationData), models)\n\n# Calculate RMSE\ntrainRMSE = map(lambda prediction: evaluator.evaluate(prediction), trainPredictions)\nvalRMSE = map(lambda prediction: evaluator.evaluate(prediction), valPredictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445462791226E12,"submitTime":1.445462791042E12,"finishTime":1.445462805606E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"ca65bb59-97a0-4d05-9cbc-243d4a24678b"},{"version":"CommandV1","origId":2272,"guid":"67cdc276-e46b-4aac-92e3-327140bf6786","subtype":"command","commandType":"auto","position":8.617080688476562,"command":"# Plot the training and validation errors for the trees of different depths.\nfrom matplotlib import pyplot\npyplot.clf()\npyplot.plot(maxDepthSettings, trainingErrors, 'b-', label='training error')\npyplot.hold(True)\npyplot.plot(maxDepthSettings, validationErrors, 'r-', label='validation error')\npyplot.xlabel('maxDepth')\npyplot.ylabel('error (RMSE)')\npyplot.ylim(ymin=0)\npyplot.legend()\npyplot.title('Tuning maxDepth: Evaluation and Overfitting')\ndisplay()","commandVersion":0,"state":"finished","results":{"type":"image","data":"88470e07-c6af-48ba-a694-20e9f66631b7.png","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445535697043E12,"submitTime":1.445535696991E12,"finishTime":1.445535697476E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"b465e638-bae2-4eb9-a8df-70ad895e8fdd"},{"version":"CommandV1","origId":2273,"guid":"783cbde1-bfdb-44bb-8ee1-2dd39c705a56","subtype":"command","commandType":"auto","position":8.617088317871094,"command":"%md We can see that DecisionTree starts to overfit around maxDepth=10 or 12 on this dataset.  As the tree gets deeper than 10 or 12 levels, the training error decreases further, but the validation error begins to increase.\n\n*Note: There is randomness in how we split the data and in training the tree, so re-running this notebook may give slightly different results.*\n\nWe will choose the best maxDepth setting and re-train a final model using all of trainingData.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null,"nuid":"13b36c15-2893-435f-a107-8e644e560515"},{"version":"CommandV1","origId":2274,"guid":"c3cb8e5b-540f-4d72-ad55-405c92aad983","subtype":"command","commandType":"auto","position":8.617095947265625,"command":"import numpy\nbestMaxDepth = maxDepthSettings[numpy.argmin(validationErrors)]\nprint 'Chose best maxDepth = %d' % bestMaxDepth","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Chose best maxDepth = 10\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445463493983E12,"submitTime":1.445463493934E12,"finishTime":1.445463494031E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"a28b69c2-50c8-4c39-8b3e-e50cb34d20be"},{"version":"CommandV1","origId":2275,"guid":"195e223b-fc07-437f-ad73-e50ac12171d8","subtype":"command","commandType":"auto","position":8.802978515625,"command":"# Train a tree using ALL of the trainingData and using the BEST maxDepth parameter we found.\ndt = DecisionTreeRegressor(labelCol=\"price\", featuresCol=\"features\", maxDepth=bestMaxDepth)\ndtPipeline = Pipeline(stages = [cutIndexer, colorIndexer, clarityIndexer, assembler, dt])\nfinalModel = dtPipeline.fit(trainingData)\nfinalTrainPredictions = finalModel.transform(trainingData)\nfinalTestPredictions = finalModel.transform(testData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.445537565108E12,"submitTime":1.44553756505E12,"finishTime":1.445537566929E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"a7f2b3a1-4489-4993-ad40-4a4d196c8aca"},{"version":"CommandV1","origId":2276,"guid":"e96879e6-432d-4dbc-a47f-4fc8d80b4d70","subtype":"command","commandType":"auto","position":8.80426025390625,"command":"# finalModel summary\nprint finalModel.stages[4]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DecisionTreeRegressionModel of depth 10 with 1855 nodes\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">Exception</span>: ML model display does not yet support pyspark.ml (Pipelines API).","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Exception</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-243-2beb77392a52&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>finalModel<span class=\"ansiyellow\">.</span>stages<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">4</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/tmp/1445289733704-0/PythonShell.py</span> in <span class=\"ansicyan\">display</span><span class=\"ansiblue\">(self, input, *args)</span>\n<span class=\"ansigreen\">    439</span>         <span class=\"ansigreen\">elif</span> self<span class=\"ansiyellow\">.</span>mlModelDisplayOn <span class=\"ansigreen\">and</span> type<span class=\"ansiyellow\">(</span>input<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>__module__<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;pyspark.ml&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    440</span>             raise Exception(&quot;ML model display does not yet support pyspark.ml (Pipelines API).\\n&quot; +\n<span class=\"ansigreen\">--&gt; 441</span><span class=\"ansiyellow\">                             genericErrorMsg)\n</span><span class=\"ansigreen\">    442</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    443</span>             <span class=\"ansigreen\">raise</span> Exception<span class=\"ansiyellow\">(</span>genericErrorMsg<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">Exception</span>: ML model display does not yet support pyspark.ml (Pipelines API).\nCannot call display(&lt;class &apos;pyspark.ml.regression.DecisionTreeRegressionModel&apos;&gt;)\n Call help(display) for more info.\n</div>","startTime":1.445540134187E12,"submitTime":1.445540134145E12,"finishTime":1.445540134234E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"bb1bdacc-8737-462f-a1e6-bca72b91f84c"},{"version":"CommandV1","origId":2277,"guid":"00591816-0a81-499e-a914-9c2ad1aa8f79","subtype":"command","commandType":"auto","position":8.8046875,"command":"%md ## Evaluate the model\n\nNow that we are done tuning parameters and have trained our final model, we can finally look at our test dataset and see how we've done.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427840996731E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"9ff241f1-bd60-493d-a8b3-3df202ac9b0a"},{"version":"CommandV1","origId":2278,"guid":"feddb2c7-1536-48d8-a204-ad61ed32f780","subtype":"command","commandType":"auto","position":9.0546875,"command":"finalTrainRMSE = evaluator.evaluate(finalTrainPredictions)\nfinalTestRMSE = evaluator.evaluate(finalTestPredictions)\n\nprint 'Final model achieves:'\nprint '  Training error: %g' % finalTrainRMSE\nprint '  Test error:     %g' % finalTestRMSE","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Final model achieves:\n  Training error: 579.777\n  Test error:     703.017\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;finalTrainError&apos; is not defined","error":"<div class=\"ansiout\">Final model achieves:\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-104-67d7f96b40c3&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> finalTestRMSE <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>testPredictions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;Final model achieves:&apos;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;  Training error: %g&apos;</span> <span class=\"ansiyellow\">%</span> finalTrainError<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;  Test error:     %g&apos;</span> <span class=\"ansiyellow\">%</span> finalTestError<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;finalTrainError&apos; is not defined\n</div>","startTime":1.445537579965E12,"submitTime":1.445537579921E12,"finishTime":1.445537580345E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"5100ba67-5e56-4f5c-92e7-528d2e6386d0"},{"version":"CommandV1","origId":2279,"guid":"5d7e48df-326a-41cc-ae78-67cc8f23d076","subtype":"command","commandType":"auto","position":9.5546875,"command":"%md Note that the above errors of our final model are much better than our initial model!  We can look back at the previous models we trained to see how well they do on the test dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427841005514E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"b0613339-3d5b-4e44-b22e-d41af895dde1"},{"version":"CommandV1","origId":2280,"guid":"0c41b033-b7bd-4329-a0fc-6ae4c3840fb1","subtype":"command","commandType":"auto","position":9.6796875,"command":"# Our initial model (maxDepth = 5, the default value) does much worse than the tuned model.\ninitialTrainPredictions = initialModel.transform(trainingData)\ninitialTestPredictions = initialModel.transform(testData)\ninitialTrainRMSE = evaluator.evaluate(initialTrainPredictions)\ninitialTestRMSE = evaluator.evaluate(initialTestPredictions)\n\nprint 'Our initial model achieved:'\nprint '  Training error: %g' % initialTrainRMSE\nprint '  Test error:     %g' % initialTestRMSE","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Our initial model achieved:\n  Training error: 1031.86\n  Test error:     1060.38\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">TypeError</span>: float argument required, not DataFrame","error":"<div class=\"ansiout\">Our initial model achieved:\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-114-6b7b3e3b47e9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      5</span> finalTestRMSE <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>initialTestPredictions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;Our initial model achieved:&apos;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;  Training error: %g&apos;</span> <span class=\"ansiyellow\">%</span> initialTrainPredictions<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;  Test error:     %g&apos;</span> <span class=\"ansiyellow\">%</span> initialTestPredictions<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: float argument required, not DataFrame\n</div>","startTime":1.445537584495E12,"submitTime":1.44553758445E12,"finishTime":1.445537584874E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"76b5814e-6e3c-44b7-94ab-eb1a08e66c93"},{"version":"CommandV1","origId":2281,"guid":"2173b8ae-a155-4d97-a25e-da5100a61a24","subtype":"command","commandType":"auto","position":9.7421875,"command":"%md Recall that we limited maxDepth since the tree for large maxDepth = 14 seemed to overfit.  If we measure errors on the test dataset, we can see that we made a good choice!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427841409727E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"2876c7ba-6557-4d6d-afba-fbe98a9f5804"},{"version":"CommandV1","origId":2282,"guid":"9fe84a78-b73f-492b-a17a-68507ee58739","subtype":"command","commandType":"auto","position":9.765625,"command":"# Compute the training and test errors for our trees of different depths from model tuning.\n\n# Create predictions\nfullTrainingPredictions = map(lambda model: model.transform(trainingData), models)\ntestPredictions = map(lambda model: model.transform(testData), models)\n\n# Calculate RMSE\nfullTrainingErrors = map(lambda prediction: evaluator.evaluate(prediction), fullTrainingPredictions)\ntestErrors = map(lambda prediction: evaluator.evaluate(prediction), testPredictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1.44553596656E12,"submitTime":1.445535966511E12,"finishTime":1.445535969619E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"9d3cda25-1dbb-4810-b000-9edbd665b059"},{"version":"CommandV1","origId":2283,"guid":"db290ef9-437b-47a4-a9ae-0cc8871b7996","subtype":"command","commandType":"auto","position":9.7890625,"command":"# We do a similar plot as before, but we now compute the error on (a) the full training dataset and (b) the test dataset.\n# We also plot the results for the final model trained.\nfrom matplotlib import pyplot\npyplot.clf()\npyplot.plot(maxDepthSettings, fullTrainingErrors, 'b-', label='training error')\npyplot.hold(True)\npyplot.plot(maxDepthSettings, testErrors, 'r-', label='test error')\npyplot.plot(bestMaxDepth, finalTrainRMSE, 'b*', ms=14, label='final model training error')\npyplot.plot(bestMaxDepth, finalTestRMSE, 'r*', ms=14, label='final model test error')\npyplot.xlabel('maxDepth')\npyplot.ylabel('error (RMSE)')\npyplot.ylim(ymin=0)\npyplot.legend()\npyplot.title('Final model vs. models from tuning maxDepth\\n(on full training data + test data)')\ndisplay()","commandVersion":0,"state":"finished","results":{"type":"image","data":"f7448ffb-53e0-401f-8bb6-f0fb564e413c.png","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;finalTrainingError&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-136-0e457b8974e9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span> pyplot<span class=\"ansiyellow\">.</span>hold<span class=\"ansiyellow\">(</span>True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> pyplot<span class=\"ansiyellow\">.</span>plot<span class=\"ansiyellow\">(</span>maxDepthSettings<span class=\"ansiyellow\">,</span> testErrors<span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;r-&apos;</span><span class=\"ansiyellow\">,</span> label<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;test error&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\"> </span>pyplot<span class=\"ansiyellow\">.</span>plot<span class=\"ansiyellow\">(</span>bestMaxDepth<span class=\"ansiyellow\">,</span> finalTrainingError<span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;b*&apos;</span><span class=\"ansiyellow\">,</span> ms<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">14</span><span class=\"ansiyellow\">,</span> label<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;final model training error&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> pyplot<span class=\"ansiyellow\">.</span>plot<span class=\"ansiyellow\">(</span>bestMaxDepth<span class=\"ansiyellow\">,</span> finalTestRMSE<span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;r*&apos;</span><span class=\"ansiyellow\">,</span> ms<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">14</span><span class=\"ansiyellow\">,</span> label<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;final model test error&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> pyplot<span class=\"ansiyellow\">.</span>xlabel<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;maxDepth&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;finalTrainingError&apos; is not defined\n</div>","startTime":1.44553597128E12,"submitTime":1.445535971237E12,"finishTime":1.445535971983E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"4a6db0e9-befc-4d13-9bf3-2c7eb6364565"},{"version":"CommandV1","origId":2284,"guid":"b9d70541-c724-4a47-9ce3-5c9687906f70","subtype":"command","commandType":"auto","position":9.796875,"command":"%md In the above plot, the error of the final model (`finalModel`) can be lower (better) than the error of the original model of the same depth (in `trees`).  This is because the final model was trained on the entire training dataset (`trainingData`), rather than the subset (`partTrainingData`) using during parameter tuning.\n\n*Note: This may not occur on every notebook run because of randomness in splitting the dataset and training.*","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427841554025E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"bf28f7a8-d364-4816-8fb5-f46fb5e45777"},{"version":"CommandV1","origId":2285,"guid":"bf33a249-9a52-4923-8a64-383016ab95a2","subtype":"command","commandType":"auto","position":9.8046875,"command":"%md ## Understand the model and results\n\nWe have computed the model error, but what does it mean?  In this section, we examine our model and results more carefully to get more meaningful insights.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427841772423E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"dba99f66-e8cd-4ea8-a9ef-a2dc76574a2f"},{"version":"CommandV1","origId":2286,"guid":"276869e2-f2e0-486d-a681-0419b3abc680","subtype":"command","commandType":"auto","position":10.8046875,"command":"%md ### Results\n\nWhat does the error RMSE mean?  Recall that we are trying to predict diamond prices from a description of diamond attributes.  RMSE measures how far off our predictions are from the true price on average.  (It is not exactly an average, but the intuition fits.)\n\nSo is it bad to be off by 500 dollars?  That depends on the true price.  We calculate a more meaningful error measure which we will call \"relative error,\" defined as:\n\n%[ RelativeError(dataset) = \\mathbf{avg}_{(y_i, x_i) \\in dataset} \\frac{ \\| y_i - model.predict(x_i) \\| }{ \\| y_i \\| } ]%\n\nThis relative error normalizes the error by the magnitude of the true label; thus, it is more OK to be off by 5 dollars for a 1000 dollar diamond than for a 10 dollar diamond.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427841855245E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"dfbcd503-ea07-4bd7-baa0-4344b9d4e66b"},{"version":"CommandV1","origId":2287,"guid":"28afee14-4d2f-47b0-bc7a-4675b6d998e2","subtype":"command","commandType":"auto","position":12.3046875,"command":"# We will generate a plot similar to the one above, but will use relative error instead of RMSE.\ntrainingLabelsAndPreds = map(lambda df: df.select(\"price\", \"prediction\"), fullTrainingPredictions)\ntestLabelsAndPreds = map(lambda df: df.select(\"price\", \"prediction\"), testPredictions)\nfinalTrainingLabelsAndPreds = finalTrainPredictions.select(\"price\", \"prediction\")\nfinalTestLabelsAndPreds = finalTestPredictions.select(\"price\", \"prediction\")\n\n# Function to calculate Relative Error\ndef computeRelativeError(labsAndPreds):\n  relErr = labsAndPreds.map(lambda label_pred: abs(label_pred[0] - label_pred[1]) / abs(label_pred[0])).mean()\n  return relErr\n\n# Compute training, test relative errors for our various models.\ntrainingRelativeErrors = map(lambda df: computeRelativeError(df), trainingLabelsAndPreds)\nfinalTrainingRelativeError = computeRelativeError(finalTrainingLabelsAndPreds)\ntestRelativeErrors = map(lambda df: computeRelativeError(df), testLabelsAndPreds)\nfinalTestRelativeError = computeRelativeError(finalTestLabelsAndPreds)\n\n# Make a similar plot as before, but with relative error.\nfrom matplotlib import pyplot\npyplot.clf()\npyplot.plot(maxDepthSettings, trainingRelativeErrors, 'b-', label='training relative error')\npyplot.hold(True)\npyplot.plot(maxDepthSettings, testRelativeErrors, 'r-', label='test relative error')\npyplot.plot(bestMaxDepth, finalTrainingRelativeError, 'b*', ms=14, label='final model training relative error')\npyplot.plot(bestMaxDepth, finalTestRelativeError, 'r*', ms=14, label='final model test relative error')\npyplot.xlabel('maxDepth')\npyplot.ylabel('relative absolute error')\npyplot.ylim(ymin=0)\npyplot.legend()\npyplot.title('Comparing final model vs. models from tuning maxDepth\\n(based on relative error)')\ndisplay()","commandVersion":0,"state":"finished","results":{"type":"image","data":"9b85ec2d-4323-42bb-a20a-6b450a7a2880.png","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;Column&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-212-c9c891e4e1c5&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> trainingRelativeErrors <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> trainingLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 11</span><span class=\"ansiyellow\"> </span>finalTrainingRelativeError <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> finalTrainingLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span> testRelativeErrors <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> testLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span> finalTestRelativeError <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> finalTestLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-212-c9c891e4e1c5&gt;</span> in <span class=\"ansicyan\">&lt;lambda&gt;</span><span class=\"ansiblue\">(df)</span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> trainingRelativeErrors <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> trainingLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 11</span><span class=\"ansiyellow\"> </span>finalTrainingRelativeError <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> finalTrainingLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span> testRelativeErrors <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> testLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span> finalTestRelativeError <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> df<span class=\"ansiyellow\">:</span> computeRelativeError<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> finalTestLabelsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-212-c9c891e4e1c5&gt;</span> in <span class=\"ansicyan\">computeRelativeError</span><span class=\"ansiblue\">(labsAndPreds)</span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansigreen\">def</span> computeRelativeError<span class=\"ansiyellow\">(</span>labsAndPreds<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\">   </span>relErr <span class=\"ansiyellow\">=</span> labsAndPreds<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> label_pred<span class=\"ansiyellow\">:</span> abs<span class=\"ansiyellow\">(</span>label_pred<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">-</span> label_pred<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">/</span> abs<span class=\"ansiyellow\">(</span>label_pred<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>mean<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span>   <span class=\"ansigreen\">return</span> relErr<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;Column&apos; object is not callable\n</div>","startTime":1.445539148037E12,"submitTime":1.445539147984E12,"finishTime":1.445539153855E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"raela@databricks.com","iPythonMetadata":null,"nuid":"442aef96-d672-4917-8978-35351f58d274"},{"version":"CommandV1","origId":2288,"guid":"246144e0-82c6-41f7-b570-87e65c63909a","subtype":"command","commandType":"auto","position":12.8046875,"command":"%md We can see a few insights:\n* On average, our finalModel's predictions are within about 10% of the true selling price.\n* The models with different depths can perform differently when using different error metrics.  If we care more about relative error than RMSE, then we should have done parameter tuning using relative error, not RMSE.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427842334823E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"61efcbf6-93cc-4976-8843-262ae46b2bb5"},{"version":"CommandV1","origId":2289,"guid":"ca02330b-2392-44c3-92f9-ed609c0ff86f","subtype":"command","commandType":"auto","position":18.8046875,"command":"%md There are many more ways to explore datasets, models, and evaluation.  Hopefully this gives a starting point from which you can build your own ML workflow!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.427843339597E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"diffInserts":null,"diffDeletes":null,"globalVars":{},"latestUser":null,"iPythonMetadata":null,"nuid":"b99ac918-2580-4acf-9386-8ba7b4d5489b"}],"guid":"427a6bd8-c578-42b8-a62b-a130ccfc6698","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"db05ffed-9cfd-426b-b9e1-86ba8e36ed64","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](../index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201512022229240000-094163cf51fcd4717c3ea96799d1008723ae8985/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>